<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="7. 在 iOS 上使用 Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/using/ios.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="作者, Russell Keith-Magee (2024-03),. 在 iOS 上的 Python 不同于桌面平台上的 Python。 在桌面平台上，Python 通常是作为系统资源安装并可供该计算机上的任何用户使用。 用户将通过运行 python 可执行文件并在交互提示符下输入命令，或者通过运行 Python 脚本的方式与 Python 进行交互。 在 iOS，不存在作为系统资源安装种..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="作者, Russell Keith-Magee (2024-03),. 在 iOS 上的 Python 不同于桌面平台上的 Python。 在桌面平台上，Python 通常是作为系统资源安装并可供该计算机上的任何用户使用。 用户将通过运行 python 可执行文件并在交互提示符下输入命令，或者通过运行 Python 脚本的方式与 Python 进行交互。 在 iOS，不存在作为系统资源安装种..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>7. 在 iOS 上使用 Python &#8212; Python 3.14.0a4 文档</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=08c2cdb3" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../_static/documentation_options.js?v=495aad30"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.14.0a4 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权所有" href="../copyright.html" />
    <link rel="next" title="8. 编辑器和集成开发环境" href="editors.html" />
    <link rel="prev" title="6. 在Android上使用 Python" href="android.html" />
    
      <script defer data-domain="docs.python.org" src="https://plausible.io/js/script.js"></script>
    
    <link rel="canonical" href="https://docs.python.org/3/using/ios.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" />
                <input type="submit" value="提交"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">7. 在 iOS 上使用 Python</a><ul>
<li><a class="reference internal" href="#python-at-runtime-on-ios">7.1. iOS 上的 Python 运行时</a><ul>
<li><a class="reference internal" href="#ios-version-compatibility">7.1.1. iOS 版本兼容性</a></li>
<li><a class="reference internal" href="#platform-identification">7.1.2. 平台识别</a></li>
<li><a class="reference internal" href="#standard-library-availability">7.1.3. 标准库可用性</a></li>
<li><a class="reference internal" href="#binary-extension-modules">7.1.4. 二进制扩展模块</a></li>
<li><a class="reference internal" href="#compiler-stub-binaries">7.1.5. 编译器存根二进制文件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-python-on-ios">7.2. 在 iOS 上安装 Python</a><ul>
<li><a class="reference internal" href="#tools-for-building-ios-apps">7.2.1. 构建 iOS 应用程序的工具</a></li>
<li><a class="reference internal" href="#adding-python-to-an-ios-project">7.2.2. 在 iOS 项目中添加 Python</a></li>
<li><a class="reference internal" href="#testing-a-python-package">7.2.3. 测试 Python 软件包</a></li>
</ul>
</li>
<li><a class="reference internal" href="#app-store-compliance">7.3. App Store 合规性</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="android.html"
                          title="上一章"><span class="section-number">6. </span>在Android上使用 Python</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="editors.html"
                          title="下一章"><span class="section-number">8. </span>编辑器和集成开发环境</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告 Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/ios.rst"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="editors.html" title="8. 编辑器和集成开发环境"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="android.html" title="6. 在Android上使用 Python"
             accesskey="P">上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0a4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python安装和使用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7. </span>在 iOS 上使用 Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box" />
          <input type="submit" value="提交" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="using-python-on-ios">
<span id="using-ios"></span><h1><span class="section-number">7. </span>在 iOS 上使用 Python<a class="headerlink" href="#using-python-on-ios" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">作者<span class="colon">:</span></dt>
<dd class="field-odd"><p>Russell Keith-Magee (2024-03)</p>
</dd>
</dl>
<p>在 iOS 上的 Python 不同于桌面平台上的 Python。 在桌面平台上，Python 通常是作为系统资源安装并可供该计算机上的任何用户使用。 用户将通过运行 <strong class="program">python</strong> 可执行文件并在交互提示符下输入命令，或者通过运行 Python 脚本的方式与 Python 进行交互。</p>
<p>在 iOS，不存在作为系统资源安装种概念。 唯一的软件分发单元是 &quot;app&quot;。 也不存在可以让你运行 <strong class="program">python</strong> 可执行文件，或与 Python REPL 进行交互的控制台。</p>
<p>因此，你在 iOS 上使用 Python 的唯一方式是嵌入模式 —— 也就是说，通过编写原生的 iOS 应用，并使用 <code class="docutils literal notranslate"><span class="pre">libPython</span></code> 嵌入一个 Python 解释器，然后使用 <a class="reference internal" href="../extending/embedding.html#embedding"><span class="std std-ref">Python 嵌入式 API</span></a> 来唤起 Python 代码。 完整的 Python 解释器、标准库，以及所有 Python 代码都将被打包为可通过 iOS App Store 发布的独立软件包。</p>
<p>如果你想要上手尝试以 Python 来编写 iOS app，像 <a class="reference external" href="https://beeware.org">BeeWare</a> 和 <a class="reference external" href="https://kivy.org">Kivy</a> 这样的项目将提供更方便的用户体验。 这些项目能够管理支持 iOS 项目运行的相关复杂问题，这样你只需要处理 Python 代码本身。</p>
<section id="python-at-runtime-on-ios">
<h2><span class="section-number">7.1. </span>iOS 上的 Python 运行时<a class="headerlink" href="#python-at-runtime-on-ios" title="Link to this heading">¶</a></h2>
<section id="ios-version-compatibility">
<h3><span class="section-number">7.1.1. </span>iOS 版本兼容性<a class="headerlink" href="#ios-version-compatibility" title="Link to this heading">¶</a></h3>
<p>受支持的最低 iOS 版本是在编译时指定的，对 <code class="docutils literal notranslate"><span class="pre">configure</span></code> 使用 <a class="reference internal" href="configure.html#cmdoption-host"><code class="xref std std-option docutils literal notranslate"><span class="pre">--host</span></code></a> 选项。 在默认情况下，当针对 iOS 编译时，Python 编译将设置受支持的最低 iOS 版本为 13.0。 我使用不同的最低 iOS 版本，请将版本号作为 <code class="xref std std-option docutils literal notranslate"><span class="pre">--host</span></code> 参数的一部分提供 —— 例如，<code class="docutils literal notranslate"><span class="pre">--host=arm64-apple-ios15.4-simulator</span></code> 将编译一份部署目标为 15.4 的 ARM64 模拟器构建版。</p>
</section>
<section id="platform-identification">
<h3><span class="section-number">7.1.2. </span>平台识别<a class="headerlink" href="#platform-identification" title="Link to this heading">¶</a></h3>
<p>当在 iOS 上执行时，<code class="docutils literal notranslate"><span class="pre">sys.platform</span></code> 将报告为 <code class="docutils literal notranslate"><span class="pre">ios</span></code>。 无论 app 是在模拟器还是物理设备上运行，都将在 iPhone 或 iPad 上返回该值。</p>
<p>有关特定运行时环境的信息，包括 iOS 版本、设备型号以及设备是否为模拟器，可使用 <a class="reference internal" href="../library/platform.html#platform.ios_ver" title="platform.ios_ver"><code class="xref py py-func docutils literal notranslate"><span class="pre">platform.ios_ver()</span></code></a> 来获取。 <a class="reference internal" href="../library/platform.html#platform.system" title="platform.system"><code class="xref py py-func docutils literal notranslate"><span class="pre">platform.system()</span></code></a> 将根据具体设备报告为 <code class="docutils literal notranslate"><span class="pre">iOS</span></code> 或 <code class="docutils literal notranslate"><span class="pre">iPadOS</span></code>。</p>
<p><a class="reference internal" href="../library/os.html#os.uname" title="os.uname"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.uname()</span></code></a> 报告内核等级的详情；它将报告系统名称 <code class="docutils literal notranslate"><span class="pre">Darwin</span></code>。</p>
</section>
<section id="standard-library-availability">
<h3><span class="section-number">7.1.3. </span>标准库可用性<a class="headerlink" href="#standard-library-availability" title="Link to this heading">¶</a></h3>
<p>Python 标准库在standard library has some notable omissions and restrictions on iOS 上有一点需要注意的缺失和限制。 请参阅 <a class="reference internal" href="../library/intro.html#mobile-availability"><span class="std std-ref">针对 iOS 的 API 可用性指南</span></a> 了解详情。</p>
</section>
<section id="binary-extension-modules">
<h3><span class="section-number">7.1.4. </span>二进制扩展模块<a class="headerlink" href="#binary-extension-modules" title="Link to this heading">¶</a></h3>
<p>作为一个平台的 iOS 与别家的显著不同之处在于 App Store 分发机制对应用的打包方式设置了硬性要求。其中一项要求规定了应当如何分发二进制扩展模块。</p>
<p>iOS App Store 要求 iOS app 中的 <em>所有</em> 二进制模块都必须为动态库，包含在具有适当元数据的框架中，保存于被打包 app 的 <code class="docutils literal notranslate"><span class="pre">Frameworks</span></code> 文件夹下。 每个框架只能有一个二进制模块，而在 <code class="docutils literal notranslate"><span class="pre">Frameworks</span></code> 文件夹之外不能有可执行的二进制文件。</p>
<p>这与 Python 通常用于发布二进制文件的方式存在冲突，此方式允许从 <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> 上的任何位置加载二进制扩展模块。 为确保符合 App Store 的政策，iOS 项目必须对任何 Python 包进行后期处理，将 <code class="docutils literal notranslate"><span class="pre">.so</span></code> 二进制模块转换为具有适当元数据和签名的单个独立框架。 有关如何执行后期处理的更多细节，请参阅 <a class="reference internal" href="#adding-ios"><span class="std std-ref">将 Python 添加到你的项目</span></a> 指南。</p>
<p>为帮助 Python 在新位置中发现二进制文件，在 <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> 中的原始 <code class="docutils literal notranslate"><span class="pre">.so</span></code> 文件将替换为 <code class="docutils literal notranslate"><span class="pre">.fwork</span></code> 文件。 此文件是一个包含框架二进制文件相对于 app 捆绑包位置的文本文件。 为允许框架将其解析回原始位置，框架必须包含一个 <code class="docutils literal notranslate"><span class="pre">.origin</span></code> 文件，其中包含 <code class="docutils literal notranslate"><span class="pre">.fwork</span></code> 相对对 app 捆绑包的位置。</p>
<p>例如，考虑导入 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">foo.bar</span> <span class="pre">import</span> <span class="pre">_whiz</span></code> 的情况，其中 <code class="docutils literal notranslate"><span class="pre">_whiz</span></code> 是使用二进制模块 <code class="docutils literal notranslate"><span class="pre">sources/foo/bar/_whiz.abi3.so</span></code> 实现的，这里 <code class="docutils literal notranslate"><span class="pre">sources</span></code> 是在 <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> 中注册的相对于 app 包的位置。 此模块 <em>必须</em> 发布为 <code class="docutils literal notranslate"><span class="pre">Frameworks/foo.bar._whiz.framework/foo.bar._whiz</span></code> (根据模块的完整导入路径创建框架名称)，并通过 <code class="docutils literal notranslate"><span class="pre">.framework</span></code> 目录中的 <code class="docutils literal notranslate"><span class="pre">Info.plist</span></code> 文件将二进制文件标识为一个框架。 <code class="docutils literal notranslate"><span class="pre">foo.bar._whiz</span></code> 模块在原始位置中以一个 <code class="docutils literal notranslate"><span class="pre">sources/foo/bar/_whiz.abi3.fwork</span></code> 标记文件来代表，其中包含路径 <code class="docutils literal notranslate"><span class="pre">Frameworks/foo.bar._whiz/foo.bar._whiz</span></code>。 该框架还要包含 <code class="docutils literal notranslate"><span class="pre">Frameworks/foo.bar._whiz.framework/foo.bar._whiz.origin</span></code>，其中包含 <code class="docutils literal notranslate"><span class="pre">.fwork</span></code> 文件的路径。</p>
<p>当在 iOS 上运行时，Python 解释器将安装一个能够读取并导入 <code class="docutils literal notranslate"><span class="pre">.fwork</span></code> 文件的 <a class="reference internal" href="../library/importlib.html#importlib.machinery.AppleFrameworkLoader" title="importlib.machinery.AppleFrameworkLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppleFrameworkLoader</span></code></a>。 一旦被导入，该二进制模块的 <code class="docutils literal notranslate"><span class="pre">__file__</span></code> 属性将报告为 <code class="docutils literal notranslate"><span class="pre">.fwork</span></code> 文件的位置。 不过，被加载模块的 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec" title="importlib.machinery.ModuleSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModuleSpec</span></code></a> 则会将 <code class="docutils literal notranslate"><span class="pre">origin</span></code> 报告为框架文件夹下的二进制文件的位置。</p>
</section>
<section id="compiler-stub-binaries">
<h3><span class="section-number">7.1.5. </span>编译器存根二进制文件<a class="headerlink" href="#compiler-stub-binaries" title="Link to this heading">¶</a></h3>
<p>Xcode 不会暴露针对 iOS 的显式编译器；作为替代，它会使用一个能解析出完整编译器路径的 <code class="docutils literal notranslate"><span class="pre">xcrun</span></code> 脚本 (例如，<code class="docutils literal notranslate"><span class="pre">xcrun</span> <span class="pre">--sdk</span> <span class="pre">iphoneos</span> <span class="pre">clang</span></code> 将获得针对 iPhone 设备的 <code class="docutils literal notranslate"><span class="pre">clang</span></code>)。 不过，使用此脚本会导致两个问题：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xcrun</span></code> 的输出包括特定机器专属的路径，这导致无法在用户之间共享 sysconfig 模块；并且</p></li>
<li><p>它会导致包括空格的 <code class="docutils literal notranslate"><span class="pre">CC</span></code>/<code class="docutils literal notranslate"><span class="pre">CPP</span></code>/<code class="docutils literal notranslate"><span class="pre">LD</span></code>/<code class="docutils literal notranslate"><span class="pre">AR</span></code> 定义。 有大量 C 生态系统工具假定你可以在第一个空格处拆分命令行来获取编译器可执行文件的路径；当使用 <code class="docutils literal notranslate"><span class="pre">xcrun</span></code> 这是不行的。</p></li>
</ul>
<p>为避免这些问题，Python 提供了针对这些工具的程序段。 这些代码段是在下层 <code class="docutils literal notranslate"><span class="pre">xcrun</span></code> 工具之上的 shell 脚本包装器，发布在随同已编译的 iOS 框架一起分发的 <code class="docutils literal notranslate"><span class="pre">bin</span></code> 文件夹中。 这些脚本可以被重新调整位置，并且总是会解析到正确的本机系统路径。 通过在配合框架的 bin 文件夹中包括这些脚本，<code class="docutils literal notranslate"><span class="pre">sysconfig</span></code> 模块的内容将可适用于要编译他们自己的模块的最终用户。 在为 iOS 编译第三方 Python 模块时，你应当确保这些程序段二进制文件位于你的路径中。</p>
</section>
</section>
<section id="installing-python-on-ios">
<h2><span class="section-number">7.2. </span>在 iOS 上安装 Python<a class="headerlink" href="#installing-python-on-ios" title="Link to this heading">¶</a></h2>
<section id="tools-for-building-ios-apps">
<h3><span class="section-number">7.2.1. </span>构建 iOS 应用程序的工具<a class="headerlink" href="#tools-for-building-ios-apps" title="Link to this heading">¶</a></h3>
<p>针对 iOS 构建需要使用 Apple 的 Xcode 工具集。 强烈建议你使用 Xcode 最新稳定发布版。 这将需要使用最新（或者次新）发布的 macOS 版本，因为 Apple 不会为更旧的 macOS 版本维护 Xcode。 Xcode 命令行工具对于 iOS 开发来说是不够的；你需要 <em>完整的</em> Xcode 安装版。</p>
<p>如果你想要在 iOS 模拟器上运行你的代码，你还需要安装 iOS 模拟器平台。 当你首次运行 Xcode 应该会提示你选择一个 iOS 模拟器平台。 或者，你也可以通过在 Settings 面板的 Platforms 选项卡中添加一个 iOS 模拟器平台。</p>
</section>
<section id="adding-python-to-an-ios-project">
<span id="adding-ios"></span><h3><span class="section-number">7.2.2. </span>在 iOS 项目中添加 Python<a class="headerlink" href="#adding-python-to-an-ios-project" title="Link to this heading">¶</a></h3>
<p>Python 可以被添加到任何 iOS 项目，不论它是使用 Swift 还是 Objective C。 下面的例子将使用 Objective C；如果你是使用 Swift，你可能会发现 <a class="reference external" href="https://github.com/pvieito/PythonKit">PythonKit</a> 这样的库非常有用。</p>
<p>要在 iOS Xcode 项目中添加 Python：</p>
<ol class="arabic">
<li><p>构建或是获取一个 Python <code class="docutils literal notranslate"><span class="pre">XCFramework</span></code>。 请参阅 <a class="extlink-source reference external" href="https://github.com/python/cpython/tree/main/iOS/README.rst">iOS/README.rst</a> (在 CPython 源代码发布包中) 中的说明了解有关如何构建 Python <code class="docutils literal notranslate"><span class="pre">XCFramework</span></code> 的细节。 要满足最基本要求，你需要一个支持 <code class="docutils literal notranslate"><span class="pre">arm64-apple-ios</span></code>，再加上 <code class="docutils literal notranslate"><span class="pre">arm64-apple-ios-simulator</span></code> 或 <code class="docutils literal notranslate"><span class="pre">x86_64-apple-ios-simulator</span></code> 之一的构建版。</p></li>
<li><p>将 <code class="docutils literal notranslate"><span class="pre">XCframework</span></code> 拖到你的 iOS 项目中。 在下面的说明中，我们将假定你已将 <code class="docutils literal notranslate"><span class="pre">XCframework</span></code> 放到你的项目的根目录下；不过，你也可以通过按需调整路径来使用任何其他你想要的位置。</p></li>
<li><p>将 <code class="docutils literal notranslate"><span class="pre">iOS/Resources/dylib-Info-template.plist</span></code> 文件拖到你的项目中，并确保它已关联到 app 目标。</p></li>
<li><p>将你的应用程序代码作为一个文件夹添加到你的 Xcode 项目中。 在下面的说明中，我们将假定你的用户代码位于你的项目中名为 <code class="docutils literal notranslate"><span class="pre">app</span></code> 的文件夹；你也可以通过按需调整路径来使用任何其他位置。 请确保该文件夹已关联到你的 app 目标。</p></li>
<li><p>通过选择你的 Xcode 项目的根节点来选择 app 目标，然后在边栏中出现的目标名称进行选择。</p></li>
<li><p>在 &quot;General&quot; 设置中，在 &quot;Frameworks, Libraries and Embedded Content&quot; 之下，增加了 <code class="docutils literal notranslate"><span class="pre">Python.xcframework</span></code>，并选中 &quot;Embed &amp; Sign&quot;。</p></li>
<li><p>在&quot;构建设置&quot;选项卡中，修改以下内容：</p>
<ul class="simple">
<li><p>构建选项</p>
<ul>
<li><p>用户脚本沙盒：否</p></li>
<li><p>启用可测试性：是</p></li>
</ul>
</li>
<li><p>搜索路径</p>
<ul>
<li><p>框架搜索路径： <code class="docutils literal notranslate"><span class="pre">$(PROJECT_DIR)</span></code></p></li>
<li><p>头文件搜索路径： <code class="docutils literal notranslate"><span class="pre">&quot;$(BUILT_PRODUCTS_DIR)/Python.framework/Headers&quot;</span></code></p></li>
</ul>
</li>
<li><p>Apple Clang - 警告 - 所有语言</p>
<ul>
<li><p>引用包含在框架头文件中：否</p></li>
</ul>
</li>
</ul>
</li>
<li><p>添加一个用于将 Python 标准库拷贝到你的 app 中的构建步骤。 在 &quot;Build Phases&quot; 选项卡中，在 &quot;Embed Frameworks&quot; 步骤 <em>之前</em>，&quot;Copy Bundle Resources&quot; 步骤 <em>之后</em> 添加一个新的 &quot;Run Script&quot; 构建步骤。 将该步骤命名为 &quot;Install Target Specific Python Standard Library&quot;，取消 &quot;Based on dependency analysis&quot; 复选框，并将脚本内容设为：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>-e

mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/python/lib&quot;</span>
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EFFECTIVE_PLATFORM_NAME</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-iphonesimulator&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing Python modules for iOS Simulator&quot;</span>
<span class="w">    </span>rsync<span class="w"> </span>-au<span class="w"> </span>--delete<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/Python.xcframework/ios-arm64_x86_64-simulator/lib/&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/python/lib/&quot;</span>
<span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing Python modules for iOS Device&quot;</span>
<span class="w">    </span>rsync<span class="w"> </span>-au<span class="w"> </span>--delete<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PROJECT_DIR</span><span class="s2">/Python.xcframework/ios-arm64/lib/&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/python/lib/&quot;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>请注意 XCframework 中的模拟器名称 &quot;slice&quot; 可能有所不同，具体取决于你的 <code class="docutils literal notranslate"><span class="pre">XCFramework</span></code> 所支持的 CPU 架构。</p>
</li>
<li><p>再添加第二个用于将标准库中的二进制扩展模块处理为 &quot;Framework&quot; 格式的构建步骤。 紧随你在第 8 步添加的步骤 <em>之后立即</em> 添加一个 &quot;Run Script&quot; 构建步骤，命名为 &quot;Prepare Python Binary Modules&quot;。 它应当取消选择 &quot;Based on dependency analysis&quot;，并将脚本内容设为：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>-e

install_dylib<span class="w"> </span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nv">INSTALL_BASE</span><span class="o">=</span><span class="nv">$1</span>
<span class="w">    </span><span class="nv">FULL_EXT</span><span class="o">=</span><span class="nv">$2</span>

<span class="w">    </span><span class="c1"># 扩展文件的名称</span>
<span class="w">    </span><span class="nv">EXT</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FULL_EXT</span><span class="s2">&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="c1"># 扩展文件相对与捆绑包的位置</span>
<span class="w">    </span><span class="nv">RELATIVE_EXT</span><span class="o">=</span><span class="si">${</span><span class="nv">FULL_EXT</span><span class="p">#</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="p">/</span><span class="si">}</span>
<span class="w">    </span><span class="c1"># 扩展文件相对于安装目录的路径</span>
<span class="w">    </span><span class="nv">PYTHON_EXT</span><span class="o">=</span><span class="si">${</span><span class="nv">RELATIVE_EXT</span><span class="p">/</span><span class="nv">$INSTALL_BASE</span><span class="p">/</span><span class="si">}</span>
<span class="w">    </span><span class="c1"># 扩展模块带点号的完整名称，根据文件目录来构造。</span>
<span class="w">    </span><span class="nv">FULL_MODULE_NAME</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$PYTHON_EXT</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="k">)</span><span class="p">;</span>
<span class="w">    </span><span class="c1"># 捆绑包标识；未实际使用，但为 Xcode 框架打包所必需</span>
<span class="w">    </span><span class="nv">FRAMEWORK_BUNDLE_ID</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$PRODUCT_BUNDLE_IDENTIFIER</span>.<span class="nv">$FULL_MODULE_NAME</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="k">)</span>
<span class="w">    </span><span class="c1"># 框架文件夹的名称。</span>
<span class="w">    </span><span class="nv">FRAMEWORK_FOLDER</span><span class="o">=</span><span class="s2">&quot;Frameworks/</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">.framework&quot;</span>

<span class="w">    </span><span class="c1"># 如果框架文件夹不存在，则创建它。</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Creating framework for </span><span class="nv">$RELATIVE_EXT</span><span class="s2">&quot;</span>
<span class="w">        </span>mkdir<span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">&quot;</span>
<span class="w">        </span>cp<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/dylib-Info-template.plist&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/Info.plist&quot;</span>
<span class="w">        </span>plutil<span class="w"> </span>-replace<span class="w"> </span>CFBundleExecutable<span class="w"> </span>-string<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/Info.plist&quot;</span>
<span class="w">        </span>plutil<span class="w"> </span>-replace<span class="w"> </span>CFBundleIdentifier<span class="w"> </span>-string<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FRAMEWORK_BUNDLE_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/Info.plist&quot;</span>
<span class="w">    </span><span class="k">fi</span>

<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Installing binary for </span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">&quot;</span>
<span class="w">    </span>mv<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FULL_EXT</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="c1"># 创建占位用 .fwork 文件指明 .so 所在位置</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="si">${</span><span class="nv">FULL_EXT</span><span class="p">%.so</span><span class="si">}</span>.fwork
<span class="w">    </span><span class="c1"># 在框架中创建指向 .so 文件位置的反向引用</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RELATIVE_EXT</span><span class="p">%.so</span><span class="si">}</span><span class="s2">.fwork&quot;</span><span class="w"> </span>&gt;<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/</span><span class="nv">$FRAMEWORK_FOLDER</span><span class="s2">/</span><span class="nv">$FULL_MODULE_NAME</span><span class="s2">.origin&quot;</span>
<span class="w"> </span><span class="o">}</span>

<span class="w"> </span><span class="nv">PYTHON_VER</span><span class="o">=</span><span class="k">$(</span>ls<span class="w"> </span>-1<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/python/lib&quot;</span><span class="k">)</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Install Python </span><span class="nv">$PYTHON_VER</span><span class="s2"> standard library extension modules...&quot;</span>
<span class="w"> </span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/python/lib/</span><span class="nv">$PYTHON_VER</span><span class="s2">/lib-dynload&quot;</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.so&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>FULL_EXT<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span>install_dylib<span class="w"> </span>python/lib/<span class="nv">$PYTHON_VER</span>/lib-dynload/<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FULL_EXT</span><span class="s2">&quot;</span>
<span class="w"> </span><span class="k">done</span>

<span class="w"> </span><span class="c1"># 清理 dylib 模板</span>
<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/dylib-Info-template.plist&quot;</span>

<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Signing frameworks as </span><span class="nv">$EXPANDED_CODE_SIGN_IDENTITY_NAME</span><span class="s2"> (</span><span class="nv">$EXPANDED_CODE_SIGN_IDENTITY</span><span class="s2">)...&quot;</span>
<span class="w"> </span>find<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CODESIGNING_FOLDER_PATH</span><span class="s2">/Frameworks&quot;</span><span class="w"> </span>-name<span class="w"> </span><span class="s2">&quot;*.framework&quot;</span><span class="w"> </span>-exec<span class="w"> </span>/usr/bin/codesign<span class="w"> </span>--force<span class="w"> </span>--sign<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$EXPANDED_CODE_SIGN_IDENTITY</span><span class="s2">&quot;</span><span class="w"> </span><span class="si">${</span><span class="nv">OTHER_CODE_SIGN_FLAGS</span><span class="k">:-</span><span class="si">}</span><span class="w"> </span>-o<span class="w"> </span>runtime<span class="w"> </span>--timestamp<span class="o">=</span>none<span class="w"> </span>--preserve-metadata<span class="o">=</span>identifier,entitlements,flags<span class="w"> </span>--generate-entitlement-der<span class="w"> </span><span class="s2">&quot;{}&quot;</span><span class="w"> </span><span class="se">\;</span>
</pre></div>
</div>
</li>
<li><p>添加 Objective C 代码来初始化并使用嵌入模式的 Python 解释器。 你应当确保：</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>UTF-8 模式 (<a class="reference internal" href="../c-api/init_config.html#c.PyPreConfig.utf8_mode" title="PyPreConfig.utf8_mode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyPreConfig.utf8_mode</span></code></a>) <em>已启用</em>;</p></li>
<li><p>带缓冲的 stdio (<a class="reference internal" href="../c-api/init_config.html#c.PyConfig.buffered_stdio" title="PyConfig.buffered_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.buffered_stdio</span></code></a>) <em>已禁用</em>;</p></li>
<li><p>写入字节码 (<a class="reference internal" href="../c-api/init_config.html#c.PyConfig.write_bytecode" title="PyConfig.write_bytecode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.write_bytecode</span></code></a>) <em>已禁用</em>;</p></li>
<li><p>信号处理器 (<a class="reference internal" href="../c-api/init_config.html#c.PyConfig.install_signal_handlers" title="PyConfig.install_signal_handlers"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.install_signal_handlers</span></code></a>) <em>已启用</em>;</p></li>
<li><p>系统日志记录 (<a class="reference internal" href="../c-api/init_config.html#c.PyConfig.use_system_logger" title="PyConfig.use_system_logger"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.use_system_logger</span></code></a>) <em>已启用</em> (可选项，但强烈建议启用);</p></li>
<li><p>用于解释器的 <code class="docutils literal notranslate"><span class="pre">PYTHONHOME</span></code> 将被配置为指向你的 app 捆绑包的 <code class="docutils literal notranslate"><span class="pre">python</span></code> 子文件夹；并且</p></li>
<li><p>用于解释器的 <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> 包括：</p>
<ul>
<li><p>你的 app 的封包的 <code class="docutils literal notranslate"><span class="pre">python/lib/python3.X</span></code> 子文件夹，</p></li>
<li><p>你的 app 的封包的 <code class="docutils literal notranslate"><span class="pre">python/lib/python3.X/lib-dynload</span></code> 子文件夹，以及</p></li>
<li><p>你的 app 的封包的 <code class="docutils literal notranslate"><span class="pre">app</span></code> 子文件夹</p></li>
</ul>
</li>
</ul>
<p>你的 app 捆绑包的位置可使用 <code class="docutils literal notranslate"><span class="pre">[[NSBundle</span> <span class="pre">mainBundle]</span> <span class="pre">resourcePath]</span></code> 来确定。</p>
</div></blockquote>
<p>这些说明的步骤 8, 9 和 10 均假定你有一个单独的纯 Python 应用程序代码文件夹，其名称为 <code class="docutils literal notranslate"><span class="pre">app</span></code>。 如果在你的 app 中还存在第三方二进制模块，则还需要一些额外的步骤：</p>
<ul class="simple">
<li><p>你需要确保任何包含第二方二进制文件的文件夹均已关联到 app 目标，或已作为第 8 步的一部分被拷贝。 第 8 步还应当清理任何对于特定构建目标的平台来说不适用的二进制文件（即当你要构建以该模拟器为目标的 app 就应删除任何设备二进制文件）。</p></li>
<li><p>任何包含第三方二进制文件的文件夹都必须通过第 9 步处理为框架形式。 可以拷贝并调整对于处理 <code class="docutils literal notranslate"><span class="pre">lib-dynload</span></code> 文件夹的 <code class="docutils literal notranslate"><span class="pre">install_dylib</span></code> 唤起的代码以符合这一目的。</p></li>
<li><p>如果你使用了不同的文件夹来存放第三方包，请确保该文件夹已在第 10 步中被包括为 <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code> 配置的一部分。</p></li>
</ul>
</section>
<section id="testing-a-python-package">
<h3><span class="section-number">7.2.3. </span>测试 Python 软件包<a class="headerlink" href="#testing-a-python-package" title="Link to this heading">¶</a></h3>
<p>CPython 源码树包含一个 <a class="extlink-source reference external" href="https://github.com/python/cpython/tree/main/iOS/testbed">testbed 项目</a> 用于在 iOS 模拟器上运行 CPython 测试套件。 这个 testbed 还可被用作在 iOS 上运行你的 Python 库的测试套件的 testbed 项目。</p>
<p>在构建或获取 iOS XCFramework (请参见 <a class="extlink-source reference external" href="https://github.com/python/cpython/tree/main/iOS/README.rst">iOS/README.rst</a> 了解详情) 之后，通过运行以下命令创建 Python iOS testbed 项目的克隆：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>iOS/testbed<span class="w"> </span>clone<span class="w"> </span>--framework<span class="w"> </span>&lt;path/to/Python.xcframework&gt;<span class="w"> </span>--app<span class="w"> </span>&lt;path/to/module1&gt;<span class="w"> </span>--app<span class="w"> </span>&lt;path/to/module2&gt;<span class="w"> </span>app-testbed
</pre></div>
</div>
<p>你将需要将 <code class="docutils literal notranslate"><span class="pre">iOS/testbed</span></code> 引用修改为指向 CPython 源码树的相应目录；任何使用 <code class="docutils literal notranslate"><span class="pre">--app</span></code> 旗标指定的文件夹都将被拷贝到克隆的 testbed 项目中。 结果 testbed 将在 <code class="docutils literal notranslate"><span class="pre">app-testbed</span></code> 文件夹中被创建。 在本示例中，<code class="docutils literal notranslate"><span class="pre">module1</span></code> 和 <code class="docutils literal notranslate"><span class="pre">module2</span></code> 将成为运行时可导入的模块。 如果你的项目还有额外的依赖项，它们可以被安装到 <code class="docutils literal notranslate"><span class="pre">app-testbed/iOSTestbed/app_packages</span></code> 文件夹中 (使用类似 <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--target</span> <span class="pre">app-testbed/iOSTestbed/app_packages</span></code> 的命令)。</p>
<p>你可以随后使用 <code class="docutils literal notranslate"><span class="pre">app-testbed</span></code> 文件夹来运行你的 app 的测试套件，举例来说，如果 <code class="docutils literal notranslate"><span class="pre">module1.tests</span></code> 是你的测试套件的入口点，你可以运行：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>app-testbed<span class="w"> </span>run<span class="w"> </span>--<span class="w"> </span>module1.tests
</pre></div>
</div>
<p>这相当于在桌面 Python 构建版上运行 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">module1.tests</span></code>。 任何在 <code class="docutils literal notranslate"><span class="pre">--</span></code> 之后的参数都将被传给 testbed 就像它们是桌面机上 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span></code> 的参数那样。</p>
<p>你还可以通过运行以下命令在 Xcode 中打开这个 testbed 项目：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>open<span class="w"> </span>app-testbed/iOSTestbed.xcodeproj
</pre></div>
</div>
<p>这将允许你使用完整的 Xcode 工具套件进行调试。</p>
</section>
</section>
<section id="app-store-compliance">
<h2><span class="section-number">7.3. </span>App Store 合规性<a class="headerlink" href="#app-store-compliance" title="Link to this heading">¶</a></h2>
<p>将 app 发布到第三方 iOS 设备的唯一机制是将 app 提交到 iOS App Store；提交发布的 app 必须通过 Apple 的 app 审核进程。 此进程包括一组在所提交的应用程序包中自动检查有问题代码的验证规则。</p>
<p>Python 标准库包含了一些已知会违反这些自动规则的代码。 虽然这些违规情况看来是属于误报，但 Apple 的审核规则是不可挑战的；因此，有必要修改 Python 标准库以便 app 能够通过 App Store 的审核。</p>
<p>Python 源代码树包含 <a class="extlink-source reference external" href="https://github.com/python/cpython/tree/main/Mac/Resources/app-store-compliance.patch">一个补丁文件</a> 可移除所有已知的会导致 App Store 审核过程出现问题的代码。 这个补丁会在针对 iOS 进行构建时自动应用。</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">7. 在 iOS 上使用 Python</a><ul>
<li><a class="reference internal" href="#python-at-runtime-on-ios">7.1. iOS 上的 Python 运行时</a><ul>
<li><a class="reference internal" href="#ios-version-compatibility">7.1.1. iOS 版本兼容性</a></li>
<li><a class="reference internal" href="#platform-identification">7.1.2. 平台识别</a></li>
<li><a class="reference internal" href="#standard-library-availability">7.1.3. 标准库可用性</a></li>
<li><a class="reference internal" href="#binary-extension-modules">7.1.4. 二进制扩展模块</a></li>
<li><a class="reference internal" href="#compiler-stub-binaries">7.1.5. 编译器存根二进制文件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-python-on-ios">7.2. 在 iOS 上安装 Python</a><ul>
<li><a class="reference internal" href="#tools-for-building-ios-apps">7.2.1. 构建 iOS 应用程序的工具</a></li>
<li><a class="reference internal" href="#adding-python-to-an-ios-project">7.2.2. 在 iOS 项目中添加 Python</a></li>
<li><a class="reference internal" href="#testing-a-python-package">7.2.3. 测试 Python 软件包</a></li>
</ul>
</li>
<li><a class="reference internal" href="#app-store-compliance">7.3. App Store 合规性</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="android.html"
                          title="上一章"><span class="section-number">6. </span>在Android上使用 Python</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="editors.html"
                          title="下一章"><span class="section-number">8. </span>编辑器和集成开发环境</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告 Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/using/ios.rst"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="折叠边栏">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="editors.html" title="8. 编辑器和集成开发环境"
             >下一页</a> |</li>
        <li class="right" >
          <a href="android.html" title="6. 在Android上使用 Python"
             >上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0a4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python安装和使用</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7. </span>在 iOS 上使用 Python</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box" />
          <input type="submit" value="提交" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    版权所有
    
      </a>
     2001 Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="/license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最后更新于 2月 03, 2025 (05:36 UTC).
    
      <a href="/bugs.html">Found a bug</a>?
    
    <br />

    由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3创建。
    </div>

  </body>
</html>