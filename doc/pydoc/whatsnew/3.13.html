<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Python 3.13 有什么新变化" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/whatsnew/3.13.html" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="编者, Adam Turner 和 Thomas Wouters,. 本文介绍了 Python 3.13 相比 3.12 增加的新特性。 Python 3.13 已于 2024 年 10 月 7 日发布。 要获取详细信息，可参阅 更新日志 。 摘要 -- 发布重点: Python 3.13 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括一个..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="编者, Adam Turner 和 Thomas Wouters,. 本文介绍了 Python 3.13 相比 3.12 增加的新特性。 Python 3.13 已于 2024 年 10 月 7 日发布。 要获取详细信息，可参阅 更新日志 。 摘要 -- 发布重点: Python 3.13 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括一个..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>Python 3.13 有什么新变化 &#8212; Python 3.14.0a4 文档</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../_static/pydoctheme.css?v=08c2cdb3" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../_static/documentation_options.js?v=495aad30"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Python 3.14.0a4 文档 中搜索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="关于此文档" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="copyright" title="版权所有" href="../copyright.html" />
    <link rel="next" title="Python 3.12 有什么新变化" href="3.12.html" />
    <link rel="prev" title="What&#39;s new in Python 3.14" href="3.14.html" />
    
      <script defer data-domain="docs.python.org" src="https://plausible.io/js/script.js"></script>
    
    <link rel="canonical" href="https://docs.python.org/3/whatsnew/3.13.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="stylesheet" href="../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script>
            <script type="text/javascript" src="../_static/search-focus.js"></script>
            <script type="text/javascript" src="../_static/themetoggle.js"></script> 
            <script type="text/javascript" src="../_static/rtd_switcher.js"></script>
            <meta name="readthedocs-addons-api-version" content="1">

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" />
                <input type="submit" value="提交"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.13 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#new-features">新的特性</a><ul>
<li><a class="reference internal" href="#a-better-interactive-interpreter">更好的交互式解释器</a></li>
<li><a class="reference internal" href="#improved-error-messages">改进的错误消息</a></li>
<li><a class="reference internal" href="#free-threaded-cpython">自由线程的 CPython</a></li>
<li><a class="reference internal" href="#an-experimental-just-in-time-jit-compiler">实验性的即时 (JIT) 编译器</a></li>
<li><a class="reference internal" href="#defined-mutation-semantics-for-locals">针对 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code> 的已定义修改语义</a></li>
<li><a class="reference internal" href="#support-for-mobile-platforms">对移动平台的支持</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a></li>
<li><a class="reference internal" href="#new-modules">新增模块</a></li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#argparse">argparse</a></li>
<li><a class="reference internal" href="#array">array</a></li>
<li><a class="reference internal" href="#ast">ast</a></li>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#compileall">compileall</a></li>
<li><a class="reference internal" href="#concurrent-futures">concurrent.futures</a></li>
<li><a class="reference internal" href="#configparser">configparser</a></li>
<li><a class="reference internal" href="#copy">copy</a></li>
<li><a class="reference internal" href="#ctypes">ctypes</a></li>
<li><a class="reference internal" href="#dbm">dbm</a></li>
<li><a class="reference internal" href="#dis">dis</a></li>
<li><a class="reference internal" href="#doctest">doctest</a></li>
<li><a class="reference internal" href="#email">email</a></li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#glob">glob</a></li>
<li><a class="reference internal" href="#importlib">importlib</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#ipaddress">ipaddress</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#marshal">marshal</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mimetypes">mimetypes</a></li>
<li><a class="reference internal" href="#mmap">mmap</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#os-path">os.path</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#queue">queue</a></li>
<li><a class="reference internal" href="#random">random</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#site">site</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#statistics">statistics</a></li>
<li><a class="reference internal" href="#subprocess">subprocess</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#traceback">回溯</a></li>
<li><a class="reference internal" href="#types">types</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#venv">venv</a></li>
<li><a class="reference internal" href="#warnings">warnings</a></li>
<li><a class="reference internal" href="#xml">xml</a></li>
<li><a class="reference internal" href="#zipimport">zipimport</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a></li>
<li><a class="reference internal" href="#removed-modules-and-apis">被移除的模块与 API</a><ul>
<li><a class="reference internal" href="#pep-594-remove-dead-batteries-from-the-standard-library">PEP 594: 从标准库中移除“死电池”</a></li>
<li><a class="reference internal" href="#to3">2to3</a></li>
<li><a class="reference internal" href="#builtins">builtins</a></li>
<li><a class="reference internal" href="#id3">configparser</a></li>
<li><a class="reference internal" href="#importlib-metadata">importlib.metadata</a></li>
<li><a class="reference internal" href="#locale">locale</a></li>
<li><a class="reference internal" href="#opcode">opcode</a></li>
<li><a class="reference internal" href="#optparse">optparse</a></li>
<li><a class="reference internal" href="#id4">pathlib</a></li>
<li><a class="reference internal" href="#id5">re</a></li>
<li><a class="reference internal" href="#tkinter-tix">tkinter.tix</a></li>
<li><a class="reference internal" href="#turtle">turtle</a></li>
<li><a class="reference internal" href="#id6">typing</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-deprecations">新的弃用</a><ul>
<li><a class="reference internal" href="#pending-removal-in-python-3-14">Pending removal in Python 3.14</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-15">Pending removal in Python 3.15</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-16">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-future-versions">Pending removal in future versions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 字节码的变化</a></li>
<li><a class="reference internal" href="#c-api-changes">C API 的变化</a><ul>
<li><a class="reference internal" href="#id7">新的特性</a></li>
<li><a class="reference internal" href="#changed-c-apis">被改变的 C API</a></li>
<li><a class="reference internal" href="#limited-c-api-changes">受限 C API 的改变</a></li>
<li><a class="reference internal" href="#removed-c-apis">被移除的 C API</a></li>
<li><a class="reference internal" href="#deprecated-c-apis">已弃用的 C API</a><ul>
<li><a class="reference internal" href="#id8">Pending removal in Python 3.14</a></li>
<li><a class="reference internal" href="#id9">Pending removal in Python 3.15</a></li>
<li><a class="reference internal" href="#id10">Pending removal in future versions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#build-changes">构建变化</a></li>
<li><a class="reference internal" href="#porting-to-python-3-13">Porting to Python 3.13</a><ul>
<li><a class="reference internal" href="#changes-in-the-python-api">Python API 的变化</a></li>
<li><a class="reference internal" href="#changes-in-the-c-api">C API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regression-test-changes">回归测试的变化</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="3.14.html"
                          title="上一章">What's new in Python 3.14</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.12.html"
                          title="下一章">Python 3.12 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告 Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.13.rst"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.12.html" title="Python 3.12 有什么新变化"
             accesskey="N">下一页</a> |</li>
        <li class="right" >
          <a href="3.14.html" title="What&#39;s new in Python 3.14"
             accesskey="P">上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0a4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.13 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box" />
          <input type="submit" value="提交" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="what-s-new-in-python-3-13">
<h1>Python 3.13 有什么新变化<a class="headerlink" href="#what-s-new-in-python-3-13" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">编者<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adam Turner 和 Thomas Wouters</p>
</dd>
</dl>
<p>本文介绍了 Python 3.13 相比 3.12 增加的新特性。 Python 3.13 已于 2024 年 10 月 7 日发布。 要获取详细信息，可参阅 <a class="reference internal" href="changelog.html#changelog"><span class="std std-ref">更新日志</span></a>。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><span class="target" id="index-123"></span><a class="pep reference external" href="https://peps.python.org/pep-0719/"><strong>PEP 719</strong></a> -- Python 3.13 发布计划</p>
</div>
<section id="summary-release-highlights">
<h2>摘要 -- 发布重点<a class="headerlink" href="#summary-release-highlights" title="Link to this heading">¶</a></h2>
<p>Python 3.13 是 Python 编程语言的最新稳定发布版，包含多项针对语言、实现和标准库的改变。 最大的变化包括一个新的 <a class="reference internal" href="#whatsnew313-better-interactive-interpreter">交互式解释器</a>，以及对于在 <a class="reference internal" href="#whatsnew313-free-threaded-cpython">自由线程模式</a> (<span class="target" id="index-124"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a>) 下运行和 <a class="reference internal" href="#whatsnew313-jit-compiler">即时编译器</a> (<span class="target" id="index-125"></span><a class="pep reference external" href="https://peps.python.org/pep-0744/"><strong>PEP 744</strong></a>) 的实验性支持。</p>
<p>错误消息继续得到改进，回溯信息现在默认使用彩色高亮显示。 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 内置函数现在对于修改所返回的映射具有 <a class="reference internal" href="#whatsnew313-locals-semantics"><span class="std std-ref">更细化的语法</span></a>，并且类型形参现在支持设置默认值。</p>
<p>针对标准库的改变包括移除已弃用的 API 和模块，以及用户友好度和正确性方面的常规提升。 一些旧式标准库模块自 Python 3.11 起被弃用 (<span class="target" id="index-126"></span><a class="pep reference external" href="https://peps.python.org/pep-0594/"><strong>PEP 594</strong></a>) 之后现在 <a class="reference internal" href="#whatsnew313-pep594">已被移除</a>。</p>
<p>本文并不试图提供所有新特性的完整规范说明，而是提供一个方便的概览。 要了解完整细节请参阅相应文档，如 <a class="reference internal" href="../library/index.html#library-index"><span class="std std-ref">标准库参数</span></a> 和 <a class="reference internal" href="../reference/index.html#reference-index"><span class="std std-ref">语言参考</span></a>。 要了解某项改变的完整实现和设计理念，请参阅相应新特性的 PEP；但请注意一旦某项特性已完全实现则相应 PEP 通常不会再继续更新。 请参阅 <a class="reference internal" href="#porting-to-python-3-13">迁移到 Python 3.13</a> 了解如何从较早 Python 进行升级的指导。</p>
<hr class="docutils" />
<p>解释器的改进：</p>
<ul class="simple">
<li><p>大幅改进的 <a class="reference internal" href="#whatsnew313-better-interactive-interpreter"><span class="std std-ref">交互式解释器</span></a> 和 <a class="reference internal" href="#whatsnew313-improved-error-messages"><span class="std std-ref">改进的错误消息</span></a>。</p></li>
<li><p><span class="target" id="index-127"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a>: 现在 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 内置函数在修改被返回的映射时具有 <a class="reference internal" href="#whatsnew313-locals-semantics"><span class="std std-ref">已定义语义</span></a>。 Python 调试器及类似的工具现在即使在并发代码执行期间也能更可靠地在已优化的作用域中更新局部变量。</p></li>
<li><p><span class="target" id="index-128"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a>: CPython 3.13 具有对在运行时禁用 <a class="reference internal" href="../glossary.html#term-global-interpreter-lock"><span class="xref std std-term">global interpreter lock</span></a> 的实验性支持。 请参阅 <a class="reference internal" href="#whatsnew313-free-threaded-cpython"><span class="std std-ref">自由线程 CPython</span></a> 了解详情。</p></li>
<li><p><span class="target" id="index-129"></span><a class="pep reference external" href="https://peps.python.org/pep-0744/"><strong>PEP 744</strong></a>: 增加了一个基本的 <a class="reference internal" href="#whatsnew313-jit-compiler"><span class="std std-ref">JIT 编译器</span></a>。 目前默认是禁用的（但以后可能启用）。 能够小幅提升性能 -- 我们预计在接下来的几个发布版中不断改进它。</p></li>
<li><p>在新的 <a class="reference internal" href="#whatsnew313-better-interactive-interpreter"><span class="std std-ref">交互式解释器</span></a> 中，以及 <a class="reference internal" href="#whatsnew313-improved-error-messages"><span class="std std-ref">回溯信息</span></a> 和 <a class="reference internal" href="#whatsnew313-doctest"><span class="std std-ref">文档测试</span></a> 输出中的颜色支持。 这可以通过 <span class="target" id="index-130"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_COLORS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_COLORS</span></code></a> and <a class="reference external" href="https://no-color.org/"><code class="docutils literal notranslate"><span class="pre">NO_COLOR</span></code></a> 环境变量来禁用。</p></li>
</ul>
<p>对 Python 数据模型的改进：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/datamodel.html#type.__static_attributes__" title="type.__static_attributes__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__static_attributes__</span></code></a> 保存了可在一个类体的任何函数中通过 <code class="docutils literal notranslate"><span class="pre">self.X</span></code> 来访问的属性名称。</p></li>
<li><p><a class="reference internal" href="../reference/datamodel.html#type.__firstlineno__" title="type.__firstlineno__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__firstlineno__</span></code></a> 记录了一个类定义的首行的行号。</p></li>
</ul>
<p>标准库中的重大改进：</p>
<ul class="simple">
<li><p>新增了 <a class="reference internal" href="../library/exceptions.html#PythonFinalizationError" title="PythonFinalizationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">PythonFinalizationError</span></code></a> 异常，当操作在 <a class="reference internal" href="../glossary.html#term-interpreter-shutdown"><span class="xref std std-term">最终化</span></a> 期间被阻塞时将被引发。</p></li>
<li><p>现在 <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a> 模块可支持弃用命令行选项、位置参数和子命令。</p></li>
<li><p>新增的函数 <a class="reference internal" href="../library/base64.html#base64.z85encode" title="base64.z85encode"><code class="xref py py-func docutils literal notranslate"><span class="pre">base64.z85encode()</span></code></a> 和 <a class="reference internal" href="../library/base64.html#base64.z85decode" title="base64.z85decode"><code class="xref py py-func docutils literal notranslate"><span class="pre">base64.z85decode()</span></code></a> 支持对 <a class="reference external" href="https://rfc.zeromq.org/spec/32/">Z85 数据</a> 进行编码和解码。</p></li>
<li><p>现在 <a class="reference internal" href="../library/copy.html#module-copy" title="copy: Shallow and deep copy operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code></a> 模块有一个 <a class="reference internal" href="../library/copy.html#copy.replace" title="copy.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.replace()</span></code></a> 函数，支持许多内置类型和任何定义了 <a class="reference internal" href="../library/copy.html#object.__replace__" title="object.__replace__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__replace__()</span></code></a> 方法的类。</p></li>
<li><p>新的 <a class="reference internal" href="../library/dbm.html#module-dbm.sqlite3" title="dbm.sqlite3: SQLite backend for dbm (All)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm.sqlite3</span></code></a> 模块现在是默认的 <a class="reference internal" href="../library/dbm.html#module-dbm" title="dbm: Interfaces to various Unix &quot;database&quot; formats."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm</span></code></a> 后端。</p></li>
<li><p><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a> 模块增加了 <a class="reference internal" href="../library/os.html#os-timerfd"><span class="std std-ref">一套新函数</span></a> 用于处理 Linux 的定时器通知文件描述符。</p></li>
<li><p>现在 <a class="reference internal" href="../library/random.html#module-random" title="random: Generate pseudo-random numbers with various common distributions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">random</span></code></a> 模块提供了一个 <a class="reference internal" href="../library/random.html#random-cli"><span class="std std-ref">命令行界面</span></a>。</p></li>
</ul>
<p>安全改进：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">ssl.create_default_context()</span></code></a> 设置了 <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_PARTIAL_CHAIN" title="ssl.VERIFY_X509_PARTIAL_CHAIN"><code class="xref py py-data docutils literal notranslate"><span class="pre">ssl.VERIFY_X509_PARTIAL_CHAIN</span></code></a> 和 <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_STRICT" title="ssl.VERIFY_X509_STRICT"><code class="xref py py-data docutils literal notranslate"><span class="pre">ssl.VERIFY_X509_STRICT</span></code></a> 作为默认的旗标。</p></li>
</ul>
<p>C API 的改进：</p>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../c-api/module.html#c.Py_mod_gil" title="Py_mod_gil"><code class="xref c c-data docutils literal notranslate"><span class="pre">Py_mod_gil</span></code></a> 槽位被用来指明一个扩展模块支持在禁用 <a class="reference internal" href="../glossary.html#term-GIL"><span class="xref std std-term">GIL</span></a> 的情况下运行。</p></li>
<li><p>增加了 <a class="reference internal" href="../c-api/time.html"><span class="doc">PyTime C API</span></a>，提供了对系统时钟的访问。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyMutex" title="PyMutex"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyMutex</span></code></a> 是新增的轻量级互斥锁，只占用一个字节。</p></li>
<li><p>新增了 <a class="reference internal" href="../c-api/monitoring.html#c-api-monitoring"><span class="std std-ref">一套函数</span></a> 用于在 C API 中生成 <span class="target" id="index-131"></span><a class="pep reference external" href="https://peps.python.org/pep-0669/"><strong>PEP 669</strong></a> 监控事件。</p></li>
</ul>
<p>新的类型标注特性：</p>
<ul class="simple">
<li><p><span class="target" id="index-132"></span><a class="pep reference external" href="https://peps.python.org/pep-0696/"><strong>PEP 696</strong></a>: 类型形参 (<a class="reference internal" href="../library/typing.html#typing.TypeVar" title="typing.TypeVar"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypeVar</span></code></a>, <a class="reference internal" href="../library/typing.html#typing.ParamSpec" title="typing.ParamSpec"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.ParamSpec</span></code></a> 和 <a class="reference internal" href="../library/typing.html#typing.TypeVarTuple" title="typing.TypeVarTuple"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypeVarTuple</span></code></a>) 现在可支持默认值。</p></li>
<li><p><span class="target" id="index-133"></span><a class="pep reference external" href="https://peps.python.org/pep-0702/"><strong>PEP 702</strong></a>: 新的 <a class="reference internal" href="../library/warnings.html#warnings.deprecated" title="warnings.deprecated"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.deprecated()</span></code></a> 装饰器在类型系统和运行时中增加了对标记为弃用的支持。</p></li>
<li><p><span class="target" id="index-134"></span><a class="pep reference external" href="https://peps.python.org/pep-0705/"><strong>PEP 705</strong></a>: <a class="reference internal" href="../library/typing.html#typing.ReadOnly" title="typing.ReadOnly"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.ReadOnly</span></code></a> 可被用来将 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.TypedDict</span></code></a> 的项标记为对类型检查器只读。</p></li>
<li><p><span class="target" id="index-135"></span><a class="pep reference external" href="https://peps.python.org/pep-0742/"><strong>PEP 742</strong></a>: <a class="reference internal" href="../library/typing.html#typing.TypeIs" title="typing.TypeIs"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypeIs</span></code></a> 提供了更直观的类型细化行为，作为对 <a class="reference internal" href="../library/typing.html#typing.TypeGuard" title="typing.TypeGuard"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.TypeGuard</span></code></a> 的替代。</p></li>
</ul>
<p>平台支持：</p>
<ul class="simple">
<li><p><span class="target" id="index-136"></span><a class="pep reference external" href="https://peps.python.org/pep-0730/"><strong>PEP 730</strong></a>: 现在 Apple 的 iOS 是 <a class="reference internal" href="#whatsnew313-platform-support"><span class="std std-ref">官方支持的平台</span></a>，处于 <span class="target" id="index-137"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-3"><strong>第 3 层级</strong></a>。</p></li>
<li><p><span class="target" id="index-138"></span><a class="pep reference external" href="https://peps.python.org/pep-0738/"><strong>PEP 738</strong></a>: 现在 Android 是 <a class="reference internal" href="#whatsnew313-platform-support"><span class="std std-ref">官方支持的平台</span></a>，处于 <span class="target" id="index-139"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-3"><strong>第 3 层级</strong></a>。</p></li>
<li><p>现在 <code class="docutils literal notranslate"><span class="pre">wasm32-wasi</span></code> 作为 <span class="target" id="index-140"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/#tier-2"><strong>第 2 层级</strong></a> 的平台受到支持。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wasm32-emscripten</span></code> 不再是受到官方支持的平台。</p></li>
</ul>
<p>重要的移除：</p>
<ul class="simple">
<li><p><a class="reference internal" href="#whatsnew313-pep594"><span class="std std-ref">PEP 594</span></a>: 剩余的 19 个“死电池”（老旧 stdlib 模块）已从标准库中移除: <code class="xref py py-mod docutils literal notranslate"><span class="pre">aifc</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">audioop</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">cgi</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">cgitb</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">chunk</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">crypt</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">imghdr</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">mailcap</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">nis</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">nntplib</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">ossaudiodev</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">pipes</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">sndhdr</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">spwd</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">sunau</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">telnetlib</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">uu</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">xdrlib</span></code>。</p></li>
<li><p>移除了 <strong class="program">2to3</strong> 工具和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">lib2to3</span></code> 模块（在 Python 3.11 中已被弃用）。</p></li>
<li><p>移除了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter.tix</span></code> 模块（在 Python 3.6 中已被弃用）。</p></li>
<li><p>移除了 <code class="xref py py-func docutils literal notranslate"><span class="pre">locale.resetlocale()</span></code> 函数。</p></li>
<li><p>移除了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">typing.io</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">typing.re</span></code> 命名空间。</p></li>
<li><p>移除了链式的 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a> 描述器。</p></li>
</ul>
<p>发布计划的变化：</p>
<p><span class="target" id="index-141"></span><a class="pep reference external" href="https://peps.python.org/pep-0602/"><strong>PEP 602</strong></a> (&quot;Annual Release Cycle for Python&quot;) 已被更新为将新发布版的完整支持 ('bugfix') 期扩展至两年。 这个更新的政策意味着：</p>
<ul class="simple">
<li><p>Python 3.9--3.12 有一年半的完整支持，另加三年半的安全修正。</p></li>
<li><p>Python 3.13 及以后的版本有两年的完整支持，另加三年的安全修正。</p></li>
</ul>
</section>
<section id="new-features">
<h2>新的特性<a class="headerlink" href="#new-features" title="Link to this heading">¶</a></h2>
<section id="a-better-interactive-interpreter">
<span id="whatsnew313-better-interactive-interpreter"></span><h3>更好的交互式解释器<a class="headerlink" href="#a-better-interactive-interpreter" title="Link to this heading">¶</a></h3>
<p>Python 现在默认会使用新的 <a class="reference internal" href="../glossary.html#term-interactive"><span class="xref std std-term">interactive</span></a> shell，它基于来自 <a class="reference external" href="https://pypy.org/">PyPy 项目</a> 的代码。 当使用从交互式终端启动 <a class="reference internal" href="../glossary.html#term-REPL"><span class="xref std std-term">REPL</span></a> 时，下列新特性将受到支持：</p>
<ul class="simple">
<li><p>多行编辑并保留历史记录。</p></li>
<li><p>对 REPL 专属的命令如 <kbd class="kbd docutils literal notranslate">help</kbd>, <kbd class="kbd docutils literal notranslate">exit</kbd> 和 <kbd class="kbd docutils literal notranslate">quit</kbd> 的直接支持，无需以函数形式调用它们。</p></li>
<li><p>提示和回溯 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">默认启用彩色显示</span></a>。</p></li>
<li><p>使用 <kbd class="kbd docutils literal notranslate">F1</kbd> 浏览交互式帮助并带有单独的命令历史。</p></li>
<li><p>使用 <kbd class="kbd docutils literal notranslate">F2</kbd> 浏览去除了输出以及 <a class="reference internal" href="../glossary.html#term-0"><span class="xref std std-term">&gt;&gt;&gt;</span></a> 和 <a class="reference internal" href="../glossary.html#term-..."><span class="xref std std-term">...</span></a> 提示符的历史。</p></li>
<li><p>使用 <kbd class="kbd docutils literal notranslate">F3</kbd> 进入“粘贴模式”以更方便地粘贴大段代码（再次按 <kbd class="kbd docutils literal notranslate">F3</kbd> 返回常规提示符）。</p></li>
</ul>
<p>要禁用新的交互式 shell，可设置 <span class="target" id="index-142"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_BASIC_REPL"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_BASIC_REPL</span></code></a> 环境变量。 有关交互模式的详情，请参见 <a class="reference internal" href="../tutorial/appendix.html#tut-interac"><span class="std std-ref">交互模式</span></a>。</p>
<p>（由 Pablo Galindo Salgado, Łukasz Langa 和 Lysandros Nikolaou 在 <a class="reference external" href="https://github.com/python/cpython/issues/111201">gh-111201</a> 基于来自 PyPy 项目的代码贡献。 Windows 支持由 Dino Viehland 和 Anthony Shaw 贡献。）</p>
</section>
<section id="improved-error-messages">
<span id="whatsnew313-improved-error-messages"></span><h3>改进的错误消息<a class="headerlink" href="#improved-error-messages" title="Link to this heading">¶</a></h3>
<ul>
<li><p>在终端里显示回溯时解释器现在会默认使用彩色。 此特性可通过新的 <span class="target" id="index-143"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_COLORS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_COLORS</span></code></a> 环境变量以及传统的 <a class="reference external" href="https://no-color.org/"><code class="docutils literal notranslate"><span class="pre">NO_COLOR</span></code></a> 和 <a class="reference external" href="https://force-color.org/"><code class="docutils literal notranslate"><span class="pre">FORCE_COLOR</span></code></a> 环境变量来 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">进行控制</span></a>。 （由 Pablo Galindo Salgado 在 <a class="reference external" href="https://github.com/python/cpython/issues/112730">gh-112730</a> 中贡献。）</p></li>
<li><p>一个常见错误是撰写的脚本和标准库中的某个模块重名。现在出现此类错误时会显示一条更有用的错误信息：</p>
<div class="highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="x">$ python random.py</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/home/me/random.py&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
  File <span class="nb">&quot;/home/me/random.py&quot;</span>, line <span class="m">3</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="nb">print</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="w">          </span><span class="pm">^^^^^^^^^^^^^^</span>
<span class="gr">AttributeError</span>: <span class="n">module &#39;random&#39; has no attribute &#39;randint&#39; (consider renaming &#39;/home/me/random.py&#39; since it has the same name as the standard library module named &#39;random&#39; and prevents importing that standard library module)</span>
</pre></div>
</div>
<p>类似地，如果一个脚本具有与它尝试导入的第三方模块相同的名称并因此导致错误，我们也会显示一条更有帮助的错误消息：</p>
<div class="highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="x">$ python numpy.py</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/home/me/numpy.py&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
  File <span class="nb">&quot;/home/me/numpy.py&quot;</span>, line <span class="m">3</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="w">    </span><span class="pm">^^^^^^^^</span>
<span class="gr">AttributeError</span>: <span class="n">module &#39;numpy&#39; has no attribute &#39;array&#39; (consider renaming &#39;/home/me/numpy.py&#39; if it has the same name as a library you intended to import)</span>
</pre></div>
</div>
<p>(由 Shantanu Jain 在 <a class="reference external" href="https://github.com/python/cpython/issues/95754">gh-95754</a> 中贡献）。</p>
</li>
<li><p>现在当向一个函数传入不正确的关键字参数时错误消息会尝试提示正确的关键字参数。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;Better error messages!&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">max_split</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;python-input-0&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="s2">&quot;Better error messages!&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">max_split</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="pm">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^</span>
<span class="gr">TypeError</span>: <span class="n">split() got an unexpected keyword argument &#39;max_split&#39;. Did you mean &#39;maxsplit&#39;?</span>
</pre></div>
</div>
<p>（由 Pablo Galindo Salgado 和 Shantanu Jain 在 <a class="reference external" href="https://github.com/python/cpython/issues/107944">gh-107944</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="free-threaded-cpython">
<span id="whatsnew313-free-threaded-cpython"></span><h3>自由线程的 CPython<a class="headerlink" href="#free-threaded-cpython" title="Link to this heading">¶</a></h3>
<p>现在 CPython 具有对运行于禁用 <a class="reference internal" href="../glossary.html#term-global-interpreter-lock"><span class="xref std std-term">global interpreter lock</span></a> (GIL) 的自由线程模式的实验性支持。 这是一个实验性的特性因而默认是不启用的。 自由线程模式需要一个不同的可执行程序，通常名为 <code class="docutils literal notranslate"><span class="pre">python3.13t</span></code> 或 <code class="docutils literal notranslate"><span class="pre">python3.13t.exe</span></code>。 标记为 <em>free-threaded</em> 的预构建二进制文件可作为官方 <a class="reference internal" href="../using/windows.html#install-freethreaded-windows"><span class="std std-ref">Windows</span></a> 和 <a class="reference internal" href="../using/mac.html#install-freethreaded-macos"><span class="std std-ref">macOS</span></a> 安装器的一部分被安装，或者可以附带 <a class="reference internal" href="../using/configure.html#cmdoption-disable-gil"><code class="xref std std-option docutils literal notranslate"><span class="pre">--disable-gil</span></code></a> 选项使用源代码来构建 CPython。</p>
<p>自由线程模式的执行允许在可用的 CPU 核心上并行地运行线程从而充分利用可用的处理能力。 虽然并非所有软件都能自动从中受益，但在设计时将线程纳入考虑的程序在多核心硬件上运行速度会更快。 <strong>自由线程模式是实验性的</strong> 并且处于不断改进的过程中：预计会出现一些程序错误并且在单线程场景下出现明显的性能损失。 可以选择使用环境变量 <span class="target" id="index-144"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_GIL"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_GIL</span></code></a> 或命令行选项 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">gil=1</span></code></a> 让 CPython 的自由线程构建版支持在运行时启用 GIL。</p>
<p>为了检查当前解释器是否支持自由线程，<a class="reference internal" href="../using/cmdline.html#cmdoption-V"><code class="xref std std-option docutils literal notranslate"><span class="pre">python</span> <span class="pre">-VV</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.version" title="sys.version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sys.version</span></code></a> 将包含 &quot;experimental free-theading build&quot; 字样。 可以使用新增的 <code class="xref py py-func docutils literal notranslate"><span class="pre">sys._is_gil_enabled()</span></code> 函数来检查正在运行的线程是否确实禁用了 GIL。</p>
<p>C-API 扩展模块需要针对自由线程构建版专门进行构建。 支持在禁用 <a class="reference internal" href="../glossary.html#term-GIL"><span class="xref std std-term">GIL</span></a> 的情况下运行的扩展应当使用 <a class="reference internal" href="../c-api/module.html#c.Py_mod_gil" title="Py_mod_gil"><code class="xref c c-data docutils literal notranslate"><span class="pre">Py_mod_gil</span></code></a> 槽位。 使用单阶段初始化的扩展应当使用 <a class="reference internal" href="../c-api/module.html#c.PyUnstable_Module_SetGIL" title="PyUnstable_Module_SetGIL"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Module_SetGIL()</span></code></a> 来指明它们是支支持在禁用 GIL 的情况下运行。 导入不使用这些机制的 C 扩展将导致 GIL 被启用，除非通过 <span class="target" id="index-145"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_GIL"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_GIL</span></code></a> 环境变量或 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">gil=0</span></code></a> 选项显式地禁用 GIL。 需要 pip 24.1 或更新的版本才能在自由线程构建版中安装带有 C 扩展的软件包。</p>
<p>这项工作成为可能要感谢许多个人和组织，包括针对 Python 和第三方项目测试并启用自由线程支持的庞大的贡献者社区。 重要的贡献者包括：Sam Gross, Ken Jin, Donghee Na, Itamar Oren, Matt Page, Brett Simmers, Dino Viehland, Carl Meyer, Nathan Goldbaum, Ralf Gommers, Lysandros Nikolaou 及其他许多人。 有许多贡献者受雇于 Meta，该公司提供了大量的工程资源来支持此项目。</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><span class="target" id="index-146"></span><a class="pep reference external" href="https://peps.python.org/pep-0703/"><strong>PEP 703</strong></a> &quot;Making the Global Interpreter Lock Optional in CPython&quot; 中包含了有关此项工作的理念和信息。</p>
<p><a class="reference external" href="https://py-free-threading.github.io/porting/">Porting Extension Modules to Support Free-Threading</a>: 一份由社区维护的针对扩展开发者的移植指南。</p>
</div>
</section>
<section id="an-experimental-just-in-time-jit-compiler">
<span id="whatsnew313-jit-compiler"></span><h3>实验性的即时 (JIT) 编译器<a class="headerlink" href="#an-experimental-just-in-time-jit-compiler" title="Link to this heading">¶</a></h3>
<p>当 CPython 使用 <code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-experimental-jit</span></code> 选项进行配置和构建时，会添加一个即时（JIT）编译器以加快某些 Python 程序的运行速度。 在 Windows 上，可使用 <code class="docutils literal notranslate"><span class="pre">PCbuild/build.bat</span> <span class="pre">--experimental-jit</span></code> 启用 JIT 或使用 <code class="docutils literal notranslate"><span class="pre">--experimental-jit-interpreter</span></code> 启用第 2 层级解释器。 构建要求和进一步的支持信息 <a class="reference external" href="https://github.com/python/cpython/blob/main/Tools/jit/README.md">包含在</a> <code class="file docutils literal notranslate"><span class="pre">Tools/jit/README.md</span></code> 中。</p>
<p><code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-experimental-jit</span></code> 选项接受这些（可选）值，如果不带可选值地预设 <code class="xref std std-option docutils literal notranslate"><span class="pre">--enable-experimental-jit</span></code> 则默认为 <code class="docutils literal notranslate"><span class="pre">yes</span></code>。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">no</span></code>: 禁用整个第 2 层级和 JIT 管线。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yes</span></code>: 启用 JIT。 要在运行时禁用 JIT，则传入环境变量 <code class="docutils literal notranslate"><span class="pre">PYTHON_JIT=0</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yes-off</span></code>: 构建 JIT 但默认禁用它。 要在运行时启用 JIT，则传入环境变量 <code class="docutils literal notranslate"><span class="pre">PYTHON_JIT=1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interpreter</span></code>: 启用第 2 层级解释器但是禁用 JIT。 可以在运行时传入 <code class="docutils literal notranslate"><span class="pre">PYTHON_JIT=0</span></code> 来禁用该解释器。</p></li>
</ul>
<p>其内部架构大致如下：</p>
<ul class="simple">
<li><p>我们将从特化的 <em>第 1 层级字节码</em> 开始。 请参阅 <a class="reference internal" href="3.11.html#whatsnew311-pep659"><span class="std std-ref">3.11 有什么新变化</span></a> 了解详情。</p></li>
<li><p>当第 1 层级字节码达到足够热度，它将被翻译为新的纯内部的中间表示形式 (IR)，称为 <em>第 2 层级 IR</em>，有时也称为微操作码 (&quot;uops&quot;)。</p></li>
<li><p>第 2 层级 IR 使用与第 1 层级相同的基于栈的虚拟机，但其指令格式更适合被翻译为机器码。</p></li>
<li><p>在第 2 层级 IR 被解释或翻译为机器码之前，我们会预先应用一些优化通路。</p></li>
<li><p>虽然第 2 层级解释器存在，但它主要用于对优化管线的先前阶段进行调试。可通过为 Python 配置 <code class="docutils literal notranslate"><span class="pre">--enable-experimental-jit=interpreter</span></code> 选项启用第 2 层级解释器。</p></li>
<li><p>启用 JIT 时，经优化的第 2 层级 IR 将被翻译为机器码后再执行。</p></li>
<li><p>这个机器码翻译过程使用了名为 <em>拷贝并打补丁</em> 的技巧。 它没有运行时依赖，但增加了构建时对 LLVM 的依赖。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><span class="target" id="index-24"></span><a class="pep reference external" href="https://peps.python.org/pep-0744/"><strong>PEP 744</strong></a></p>
</div>
<p>（JIT 来自 Brandt Bucher 且受到 Haoran Xu 和 Fredrik Kjolstad 论文的启发。第 2 层级 IR 来自 Mark Shannon 和 Guido van Rossum。第 2 层级解释器来自 Ken Jin。）</p>
</section>
<section id="defined-mutation-semantics-for-locals">
<span id="whatsnew313-locals-semantics"></span><h3>针对 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 的已定义修改语义<a class="headerlink" href="#defined-mutation-semantics-for-locals" title="Link to this heading">¶</a></h3>
<p>在历史上，改变 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 的返回值的预期结果是留给具体的 Python 实现来定义的。 从 Python 3.13 开始，<span class="target" id="index-147"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 标准化了 CPython 对于大多数代码执行作用域的历史行为，但也将 <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">已优化作用域</span></a> (函数、生成器、协程、推导式和生成器表达式) 修改为显式地返回当前已赋值的局部变量的独立快照，包括局部引用的在闭包中捕获的非局部变量。</p>
<p>在已优化作用域中对 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 语义的这项修改也会影响隐式地以 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code> 为目标的代码执行函数的默认行为，如果没有提供显式命名空间的话（例如 <a class="reference internal" href="../library/functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a> 和 <a class="reference internal" href="../library/functions.html#eval" title="eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> 等）。 在之前的版本中，在调用代码执行函数后是否可以通过调用 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code> 访问更改情况取决于具体的实现。 具体到 CPython 而言，此类代码通常会按预期工作，但有时可能会在基于其他代码（包括调试器和代码执行跟踪工具）的已优化作用域中失败，因为代码有可能重置该作用域中的共享快照。 现在，代码在已优化作用域中将始终针对局部变量的独立快照运行，因为在后续调用 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code> 时将永远看不到更改。 要访问在这些情况下所做的更改，现在必须将一个显式命名空间引用传递给相关的函数。 或者，也可以更新受影响的代码以使用更高层级的代码执行 API 返回结果代码命名空间（例如，当执行磁盘上的 Python 文件时使用 <a class="reference internal" href="../library/runpy.html#runpy.run_path" title="runpy.run_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">runpy.run_path()</span></code></a> 函数）。</p>
<p>为确保调试器和类似工具能可靠地更新受到此变化影响的作用域中的局部变量，现在 <a class="reference internal" href="../reference/datamodel.html#frame.f_locals" title="frame.f_locals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FrameType.f_locals</span></code></a> 将返回一个针对此种作用域中的帧的局部变量和在局部引用的非局部变量的直通写入代理对象，而不是返回一个非持续更新的具有规定义的运行时语义的共享 <code class="docutils literal notranslate"><span class="pre">dict</span></code> 实例。</p>
<p>请参阅 <span class="target" id="index-148"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 了解详情，包括相关的 C API 更改和弃用。 下文还针对受影响的 <a class="reference internal" href="#pep667-porting-notes-py"><span class="std std-ref">Python API</span></a> 和 <a class="reference internal" href="#pep667-porting-notes-c"><span class="std std-ref">C API</span></a> 提供了移植说明。</p>
<p>（PEP 和实现由 Mark Shannon 和 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/74929">gh-74929</a> 中贡献。 文档更新由 Guido van Rossum 和 Alyssa Coghlan 提供。）</p>
</section>
<section id="support-for-mobile-platforms">
<span id="whatsnew313-platform-support"></span><h3>对移动平台的支持<a class="headerlink" href="#support-for-mobile-platforms" title="Link to this heading">¶</a></h3>
<p><span class="target" id="index-149"></span><a class="pep reference external" href="https://peps.python.org/pep-0730/"><strong>PEP 730</strong></a>: iOS 现在是 <span class="target" id="index-150"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 所支持的平台，包括第 3 层级的 <code class="docutils literal notranslate"><span class="pre">arm64-apple-ios</span></code> 和 <code class="docutils literal notranslate"><span class="pre">arm64-apple-ios-simulator</span></code> 等目标（分别为2013 年后的 iPhone 和 iPad 设备以及运行于 Apple silicon 硬件的 Xcode iOS 模拟器）。 <code class="docutils literal notranslate"><span class="pre">x86_64-apple-ios-simulator</span></code> （运行于较旧的 <code class="docutils literal notranslate"><span class="pre">x86_64</span></code> 硬件的 Xcode iOS 模拟器）不是第 3 层级的受支持平台，但也将尽可能地支持。 （PEP 撰写及实现由 Russell Keith-Magee 在 <a class="reference external" href="https://github.com/python/cpython/issues/114099">gh-114099</a> 中贡献。）.)</p>
<p><span class="target" id="index-151"></span><a class="pep reference external" href="https://peps.python.org/pep-0738/"><strong>PEP 738</strong></a>: Android 现在是 <span class="target" id="index-152"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 所支持的平台，包括位于第 3 层级的 <code class="docutils literal notranslate"><span class="pre">aarch64-linux-android</span></code> 和 <code class="docutils literal notranslate"><span class="pre">x86_64-linux-android</span></code> 等目标。 32 位的目标 <code class="docutils literal notranslate"><span class="pre">arm-linux-androideabi</span></code> 和 <code class="docutils literal notranslate"><span class="pre">i686-linux-android</span></code> 不是第 3 层级的受支持平台，但也将尽可能地支持。 （PEP 撰写及实现由 Malcolm Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/116622">gh-116622</a> 中贡献。）</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><span class="target" id="index-31"></span><a class="pep reference external" href="https://peps.python.org/pep-0730/"><strong>PEP 730</strong></a>, <span class="target" id="index-32"></span><a class="pep reference external" href="https://peps.python.org/pep-0738/"><strong>PEP 738</strong></a></p>
</div>
</section>
</section>
<section id="other-language-changes">
<h2>其他语言特性修改<a class="headerlink" href="#other-language-changes" title="Link to this heading">¶</a></h2>
<ul>
<li><p>编译器现在将从文档字符串的每一行去除共有的前导空格。 这会减少 <a class="reference internal" href="../glossary.html#term-bytecode"><span class="xref std std-term">字节码缓存</span></a> 的大小（例如 <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> 文件），例如在 SQLAlchemy 2.0 的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlalchemy.orm.session</span></code> 中文件大小将减少约 5%。 这项改变将影响各种使用了文档字符串的工具，如 <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a>。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">spam</span><span class="p">():</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="sd">        This is a docstring with</span>
<span class="gp">... </span><span class="sd">          leading whitespace.</span>
<span class="gp">...</span>
<span class="gp">... </span><span class="sd">        It even has multiple paragraphs!</span>
<span class="gp">... </span><span class="sd">    &quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spam</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="go">&#39;\nThis is a docstring with\n  leading whitespace.\n\nIt even has multiple paragraphs!\n&#39;</span>
</pre></div>
</div>
<p>（由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/81283">gh-81283</a> 中贡献。）</p>
</li>
<li><p>类作用域内的 <a class="reference internal" href="../reference/executionmodel.html#annotation-scopes"><span class="std std-ref">标注作用域</span></a> 现在可以包含 lambda 和推导式。 位于类作用域内的推导式不会内联到其父作用域中。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">C</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="nb">type</span> <span class="n">Alias</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">T</span>
</pre></div>
</div>
<p>（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/109118">gh-109118</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/118160">gh-118160</a> 中贡献。）</p>
</li>
<li><p><a class="reference internal" href="../reference/simple_stmts.html#future"><span class="std std-ref">future 语句</span></a> 不再会被 <a class="reference internal" href="../library/__future__.html#module-__future__" title="__future__: Future statement definitions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">__future__</span></code></a> 模块的相对导入触发，意味着 <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">.__future__</span> <span class="pre">import</span> <span class="pre">...</span></code> 形式的语句现在只是标准的相对导入，而不会激活任何特殊特性。 （由 Jeremiah Gabriel Pascual 在 <a class="reference external" href="https://github.com/python/cpython/issues/118216">gh-118216</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../reference/simple_stmts.html#global"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">global</span></code></a> 声明当其被用于 <a class="reference internal" href="../reference/compound_stmts.html#else"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">else</span></code></a> 代码块中时也将被允许在 <a class="reference internal" href="../reference/compound_stmts.html#except"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">except</span></code></a> 代码块中使用。 在之前版本中这会错误地引发 <a class="reference internal" href="../library/exceptions.html#SyntaxError" title="SyntaxError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SyntaxError</span></code></a>。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/111123">gh-111123</a> 中贡献。）</p></li>
<li><p>增加了新的环境变量 <span class="target" id="index-153"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_FROZEN_MODULES"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_FROZEN_MODULES</span></code></a>，它确定冻结模块是否会被导入机制所忽略，等价于 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">frozen_modules</span></code></a> 命令行选项。 （由 Yilei Yang 在 <a class="reference external" href="https://github.com/python/cpython/issues/111374">gh-111374</a> 中贡献。）</p></li>
<li><p>通过新的环境变量 <span class="target" id="index-154"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_PERF_JIT_SUPPORT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_PERF_JIT_SUPPORT</span></code></a> 和命令行选项 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">perf_jit</span></code></a> 添加无需 <a class="reference external" href="https://en.wikipedia.org/wiki/Call_stack">帧指针</a> 即可工作的 <a class="reference internal" href="../howto/perf_profiling.html#perf-profiling"><span class="std std-ref">对 perf 性能分析器的支持</span></a>。 （由 Pablo Galindo 在 <a class="reference external" href="https://github.com/python/cpython/issues/118518">gh-118518</a> 中贡献。）</p></li>
<li><p>可通过新的 <span class="target" id="index-155"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_HISTORY"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_HISTORY</span></code></a> 环境变量来更改 <code class="file docutils literal notranslate"><span class="pre">.python_history</span></code> 文件的位置。 （由 Levi Sabah, Zackery Spytz 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/73965">gh-73965</a> 中贡献。）</p></li>
<li><p>类新增了一个 <a class="reference internal" href="../reference/datamodel.html#type.__static_attributes__" title="type.__static_attributes__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__static_attributes__</span></code></a> 属性。 这由编译器以类属性名称的元组来填充，这些名称是从类体中的任何函数通过 <code class="docutils literal notranslate"><span class="pre">self.&lt;name&gt;</span></code> 来赋值的。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/115775">gh-115775</a> 中贡献。）.)</p></li>
<li><p>编译器现在会在类上创建一个 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__firstlineno__</span></code> 属性，其值为类定义第一行的行号。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/118465">gh-118465</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/functions.html#exec" title="exec"><code class="xref py py-func docutils literal notranslate"><span class="pre">exec()</span></code></a> 和 <a class="reference internal" href="../library/functions.html#eval" title="eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> 内置函数接受以关键字形式传入的 <em>globals</em> 和 <em>locals</em> 参数。 （由 Raphael Gaschignard 在 <a class="reference external" href="https://github.com/python/cpython/issues/105879">gh-105879</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/functions.html#compile" title="compile"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a> 内置函数接受一个新的旗标 <code class="docutils literal notranslate"><span class="pre">ast.PyCF_OPTIMIZED_AST</span></code>，它类似于 <code class="docutils literal notranslate"><span class="pre">ast.PyCF_ONLY_AST</span></code> 但区别在于返回的 AST 是根据 <em>optimize</em> 参数的值进行优化的。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/108113">gh-108113</a> 中贡献。）</p></li>
<li><p>在 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-class docutils literal notranslate"><span class="pre">property</span></code></a> 对象上增加了 <a class="reference internal" href="../library/functions.html#property.__name__" title="property.__name__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__name__</span></code></a> 属性。 （由 Eugene Toder 在 <a class="reference external" href="https://github.com/python/cpython/issues/101860">gh-101860</a> 中贡献。）</p></li>
<li><p>增加了新的异常 <a class="reference internal" href="../library/exceptions.html#PythonFinalizationError" title="PythonFinalizationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">PythonFinalizationError</span></code></a>，它派生自 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>，用于当操作在 <a class="reference internal" href="../glossary.html#term-interpreter-shutdown"><span class="xref std std-term">最终化</span></a> 期间被阻塞时发出信号。 下列可调用对象现在将引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">PythonFinalizationError</span></code>，而不是 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/_thread.html#thread.start_new_thread" title="_thread.start_new_thread"><code class="xref py py-func docutils literal notranslate"><span class="pre">_thread.start_new_thread()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/os.html#os.fork" title="os.fork"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.fork()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/os.html#os.forkpty" title="os.forkpty"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.forkpty()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/subprocess.html#subprocess.Popen" title="subprocess.Popen"><code class="xref py py-class docutils literal notranslate"><span class="pre">subprocess.Popen</span></code></a></p></li>
</ul>
<p>（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/114570">gh-114570</a> 中贡献。）</p>
</li>
<li><p>允许 <a class="reference internal" href="../library/stdtypes.html#str.replace" title="str.replace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">str.replace()</span></code></a> 的 <em>count</em> 参数为关键字参数。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/106487">gh-106487</a> 中贡献。）</p></li>
<li><p>现在许多函数会对将布尔值作为文件描述符参数发出警告。这可以帮助尽早发现一些错误。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/82626">gh-82626</a> 中贡献。）</p></li>
<li><p>为 <a class="reference internal" href="../library/bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><code class="xref py py-mod docutils literal notranslate"><span class="pre">bz2</span></code></a>, <a class="reference internal" href="../library/lzma.html#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">lzma</span></code></a>, <a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a> 和 <a class="reference internal" href="../library/zipfile.html#module-zipfile" title="zipfile: Read and write ZIP-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipfile</span></code></a> 等模块中的已压缩和已归档文件型对象添加了 <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code> 和 <code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code> 属性。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/115961">gh-115961</a> 中贡献。）</p></li>
</ul>
</section>
<section id="new-modules">
<h2>新增模块<a class="headerlink" href="#new-modules" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../library/dbm.html#module-dbm.sqlite3" title="dbm.sqlite3: SQLite backend for dbm (All)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm.sqlite3</span></code></a>: 针对 <a class="reference internal" href="../library/dbm.html#module-dbm" title="dbm: Interfaces to various Unix &quot;database&quot; formats."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm</span></code></a> 的 SQLite 后端。 （由 Raymond Hettinger 和 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/100414">gh-100414</a> 中贡献。）</p></li>
</ul>
</section>
<section id="improved-modules">
<h2>改进的模块<a class="headerlink" href="#improved-modules" title="Link to this heading">¶</a></h2>
<section id="argparse">
<h3>argparse<a class="headerlink" href="#argparse" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>为 <a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument" title="argparse.ArgumentParser.add_argument"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument()</span></code></a> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">add_parser()</span></code> 方法添加了 <em>deprecated</em> 形参，以允许弃用命令行选项、位置参数和子命令。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/83648">gh-83648</a> 中贡献。）</p></li>
</ul>
</section>
<section id="array">
<h3>array<a class="headerlink" href="#array" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <code class="docutils literal notranslate"><span class="pre">'w'</span></code> 类型码 (<code class="docutils literal notranslate"><span class="pre">Py_UCS4</span></code>) 表示 Unicode 字符。 它应被用来代替已弃用的 <code class="docutils literal notranslate"><span class="pre">'u'</span></code> 类型码。 （由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/80480">gh-80480</a> 中贡献。）</p></li>
<li><p>通过实现 <a class="reference internal" href="../library/array.html#array.array.clear" title="array.array.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clear()</span></code></a> 方法将 <a class="reference internal" href="../library/array.html#array.array" title="array.array"><code class="xref py py-class docutils literal notranslate"><span class="pre">array.array</span></code></a> 注册为 <a class="reference internal" href="../library/collections.abc.html#collections.abc.MutableSequence" title="collections.abc.MutableSequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableSequence</span></code></a>。 （由 Mike Zimin 在 <a class="reference external" href="https://github.com/python/cpython/issues/114894">gh-114894</a> 中贡献。）</p></li>
</ul>
</section>
<section id="ast">
<h3>ast<a class="headerlink" href="#ast" title="Link to this heading">¶</a></h3>
<ul>
<li><p>现在 <a class="reference internal" href="../library/ast.html#module-ast" title="ast: Abstract Syntax Tree classes and manipulation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ast</span></code></a> 模块中节点类型的构造器对其接受的参数要求更为严格，并在参数被省略时有更易理解的行为。</p>
<p>如果在构造实例时某个 AST 节点上的可选字段没有被作为参数包括在内，则该字段现在将被设为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。 类似地，如果某个列表字段被省略，则该字段现在将被设为空列表，而如果某个 <code class="xref py py-class docutils literal notranslate"><span class="pre">expr_context</span></code> 字段被省略，则它将默认为 <a class="reference internal" href="../library/ast.html#ast.Load" title="ast.Load"><code class="xref py py-class docutils literal notranslate"><span class="pre">Load()</span></code></a>。 （之前，在所有情况下，新构造的 AST 节点实例上的相应属性都将缺失。）</p>
<p>在所有其他情况下，当需要的参数被省略时，节点构造器将发出 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。 这在 Python 3.15 中将会引发异常。 类似地，将关键字参数传入一个未映射到 AST 节点上的字段的构造器的做法现在已被弃用，并且在 Python 3.15 中将会引发异常。</p>
<p>这些更改将不会应用于用户自定义的 <a class="reference internal" href="../library/ast.html#ast.AST" title="ast.AST"><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.AST</span></code></a> 子类，除非该类选择通过设置 <a class="reference internal" href="../library/ast.html#ast.AST._field_types" title="ast.AST._field_types"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AST._field_types</span></code></a> 映射的方式加入新的行为。</p>
<p>（由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/105858">gh-105858</a>, <a class="reference external" href="https://github.com/python/cpython/issues/117486">gh-117486</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/118851">gh-118851</a> 中贡献。）</p>
</li>
<li><p>现在 <a class="reference internal" href="../library/ast.html#ast.parse" title="ast.parse"><code class="xref py py-func docutils literal notranslate"><span class="pre">ast.parse()</span></code></a> 接受一个可选参数 <em>optimize</em>，它会被传递给 <a class="reference internal" href="../library/functions.html#compile" title="compile"><code class="xref py py-func docutils literal notranslate"><span class="pre">compile()</span></code></a>。 这使得获取已优化的 AST 成为可能。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/108113">gh-108113</a> 中贡献。）</p></li>
</ul>
</section>
<section id="asyncio">
<h3>asyncio<a class="headerlink" href="#asyncio" title="Link to this heading">¶</a></h3>
<ul>
<li><p>现在 <a class="reference internal" href="../library/asyncio-task.html#asyncio.as_completed" title="asyncio.as_completed"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.as_completed()</span></code></a> 将返回一个即是 <a class="reference internal" href="../glossary.html#term-asynchronous-iterator"><span class="xref std std-term">asynchronous iterator</span></a> 又是基本的产生 <a class="reference internal" href="../glossary.html#term-awaitable"><span class="xref std std-term">可等待对象</span></a>  的 <a class="reference internal" href="../glossary.html#term-iterator"><span class="xref std std-term">iterator</span></a> 的对象。 由异常迭代产生的可等待对象包括被传入的原始 Task 或 Future 对象，使得将结果与正在完成的任务相关联更为容易。 （由 Justin Arthur 在 <a class="reference external" href="https://github.com/python/cpython/issues/77714">gh-77714</a> 中贡献。）</p></li>
<li><p>现在当服务器被关闭时 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.loop.create_unix_server" title="asyncio.loop.create_unix_server"><code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.loop.create_unix_server()</span></code></a> 会自动移除 Unix 套接字。 （由 Pierre Ossman 在 <a class="reference external" href="https://github.com/python/cpython/issues/111246">gh-111246</a> 中贡献。）</p></li>
<li><p>现在当附带一个空字节串对象调用时 <a class="reference internal" href="../library/asyncio-protocol.html#asyncio.DatagramTransport.sendto" title="asyncio.DatagramTransport.sendto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DatagramTransport.sendto()</span></code></a> 将发送零长度的数据报。 现在当计算缓冲区大小时传输控制流还会将数据报标头纳入考量。 （由 Jamie Phan 在 <a class="reference external" href="https://github.com/python/cpython/issues/115199">gh-115199</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../library/asyncio-queue.html#asyncio.Queue.shutdown" title="asyncio.Queue.shutdown"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Queue.shutdown</span></code></a> 和 <a class="reference internal" href="../library/asyncio-queue.html#asyncio.QueueShutDown" title="asyncio.QueueShutDown"><code class="xref py py-exc docutils literal notranslate"><span class="pre">QueueShutDown</span></code></a> 用于管理队列终结。 （由 Laurie Opperman 和 Yves Duprat 在 <a class="reference external" href="https://github.com/python/cpython/issues/104228">gh-104228</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.Server.close_clients" title="asyncio.Server.close_clients"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Server.close_clients()</span></code></a> 和 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.Server.abort_clients" title="asyncio.Server.abort_clients"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Server.abort_clients()</span></code></a> 方法，它们会以更强制的方式关闭 asyncio 服务器。 （由 Pierre Ossman 在 <a class="reference external" href="https://github.com/python/cpython/issues/113538">gh-113538</a> 中贡献。）</p></li>
<li><p>在 <a class="reference internal" href="../library/asyncio-stream.html#asyncio.StreamReader.readuntil" title="asyncio.StreamReader.readuntil"><code class="xref py py-meth docutils literal notranslate"><span class="pre">StreamReader.readuntil()</span></code></a> 中接受一个由分隔符组成的元组，当遇到其中之一时就会停止。 （由 Bruce Merry 在 <a class="reference external" href="https://github.com/python/cpython/issues/81322">gh-81322</a> 中贡献。）</p></li>
<li><p>改进了 <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup" title="asyncio.TaskGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskGroup</span></code></a> 在外部的取消操作与内部的取消操作发生冲突时的行为。 例如，当嵌套两个任务分组并且两者同时在某个子任务中遇到异常时，外层的任务分组有可能被挂起，因为其内部的取消操作已由内层的任务分组进行处理。</p>
<p>对于任务分组在外部被取消时同时必须引发 <a class="reference internal" href="../library/exceptions.html#ExceptionGroup" title="ExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> 的情况，现在它将调用父任务的 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task.cancel" title="asyncio.Task.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancel()</span></code></a> 方法。 这样可以确保 <a class="reference internal" href="../library/asyncio-exceptions.html#asyncio.CancelledError" title="asyncio.CancelledError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">CancelledError</span></code></a> 会在下一次 <a class="reference internal" href="../reference/expressions.html#await"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">await</span></code></a> 时被引发，因此取消操作不会丢失。, so the cancellation is not lost.</p>
<p>这些更改的一个附加好处是现在任务组会保留取消操作计数 (<a class="reference internal" href="../library/asyncio-task.html#asyncio.Task.cancelling" title="asyncio.Task.cancelling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancelling()</span></code></a>)。</p>
<p>为了处理某些边界情况，现在 <a class="reference internal" href="../library/asyncio-task.html#asyncio.Task.uncancel" title="asyncio.Task.uncancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">uncancel()</span></code></a> 可以在取消操作计数达到零时重置未写入文档的 <code class="docutils literal notranslate"><span class="pre">_must_cancel</span></code> 旗标。</p>
<p>（受到由 Arthur Tacca 在 <a class="reference external" href="https://github.com/python/cpython/issues/116720">gh-116720</a> 中报告的问题的启发。）</p>
</li>
<li><p>当在一个未激活的 <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup" title="asyncio.TaskGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskGroup</span></code></a> 上调用 <a class="reference internal" href="../library/asyncio-task.html#asyncio.TaskGroup.create_task" title="asyncio.TaskGroup.create_task"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TaskGroup.create_task()</span></code></a> 时，给定的协程将被关闭 (这将防止引发有关给定的协程从未被等待的 <a class="reference internal" href="../library/exceptions.html#RuntimeWarning" title="RuntimeWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeWarning</span></code></a>)。 （由 Arthur Tacca 和 Jason Zhang 在 <a class="reference external" href="https://github.com/python/cpython/issues/115957">gh-115957</a> 中贡献。）</p></li>
</ul>
</section>
<section id="base64">
<h3>base64<a class="headerlink" href="#base64" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/base64.html#base64.z85encode" title="base64.z85encode"><code class="xref py py-func docutils literal notranslate"><span class="pre">z85encode()</span></code></a> 和 <a class="reference internal" href="../library/base64.html#base64.z85decode" title="base64.z85decode"><code class="xref py py-func docutils literal notranslate"><span class="pre">z85decode()</span></code></a> 函数用于将 <a class="reference internal" href="../library/stdtypes.html#bytes" title="bytes"><code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code></a> 编码为 <a class="reference external" href="https://rfc.zeromq.org/spec/32/">Z85 data</a> 和将 Z85 编码的数据解码为 <code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>。 （由 Matan Perelman 在 <a class="reference external" href="https://github.com/python/cpython/issues/75299">gh-75299</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="compileall">
<h3>compileall<a class="headerlink" href="#compileall" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>工作线程和进程的默认数据现在是使用 <a class="reference internal" href="../library/os.html#os.process_cpu_count" title="os.process_cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.process_cpu_count()</span></code></a> 而不是 <a class="reference internal" href="../library/os.html#os.cpu_count" title="os.cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.cpu_count()</span></code></a> 来选择的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/109649">gh-109649</a> 中贡献。）</p></li>
</ul>
</section>
<section id="concurrent-futures">
<h3>concurrent.futures<a class="headerlink" href="#concurrent-futures" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>工作线程和进程的默认数据现在是使用 <a class="reference internal" href="../library/os.html#os.process_cpu_count" title="os.process_cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.process_cpu_count()</span></code></a> 而不是 <a class="reference internal" href="../library/os.html#os.cpu_count" title="os.cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.cpu_count()</span></code></a> 来选择的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/109649">gh-109649</a> 中贡献。）</p></li>
</ul>
</section>
<section id="configparser">
<h3>configparser<a class="headerlink" href="#configparser" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/configparser.html#configparser.ConfigParser" title="configparser.ConfigParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></a> 具有对未命名节的支持，这将允许使用最高层级的键值对。 此特性可通过新增的 <em>allow_unnamed_section</em> 形参来启用。 （由 Pedro Sousa Lacerda 在 <a class="reference external" href="https://github.com/python/cpython/issues/66449">gh-66449</a> 中贡献。）</p></li>
</ul>
</section>
<section id="copy">
<h3>copy<a class="headerlink" href="#copy" title="Link to this heading">¶</a></h3>
<ul>
<li><p>新增的 <a class="reference internal" href="../library/copy.html#copy.replace" title="copy.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> 函数和 <a class="reference internal" href="../library/copy.html#object.__replace__" title="object.__replace__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">replace</span> <span class="pre">协议</span></code></a> 使得创建经修改的对象副本更为简单。 这在操作不可变对象时特别有用。 以下类型将支持 <a class="reference internal" href="../library/copy.html#copy.replace" title="copy.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">replace()</span></code></a> 函数并实现了 replace 协议：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/collections.html#collections.namedtuple" title="collections.namedtuple"><code class="xref py py-func docutils literal notranslate"><span class="pre">collections.namedtuple()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/dataclasses.html#dataclasses.dataclass" title="dataclasses.dataclass"><code class="xref py py-class docutils literal notranslate"><span class="pre">dataclasses.dataclass</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/datetime.html#datetime.datetime" title="datetime.datetime"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>, <a class="reference internal" href="../library/datetime.html#datetime.date" title="datetime.date"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a>, <a class="reference internal" href="../library/datetime.html#datetime.time" title="datetime.time"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.time</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/inspect.html#inspect.Signature" title="inspect.Signature"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.Signature</span></code></a>, <a class="reference internal" href="../library/inspect.html#inspect.Parameter" title="inspect.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">inspect.Parameter</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/types.html#types.SimpleNamespace" title="types.SimpleNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code></a></p></li>
<li><p><a class="reference internal" href="../reference/datamodel.html#code-objects"><span class="std std-ref">代码对象</span></a></p></li>
</ul>
<p>任何用户自定义类也可以通过定义 <a class="reference internal" href="../library/copy.html#object.__replace__" title="object.__replace__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__replace__()</span></code></a> 方法来支持 <a class="reference internal" href="../library/copy.html#copy.replace" title="copy.replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy.replace()</span></code></a>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/108751">gh-108751</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="ctypes">
<h3>ctypes<a class="headerlink" href="#ctypes" title="Link to this heading">¶</a></h3>
<ul>
<li><p>作为必要的内部重构的一个后果，内部元类的初始化现在将发生于 <code class="docutils literal notranslate"><span class="pre">__init__</span></code> 中而不是 <code class="docutils literal notranslate"><span class="pre">__new__</span></code> 中。 这会影响子类化这些内部元类以提供自定义初始化的项目。 一般而言：</p>
<ul class="simple">
<li><p>调用 <code class="docutils literal notranslate"><span class="pre">super().__new__</span></code> 之后在 <code class="docutils literal notranslate"><span class="pre">__new__</span></code> 中完成的自定义逻辑应当移至 <code class="docutils literal notranslate"><span class="pre">__init__</span></code>。</p></li>
<li><p>要创建一个类，需调用相应的元类，而不仅是该元类的 <code class="docutils literal notranslate"><span class="pre">__new__</span></code> 方法。</p></li>
</ul>
<p>请参阅 <a class="reference external" href="https://github.com/python/cpython/issues/124520">gh-124520</a> 了解相关讨论和对某些受影响项目的修改的链接。</p>
</li>
<li><p><a class="reference internal" href="../library/ctypes.html#ctypes.Structure" title="ctypes.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">ctypes.Structure</span></code></a> 对象新增了一个 <a class="reference internal" href="../library/ctypes.html#ctypes.Structure._align_" title="ctypes.Structure._align_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_align_</span></code></a> 属性以允许显式地指定发往内存的结构体对齐方式。 （由 Matt Sanderson 在 <a class="reference external" href="https://github.com/python/cpython/issues/112433">gh-112433</a> 中贡献。）</p></li>
</ul>
</section>
<section id="dbm">
<h3>dbm<a class="headerlink" href="#dbm" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加 <a class="reference internal" href="../library/dbm.html#module-dbm.sqlite3" title="dbm.sqlite3: SQLite backend for dbm (All)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm.sqlite3</span></code></a>，一个实现了 SQLite 后端的新模块，并将其设为默认的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">dbm</span></code> 后端。 （由 Raymond Hettinger 和 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/100414">gh-100414</a> 中贡献。）</p></li>
<li><p>允许通过新增的 <a class="reference internal" href="../library/dbm.html#dbm.gnu.gdbm.clear" title="dbm.gnu.gdbm.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdbm.clear()</span></code></a> 和 <a class="reference internal" href="../library/dbm.html#dbm.ndbm.ndbm.clear" title="dbm.ndbm.ndbm.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ndbm.clear()</span></code></a> 方法移除数据库中的所有条目。 （由 Donghee Na 在 <a class="reference external" href="https://github.com/python/cpython/issues/107122">gh-107122</a> 中贡献。）</p></li>
</ul>
</section>
<section id="dis">
<h3>dis<a class="headerlink" href="#dis" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>将 <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dis</span></code></a> 模块的函数的输出修改为显示跳转目标和异常处理器的逻辑标签，而不是偏移量。 可以使用新的 <a class="reference internal" href="../library/dis.html#cmdoption-dis-O"><code class="xref std std-option docutils literal notranslate"><span class="pre">-O</span></code></a> 命令行选项或 <em>show_offsets</em> 参数来添加偏移量。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/112137">gh-112137</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/dis.html#dis.get_instructions" title="dis.get_instructions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_instructions()</span></code></a> 不再将缓存条目表示为单独的指令。 作为替代，它会将它们作为 <a class="reference internal" href="../library/dis.html#dis.Instruction" title="dis.Instruction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instruction</span></code></a> 的组成部分返回，放在新的 <em>cache_info</em> 字段中。 传给 <a class="reference internal" href="../library/dis.html#dis.get_instructions" title="dis.get_instructions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_instructions()</span></code></a> 的 <em>show_caches</em> 参数已被弃用并且不再有任何效果。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/112962">gh-112962</a> 中贡献。）</p></li>
</ul>
</section>
<section id="doctest">
<span id="whatsnew313-doctest"></span><h3>doctest<a class="headerlink" href="#doctest" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/doctest.html#module-doctest" title="doctest: Test pieces of code within docstrings."><code class="xref py py-mod docutils literal notranslate"><span class="pre">doctest</span></code></a> 输出默认是彩色的。 此特性可通过新增的 <span class="target" id="index-156"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_COLORS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_COLORS</span></code></a> 环境变量和传统的 <a class="reference external" href="https://no-color.org/"><code class="docutils literal notranslate"><span class="pre">NO_COLOR</span></code></a> 和 <a class="reference external" href="https://force-color.org/"><code class="docutils literal notranslate"><span class="pre">FORCE_COLOR</span></code></a> 环境变量来控制。 另请参阅 <a class="reference internal" href="../using/cmdline.html#using-on-controlling-color"><span class="std std-ref">控制颜色</span></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/117225">gh-117225</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/doctest.html#doctest.DocTestRunner.run" title="doctest.DocTestRunner.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DocTestRunner.run()</span></code></a> 方法会统计已跳过测试的数量。 增加了 <a class="reference internal" href="../library/doctest.html#doctest.DocTestRunner.skips" title="doctest.DocTestRunner.skips"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DocTestRunner.skips</span></code></a> 和 <a class="reference internal" href="../library/doctest.html#doctest.TestResults.skipped" title="doctest.TestResults.skipped"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TestResults.skipped</span></code></a> 属性。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/108794">gh-108794</a> 中贡献。）</p></li>
</ul>
</section>
<section id="email">
<h3>email<a class="headerlink" href="#email" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在带有嵌入的换行符的标头在输出时会加上引号。 现在 <a class="reference internal" href="../library/email.generator.html#module-email.generator" title="email.generator: Generate flat text email messages from a message structure."><code class="xref py py-mod docutils literal notranslate"><span class="pre">generator</span></code></a> 会拒绝序列化（写入）不正确地折叠或分隔的标头，例如将被解析为多个标头或与相邻数据合并的标头等。 如果你需要禁用此安全特性，请设置 <a class="reference internal" href="../library/email.policy.html#email.policy.Policy.verify_generated_headers" title="email.policy.Policy.verify_generated_headers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">verify_generated_headers</span></code></a>。 （由 Bas Bloemsaat 和 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/121650">gh-121650</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/email.utils.html#email.utils.getaddresses" title="email.utils.getaddresses"><code class="xref py py-func docutils literal notranslate"><span class="pre">getaddresses()</span></code></a> 和 <a class="reference internal" href="../library/email.utils.html#email.utils.parseaddr" title="email.utils.parseaddr"><code class="xref py py-func docutils literal notranslate"><span class="pre">parseaddr()</span></code></a> 会在更多遇到无效 email 地址的情况下返回 <code class="docutils literal notranslate"><span class="pre">('',</span> <span class="pre">'')</span></code> 对非可能不准确的值。 这两个函数新增了可选的 <em>strict</em> 形参 (默认为 <code class="docutils literal notranslate"><span class="pre">True</span></code>)。 要获取旧版本的行为 (接受错误格式的输入)，请使用 <code class="docutils literal notranslate"><span class="pre">strict=False</span></code>。 <code class="docutils literal notranslate"><span class="pre">getattr(email.utils,</span> <span class="pre">'supports_strict_parsing',</span> <span class="pre">False)</span></code> 可被用于检查 <em>strict</em> 形参是否可用。 （由 Thomas Dwyer 和 Victor Stinner 针对 <a class="reference external" href="https://github.com/python/cpython/issues/102988">gh-102988</a> 贡献以改进 <span class="target" id="index-157"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2023-27043"><strong>CVE 2023-27043</strong></a> 修正。）</p></li>
</ul>
</section>
<section id="enum">
<h3>enum<a class="headerlink" href="#enum" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/enum.html#enum.EnumDict" title="enum.EnumDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumDict</span></code></a> 被改为公有以更好的支持子类化 <a class="reference internal" href="../library/enum.html#enum.EnumType" title="enum.EnumType"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnumType</span></code></a>。</p></li>
</ul>
</section>
<section id="fractions">
<h3>fractions<a class="headerlink" href="#fractions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/fractions.html#fractions.Fraction" title="fractions.Fraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Fraction</span></code></a> 对象支持用于填充、对齐、正负号处理、最小宽度和分组的标准 <a class="reference internal" href="../library/string.html#formatspec"><span class="std std-ref">格式说明迷你语言</span></a> 规则。 （由 Mark Dickinson 在 <a class="reference external" href="https://github.com/python/cpython/issues/111320">gh-111320</a> 中贡献。）</p></li>
</ul>
</section>
<section id="glob">
<h3>glob<a class="headerlink" href="#glob" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/glob.html#glob.translate" title="glob.translate"><code class="xref py py-func docutils literal notranslate"><span class="pre">translate()</span></code></a>，这是个用来将具有 shell 风格通配符的路径说明转换为正则表达式的函数。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/72904">gh-72904</a> 中贡献。）</p></li>
</ul>
</section>
<section id="importlib">
<h3>importlib<a class="headerlink" href="#importlib" title="Link to this heading">¶</a></h3>
<ul>
<li><p>现在 <a class="reference internal" href="../library/importlib.resources.html#module-importlib.resources" title="importlib.resources: Package resource reading, opening, and access"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.resources</span></code></a> 中的下列函数允许访问资源目录（或树），并使用多个位置参数（现在文本读取函数中的 <em>encoding</em> 和 <em>errors</em> 参数是仅限关键字参数）：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.is_resource" title="importlib.resources.is_resource"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_resource()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.open_binary" title="importlib.resources.open_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_binary()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.open_text" title="importlib.resources.open_text"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_text()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.path" title="importlib.resources.path"><code class="xref py py-func docutils literal notranslate"><span class="pre">path()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.read_binary" title="importlib.resources.read_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_binary()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.read_text" title="importlib.resources.read_text"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_text()</span></code></a></p></li>
</ul>
<p>这些函数将不再被弃用也不会被加入移除计划。 （由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/116608">gh-116608</a> 中贡献。）</p>
</li>
<li><p><a class="reference internal" href="../library/importlib.resources.html#importlib.resources.contents" title="importlib.resources.contents"><code class="xref py py-func docutils literal notranslate"><span class="pre">contents()</span></code></a> 仍然被弃用而应改用功能完整的 <a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.Traversable" title="importlib.resources.abc.Traversable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Traversable</span></code></a> API。 不过，目前还没有移除它的计划。 （由 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/116608">gh-116608</a> 中贡献。）</p></li>
</ul>
</section>
<section id="io">
<h3>io<a class="headerlink" href="#io" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/io.html#io.IOBase" title="io.IOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOBase</span></code></a> 最终化器会使用 <a class="reference internal" href="../library/sys.html#sys.unraisablehook" title="sys.unraisablehook"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.unraisablehook</span></code></a> 来将由 <a class="reference internal" href="../library/io.html#io.IOBase.close" title="io.IOBase.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> 方法引发的错误写入日志。 在之前版本中，错误在默认情况下会被静默地忽略，而只有在 <a class="reference internal" href="../library/devmode.html#devmode"><span class="std std-ref">Python 开发模式</span></a> 或在使用 <a class="reference internal" href="../using/configure.html#debug-build"><span class="std std-ref">Python 调试构建版</span></a> 时才会被写入日志。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/62948">gh-62948</a> 中贡献。）</p></li>
</ul>
</section>
<section id="ipaddress">
<h3>ipaddress<a class="headerlink" href="#ipaddress" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv4Address.ipv6_mapped" title="ipaddress.IPv4Address.ipv6_mapped"><code class="xref py py-attr docutils literal notranslate"><span class="pre">IPv4Address.ipv6_mapped</span></code></a> 特征属性，它将返回映射 IPv4 的 IPv6 地址。 （由 Charles Machalow 在 <a class="reference external" href="https://github.com/python/cpython/issues/109466">gh-109466</a> 中贡献。）</p></li>
<li><p>修正了 <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv4Address" title="ipaddress.IPv4Address"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4Address</span></code></a>, <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv6Address" title="ipaddress.IPv6Address"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6Address</span></code></a>, <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv4Network" title="ipaddress.IPv4Network"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv4Network</span></code></a> 和 <a class="reference internal" href="../library/ipaddress.html#ipaddress.IPv6Network" title="ipaddress.IPv6Network"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPv6Network</span></code></a> 中 <code class="docutils literal notranslate"><span class="pre">is_global</span></code> 和 <code class="docutils literal notranslate"><span class="pre">is_private</span></code> 的行为。 （由 Jakub Stasiak 在 <a class="reference external" href="https://github.com/python/cpython/issues/113171">gh-113171</a> 中贡献。）</p></li>
</ul>
</section>
<section id="itertools">
<h3>itertools<a class="headerlink" href="#itertools" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../library/itertools.html#itertools.batched" title="itertools.batched"><code class="xref py py-func docutils literal notranslate"><span class="pre">batched()</span></code></a> 新增了 <em>strict</em> 形参，它会在最后一批次数据小于指定批准大小时引发 <a class="reference internal" href="../library/exceptions.html#ValueError" title="ValueError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>。 （由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/113202">gh-113202</a> 中贡献。）</p></li>
</ul>
</section>
<section id="marshal">
<h3>marshal<a class="headerlink" href="#marshal" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>在模块函数中增加了 <em>allow_code</em> 形参。 传入 <code class="docutils literal notranslate"><span class="pre">allow_code=False</span></code> 将防止在 Python 各版本间不兼容的代码对象的序列化和反序列化。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/113626">gh-113626</a> 中贡献。）</p></li>
</ul>
</section>
<section id="math">
<h3>math<a class="headerlink" href="#math" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>新增函数 <a class="reference internal" href="../library/math.html#math.fma" title="math.fma"><code class="xref py py-func docutils literal notranslate"><span class="pre">fma()</span></code></a> 可执行合并的乘法-加法运算。 此函数只需一轮操作即可计算 <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span> <span class="pre">+</span> <span class="pre">z</span></code>，从而避免了任何中间步骤导致的精度损失。 它包装了 C99 所提供的 <code class="docutils literal notranslate"><span class="pre">fma()</span></code> 函数，并且遵从针对特殊情况的 IEEE 754 &quot;fusedMultiplyAdd&quot; 运算规范。 （由 Mark Dickinson 和 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/73468">gh-73468</a> 中贡献。）</p></li>
</ul>
</section>
<section id="mimetypes">
<h3>mimetypes<a class="headerlink" href="#mimetypes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/mimetypes.html#mimetypes.guess_file_type" title="mimetypes.guess_file_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_file_type()</span></code></a> 函数用于根据文件系统路径来猜测 MIME 类型。 在 <a class="reference internal" href="../library/mimetypes.html#mimetypes.guess_type" title="mimetypes.guess_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_type()</span></code></a> 中使用路径的做法现在已是 <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/66543">gh-66543</a> 中贡献。）</p></li>
</ul>
</section>
<section id="mmap">
<h3>mmap<a class="headerlink" href="#mmap" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/mmap.html#mmap.mmap" title="mmap.mmap"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmap</span></code></a> 在 Windows 上当被映射的内存由于文件系统错误或访问限制而不可访问时将获得保护以避免崩溃。 （由 Jannis Weigend 在 <a class="reference external" href="https://github.com/python/cpython/issues/118209">gh-118209</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/mmap.html#mmap.mmap" title="mmap.mmap"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmap</span></code></a> 具有新的 <a class="reference internal" href="../library/mmap.html#mmap.mmap.seekable" title="mmap.mmap.seekable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">seekable()</span></code></a> 方法将在需要可定位的文件型对象时被使用。 现在 <a class="reference internal" href="../library/mmap.html#mmap.mmap.seek" title="mmap.mmap.seek"><code class="xref py py-meth docutils literal notranslate"><span class="pre">seek()</span></code></a> 方法将返回一个新的绝对位置。 （由 Donghee Na 和 Sylvie Liberman 在 <a class="reference external" href="https://github.com/python/cpython/issues/111835">gh-111835</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/mmap.html#mmap.mmap" title="mmap.mmap"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmap</span></code></a> 新增了 UNIX 专属的 <em>trackfd</em> 形参用来控制文件描述符的复制；如为假值，则由 <em>fileno</em> 指定的文件描述符将不会被复制。 （由 Zackery Spytz 和 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/78502">gh-78502</a> 中贡献。）</p></li>
</ul>
</section>
<section id="multiprocessing">
<h3>multiprocessing<a class="headerlink" href="#multiprocessing" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>工作线程和进程的默认数据现在是使用 <a class="reference internal" href="../library/os.html#os.process_cpu_count" title="os.process_cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.process_cpu_count()</span></code></a> 而不是 <a class="reference internal" href="../library/os.html#os.cpu_count" title="os.cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.cpu_count()</span></code></a> 来选择的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/109649">gh-109649</a> 中贡献。）</p></li>
</ul>
</section>
<section id="os">
<h3>os<a class="headerlink" href="#os" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/os.html#os.process_cpu_count" title="os.process_cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">process_cpu_count()</span></code></a> 函数用于获取当前进程的调用方线程可以使用的逻辑 CPU 核心数量。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/109649">gh-109649</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/os.html#os.cpu_count" title="os.cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">cpu_count()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.process_cpu_count" title="os.process_cpu_count"><code class="xref py py-func docutils literal notranslate"><span class="pre">process_cpu_count()</span></code></a> 可通过新的环境变量 <span class="target" id="index-158"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHON_CPU_COUNT"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHON_CPU_COUNT</span></code></a> 或新的命令行选项 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">cpu_count</span></code></a> 来覆盖。 此选项对于需要在不修改应用程序代码或容器本身的情况下限制一个容器系统的 CPU 资源的用户会很有用处。 （由 Donghee Na 在 <a class="reference external" href="https://github.com/python/cpython/issues/109595">gh-109595</a> 中贡献。）</p></li>
<li><p>通过 <a class="reference internal" href="../library/os.html#os.timerfd_create" title="os.timerfd_create"><code class="xref py py-func docutils literal notranslate"><span class="pre">timerfd_create()</span></code></a>, <a class="reference internal" href="../library/os.html#os.timerfd_settime" title="os.timerfd_settime"><code class="xref py py-func docutils literal notranslate"><span class="pre">timerfd_settime()</span></code></a>, <a class="reference internal" href="../library/os.html#os.timerfd_settime_ns" title="os.timerfd_settime_ns"><code class="xref py py-func docutils literal notranslate"><span class="pre">timerfd_settime_ns()</span></code></a>, <a class="reference internal" href="../library/os.html#os.timerfd_gettime" title="os.timerfd_gettime"><code class="xref py py-func docutils literal notranslate"><span class="pre">timerfd_gettime()</span></code></a>, <a class="reference internal" href="../library/os.html#os.timerfd_gettime_ns" title="os.timerfd_gettime_ns"><code class="xref py py-func docutils literal notranslate"><span class="pre">timerfd_gettime_ns()</span></code></a>, <a class="reference internal" href="../library/os.html#os.TFD_NONBLOCK" title="os.TFD_NONBLOCK"><code class="xref py py-const docutils literal notranslate"><span class="pre">TFD_NONBLOCK</span></code></a>, <a class="reference internal" href="../library/os.html#os.TFD_CLOEXEC" title="os.TFD_CLOEXEC"><code class="xref py py-const docutils literal notranslate"><span class="pre">TFD_CLOEXEC</span></code></a>, <a class="reference internal" href="../library/os.html#os.TFD_TIMER_ABSTIME" title="os.TFD_TIMER_ABSTIME"><code class="xref py py-const docutils literal notranslate"><span class="pre">TFD_TIMER_ABSTIME</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.TFD_TIMER_CANCEL_ON_SET" title="os.TFD_TIMER_CANCEL_ON_SET"><code class="xref py py-const docutils literal notranslate"><span class="pre">TFD_TIMER_CANCEL_ON_SET</span></code></a> 增加了针对 Linux 的 <em class="manpage"><a class="manpage reference external" href="https://manpages.debian.org/timerfd_create(2)">计算器文件描述符</a></em> 的 <a class="reference internal" href="../library/os.html#os-timerfd"><span class="std std-ref">低层级接口</span></a>。 （由 Masaru Tsuchiyama 在 <a class="reference external" href="https://github.com/python/cpython/issues/108277">gh-108277</a> 中贡献。）</p></li>
<li><p>在 Windows 上现在同时增加了对 <a class="reference internal" href="../library/os.html#os.lchmod" title="os.lchmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">lchmod()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.chmod" title="os.chmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">chmod()</span></code></a> 的 <em>follow_symlinks</em> 参数的支持。 请注意在 Windows 上 <code class="xref py py-func docutils literal notranslate"><span class="pre">lchmod()</span></code> 中的 <em>follow_symlinks</em> 的默认值为 <code class="docutils literal notranslate"><span class="pre">False</span></code>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/59616">gh-59616</a> 中贡献。）</p></li>
<li><p>在 Windows 上现在同时增加了 <a class="reference internal" href="../library/os.html#os.fchmod" title="os.fchmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">fchmod()</span></code></a> 和对 <a class="reference internal" href="../library/os.html#os.chmod" title="os.chmod"><code class="xref py py-func docutils literal notranslate"><span class="pre">chmod()</span></code></a> 中的文件描述符的支持。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/113191">gh-113191</a> 中贡献。）</p></li>
<li><p>在 Windows 上，<a class="reference internal" href="../library/os.html#os.mkdir" title="os.mkdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">mkdir()</span></code></a> 和 <a class="reference internal" href="../library/os.html#os.makedirs" title="os.makedirs"><code class="xref py py-func docutils literal notranslate"><span class="pre">makedirs()</span></code></a> 现在支持传入 <em>mode</em> 值 <code class="docutils literal notranslate"><span class="pre">0o700</span></code> 以对新目录应用访问控制。 这会隐式地影响 <a class="reference internal" href="../library/tempfile.html#tempfile.mkdtemp" title="tempfile.mkdtemp"><code class="xref py py-func docutils literal notranslate"><span class="pre">tempfile.mkdtemp()</span></code></a> 并可缓解 <span class="target" id="index-159"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2024-4030"><strong>CVE 2024-4030</strong></a>。 其他的 <em>mode</em> 值仍然会被忽略。 （由 Steve Dower 在 <a class="reference external" href="https://github.com/python/cpython/issues/118486">gh-118486</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a> 可接受 <code class="docutils literal notranslate"><span class="pre">None</span></code> 作为 <em>env</em> 参数，这将让新产生的进程使用当前进程的环境。 （由 Jakub Kulik 在 <a class="reference external" href="https://github.com/python/cpython/issues/113119">gh-113119</a> 中贡献。）.)</p></li>
<li><p>在支持 <code class="xref c c-func docutils literal notranslate"><span class="pre">posix_spawn_file_actions_addclosefrom_np()</span></code> 的平台上 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a> 现在可以在 <em>file_actions</em> 形参中使用 <a class="reference internal" href="../library/os.html#os.POSIX_SPAWN_CLOSEFROM" title="os.POSIX_SPAWN_CLOSEFROM"><code class="xref py py-attr docutils literal notranslate"><span class="pre">POSIX_SPAWN_CLOSEFROM</span></code></a> 属性。 （由 Jakub Kulik 在 <a class="reference external" href="https://github.com/python/cpython/issues/113117">gh-113117</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="os-path">
<h3>os.path<a class="headerlink" href="#os-path" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/os.path.html#os.path.isreserved" title="os.path.isreserved"><code class="xref py py-func docutils literal notranslate"><span class="pre">isreserved()</span></code></a> 用于检查一个路径在当前系统中是否为保留路径。 此函数仅在 Windows 上可用。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/88569">gh-88569</a> 中贡献。）</p></li>
<li><p>在 Windows 上，<a class="reference internal" href="../library/os.path.html#os.path.isabs" title="os.path.isabs"><code class="xref py py-func docutils literal notranslate"><span class="pre">isabs()</span></code></a> 将不再把以恰好一个斜杠 (<code class="docutils literal notranslate"><span class="pre">\</span></code> 或 <code class="docutils literal notranslate"><span class="pre">/</span></code>) 开头的路径视为绝对路径。 （由 Barney Gale 和 Jon Foster 在 <a class="reference external" href="https://github.com/python/cpython/issues/44626">gh-44626</a> 中贡献。）</p></li>
<li><p>现在即使文件不可访问 <a class="reference internal" href="../library/os.path.html#os.path.realpath" title="os.path.realpath"><code class="xref py py-func docutils literal notranslate"><span class="pre">realpath()</span></code></a> 也能够解析 MS-DOS 风格的文件名。 （由 Moonsik Park 在 <a class="reference external" href="https://github.com/python/cpython/issues/82367">gh-82367</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pathlib">
<h3>pathlib<a class="headerlink" href="#pathlib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/pathlib.html#pathlib.UnsupportedOperation" title="pathlib.UnsupportedOperation"><code class="xref py py-exc docutils literal notranslate"><span class="pre">UnsupportedOperation</span></code></a>，它会在一个路径操作不受支持时代替 <a class="reference internal" href="../library/exceptions.html#NotImplementedError" title="NotImplementedError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> 被引发。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/89812">gh-89812</a> 中贡献。）</p></li>
<li><p>新增了一个用于根据 'file' URI (<code class="docutils literal notranslate"><span class="pre">file:///</span></code>) 来创建 <a class="reference internal" href="../library/pathlib.html#pathlib.Path" title="pathlib.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> 对象的构造器 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.from_uri" title="pathlib.Path.from_uri"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.from_uri()</span></code></a>。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/107465">gh-107465</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.full_match" title="pathlib.PurePath.full_match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurePath.full_match()</span></code></a> 用于匹配带有 shell 风格通配符的路径，包括递归通配符 &quot;<code class="docutils literal notranslate"><span class="pre">**</span></code>&quot;。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/73435">gh-73435</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.parser" title="pathlib.PurePath.parser"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PurePath.parser</span></code></a> 类属性以存储用于低层级路径解析与合并的 <a class="reference internal" href="../library/os.path.html#module-os.path" title="os.path: Operations on pathnames."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os.path</span></code></a> 实现。 这可以是 <code class="xref py py-mod docutils literal notranslate"><span class="pre">posixpath</span></code> 或 <code class="xref py py-mod docutils literal notranslate"><span class="pre">ntpath</span></code>。</p></li>
<li><p>为 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.glob" title="pathlib.Path.glob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.glob()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.rglob" title="pathlib.Path.rglob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rglob()</span></code></a> 增加了 <em>recurse_symlinks</em> 仅限关键字参数。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/77609">gh-77609</a> 中贡献。）</p></li>
<li><p>现在当给出以 &quot;<code class="docutils literal notranslate"><span class="pre">**</span></code>&quot; 结束的模式时 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.glob" title="pathlib.Path.glob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.glob()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.rglob" title="pathlib.Path.rglob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rglob()</span></code></a> 将返回文件和目录。 在之前版本中，仅会返回目录。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/70303">gh-70303</a> 中贡献。）.)</p></li>
<li><p>为 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.is_file" title="pathlib.Path.is_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.is_file</span></code></a>, <a class="reference internal" href="../library/pathlib.html#pathlib.Path.is_dir" title="pathlib.Path.is_dir"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.is_dir</span></code></a>, <a class="reference internal" href="../library/pathlib.html#pathlib.Path.owner" title="pathlib.Path.owner"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.owner()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.group" title="pathlib.Path.group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.group()</span></code></a> 增加了 <em>follow_symlinks</em> 仅限关键字参数。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/105793">gh-105793</a> 中，以及 Kamil Turek 在 <a class="reference external" href="https://github.com/python/cpython/issues/107962">gh-107962</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pdb">
<h3>pdb<a class="headerlink" href="#pdb" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/functions.html#breakpoint" title="breakpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code></a> 和 <a class="reference internal" href="../library/pdb.html#pdb.set_trace" title="pdb.set_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_trace()</span></code></a> 会立即进入调试器而不是在被执行代码的下一行进入。 这一更改可防止当 <code class="xref py py-func docutils literal notranslate"><span class="pre">breakpoint()</span></code> 位于上下文末尾 时调试器在上下文以外被中断。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/118579">gh-118579</a> 中贡献。）</p></li>
<li><p>当设置了 <a class="reference internal" href="../library/sys.html#sys.flags.safe_path" title="sys.flags.safe_path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sys.flags.safe_path</span></code></a> 时 <code class="docutils literal notranslate"><span class="pre">sys.path[0]</span></code> 将不会再被替换为被调试脚本的目录。 （由 Tian Gao 和 Christian Walther 在 <a class="reference external" href="https://github.com/python/cpython/issues/111762">gh-111762</a> 中贡献。）</p></li>
<li><p>现在支持将 <a class="reference internal" href="../library/zipapp.html#module-zipapp" title="zipapp: Manage executable Python zip archives"><code class="xref py py-mod docutils literal notranslate"><span class="pre">zipapp</span></code></a> 作为调试目标。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/118501">gh-118501</a> 中贡献。）</p></li>
<li><p>添加了在 <a class="reference internal" href="../library/pdb.html#pdb.pm" title="pdb.pm"><code class="xref py py-func docutils literal notranslate"><span class="pre">pm()</span></code></a> 中进行事后调试期间使用 Pdb 新增的 <a class="reference internal" href="../library/pdb.html#pdbcommand-exceptions"><code class="xref std std-pdbcmd docutils literal notranslate"><span class="pre">exceptions</span> <span class="pre">[exc_number]</span></code></a> 命令在串连的异常之间移动的能力。 （由 Matthias Bussonnier 在 <a class="reference external" href="https://github.com/python/cpython/issues/106676">gh-106676</a> 中贡献。）</p></li>
<li><p>以一条 pdb 命令打头的表达式和语句现在会被正确地标识并执行。 （由 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/108464">gh-108464</a> 中贡献。）</p></li>
</ul>
</section>
<section id="queue">
<h3>queue<a class="headerlink" href="#queue" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/queue.html#queue.Queue.shutdown" title="queue.Queue.shutdown"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Queue.shutdown</span></code></a> 和 <a class="reference internal" href="../library/queue.html#queue.ShutDown" title="queue.ShutDown"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ShutDown</span></code></a> 用于管理队列的终结。 （由 Laurie Opperman 和 Yves Duprat 在 <a class="reference external" href="https://github.com/python/cpython/issues/104750">gh-104750</a> 中贡献。）</p></li>
</ul>
</section>
<section id="random">
<h3>random<a class="headerlink" href="#random" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了一个 <a class="reference internal" href="../library/random.html#random-cli"><span class="std std-ref">命令行接口</span></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/118131">gh-118131</a> 中贡献。）</p></li>
</ul>
</section>
<section id="re">
<h3>re<a class="headerlink" href="#re" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>将 <code class="xref py py-exc docutils literal notranslate"><span class="pre">re.error</span></code> 重命名为 <a class="reference internal" href="../library/re.html#re.PatternError" title="re.PatternError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">PatternError</span></code></a> 以改善准确性。 <code class="xref py py-exc docutils literal notranslate"><span class="pre">re.error</span></code> 仍被保留用于向下兼容。</p></li>
</ul>
</section>
<section id="shutil">
<h3>shutil<a class="headerlink" href="#shutil" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>在 <a class="reference internal" href="../library/shutil.html#shutil.chown" title="shutil.chown"><code class="xref py py-func docutils literal notranslate"><span class="pre">chown()</span></code></a> 中增加了对 <em>dir_fd</em> 和 <em>follow_symlinks</em> 关键字参数的支持。 （由 Berker Peksag 和 Tahia K 在 <a class="reference external" href="https://github.com/python/cpython/issues/62308">gh-62308</a> 中贡献。）</p></li>
</ul>
</section>
<section id="site">
<h3>site<a class="headerlink" href="#site" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <code class="file docutils literal notranslate"><span class="pre">.pth</span></code> 文件将先使用 UTF-8 来解码，如果 UTF-8 解码失败再使用 <a class="reference internal" href="../glossary.html#term-locale-encoding"><span class="xref std std-term">locale encoding</span></a>。 （由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/117802">gh-117802</a> 中贡献。）</p></li>
</ul>
</section>
<section id="sqlite3">
<h3>sqlite3<a class="headerlink" href="#sqlite3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在当一个 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> 对象未被显式地 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.close" title="sqlite3.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">关闭</span></code></a> 时将发出 <a class="reference internal" href="../library/exceptions.html#ResourceWarning" title="ResourceWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ResourceWarning</span></code></a>。 （由 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/105539">gh-105539</a> 中贡献。）</p></li>
<li><p>为 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.iterdump" title="sqlite3.Connection.iterdump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.iterdump()</span></code></a> 增加了 <em>filter</em> 仅限关键字形参用于过滤要转储的数据库对象。 （由 Mariusz Felisiak 在 <a class="reference external" href="https://github.com/python/cpython/issues/91602">gh-91602</a> 中贡献。）</p></li>
</ul>
</section>
<section id="ssl">
<h3>ssl<a class="headerlink" href="#ssl" title="Link to this heading">¶</a></h3>
<ul>
<li><p>现在 <a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_default_context()</span></code></a> API 将在其默认旗标中包括 <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_PARTIAL_CHAIN" title="ssl.VERIFY_X509_PARTIAL_CHAIN"><code class="xref py py-data docutils literal notranslate"><span class="pre">VERIFY_X509_PARTIAL_CHAIN</span></code></a> 和 <a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_STRICT" title="ssl.VERIFY_X509_STRICT"><code class="xref py py-data docutils literal notranslate"><span class="pre">VERIFY_X509_STRICT</span></code></a>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><a class="reference internal" href="../library/ssl.html#ssl.VERIFY_X509_STRICT" title="ssl.VERIFY_X509_STRICT"><code class="xref py py-data docutils literal notranslate"><span class="pre">VERIFY_X509_STRICT</span></code></a> 可能会拒绝下层 OpenSSL 实现本来会接受的 <span class="target" id="index-160"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5280.html"><strong>RFC 5280</strong></a> 以前的证书或格式错误的证书。 虽然不建议禁用此功能，但你可以使用以下方式禁用它：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">verify_flags</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">ssl</span><span class="o">.</span><span class="n">VERIFY_X509_STRICT</span>
</pre></div>
</div>
</div>
<p>（由 William Woodruff 在 <a class="reference external" href="https://github.com/python/cpython/issues/112389">gh-112389</a> 贡献。）</p>
</li>
</ul>
</section>
<section id="statistics">
<h3>statistics<a class="headerlink" href="#statistics" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了用于核密度估计的 <a class="reference internal" href="../library/statistics.html#statistics.kde" title="statistics.kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">kde()</span></code></a>。 这使得根据固定数量的离散样本估计连续概率密度函数成为可能。 （由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/115863">gh-115863</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../library/statistics.html#statistics.kde_random" title="statistics.kde_random"><code class="xref py py-func docutils literal notranslate"><span class="pre">kde_random()</span></code></a> 用来从 <a class="reference internal" href="../library/statistics.html#statistics.kde" title="statistics.kde"><code class="xref py py-func docutils literal notranslate"><span class="pre">kde()</span></code></a> 创建的估计概率密度函数进行取样。 （由 Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/115863">gh-115863</a> 中贡献。）</p></li>
</ul>
</section>
<section id="subprocess">
<span id="whatsnew313-subprocess"></span><h3>subprocess<a class="headerlink" href="#subprocess" title="Link to this heading">¶</a></h3>
<ul>
<li><p>现在 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 模块会在更多场合下使用 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a> 函数。</p>
<p>需要注意的是，当 <em>close_fds</em> 为 <code class="docutils literal notranslate"><span class="pre">True</span></code> 时（默认值），则将在 C 库提供了 <code class="xref c c-func docutils literal notranslate"><span class="pre">posix_spawn_file_actions_addclosefrom_np()</span></code> 时使用 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a>，这包括近期的 Linux, FreeBSD 和 Solaris 版本。 在 Linux，其性能应当与现有的 Linux <code class="xref c c-func docutils literal notranslate"><span class="pre">vfork()</span></code> 基础代码类似。</p>
<p>如果你需要强制 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 绝不使用 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a> 可以将私有的控制节点 <code class="xref py py-attr docutils literal notranslate"><span class="pre">subprocess._USE_POSIX_SPAWN</span></code> 设为 <code class="docutils literal notranslate"><span class="pre">False</span></code>。 如果你这样设置的话请在 <a class="reference internal" href="../bugs.html#using-the-tracker"><span class="std std-ref">issue tracker</span></a> 中报告你的理由和平台相关的细节以便我们能够为大家改进 API 的选择逻辑。 （由 Jakub Kulik 在 <a class="reference external" href="https://github.com/python/cpython/issues/113117">gh-113117</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="sys">
<h3>sys<a class="headerlink" href="#sys" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/sys.html#sys._is_interned" title="sys._is_interned"><code class="xref py py-func docutils literal notranslate"><span class="pre">_is_interned()</span></code></a> 函数用于检测字符串是否被内部化。 此函数不保证在所有的 Python 实现中均存在。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/78573">gh-78573</a> 中贡献。）</p></li>
</ul>
</section>
<section id="tempfile">
<h3>tempfile<a class="headerlink" href="#tempfile" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>在 Windows 上，<a class="reference internal" href="../library/tempfile.html#tempfile.mkdtemp" title="tempfile.mkdtemp"><code class="xref py py-func docutils literal notranslate"><span class="pre">tempfile.mkdtemp()</span></code></a> 所使用的默认模式 <code class="docutils literal notranslate"><span class="pre">0o700</span></code> 由于 <a class="reference internal" href="../library/os.html#os.mkdir" title="os.mkdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.mkdir()</span></code></a> 的更改现在将限制对新目录的访问。 这是对 <span class="target" id="index-161"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2024-4030"><strong>CVE 2024-4030</strong></a> 的缓解措施。 （由 Steve Dower 在 <a class="reference external" href="https://github.com/python/cpython/issues/118486">gh-118486</a> 中贡献。）</p></li>
</ul>
</section>
<section id="time">
<h3>time<a class="headerlink" href="#time" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>在 Windows 上，<a class="reference internal" href="../library/time.html#time.monotonic" title="time.monotonic"><code class="xref py py-func docutils literal notranslate"><span class="pre">monotonic()</span></code></a> 现在将使用精度为 1 微秒的 <code class="docutils literal notranslate"><span class="pre">QueryPerformanceCounter()</span></code> 时钟，而不是精度只有 15.6 毫秒的 <code class="docutils literal notranslate"><span class="pre">GetTickCount64()</span></code> 时钟。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/88494">gh-88494</a> 中贡献。）</p></li>
<li><p>在 Windows 上，<a class="reference internal" href="../library/time.html#time.time" title="time.time"><code class="xref py py-func docutils literal notranslate"><span class="pre">time()</span></code></a> 现在将使用精度为 1 微秒的 <code class="docutils literal notranslate"><span class="pre">GetSystemTimePreciseAsFileTime()</span></code> 时钟，代替精度为 15.6 毫秒的 <code class="docutils literal notranslate"><span class="pre">GetSystemTimeAsFileTime()</span></code> 时钟。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/63207">gh-63207</a> 中贡献。）</p></li>
</ul>
</section>
<section id="tkinter">
<h3>tkinter<a class="headerlink" href="#tkinter" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了 <a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a> 控件方法: <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_hold()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_configure()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_cget()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_forget()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_current()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">tk_busy_status()</span></code>。 （由 Miguel, klappnase 和 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/72684">gh-72684</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/tkinter.html#module-tkinter" title="tkinter: Interface to Tcl/Tk for graphical user interfaces"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter</span></code></a> 控件 <code class="xref py py-meth docutils literal notranslate"><span class="pre">wm_attributes()</span></code> 接受不带负号前缀的属性名称来获取窗口属性，例如 <code class="docutils literal notranslate"><span class="pre">w.wm_attributes('alpha')</span></code> 并允许指定属性和值以关键字参数形式来设置，例如 <code class="docutils literal notranslate"><span class="pre">w.wm_attributes(alpha=0.5)</span></code>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/43457">gh-43457</a> 中贡献。）</p></li>
<li><p>通过使用新的可选关键字形参 <em>return_python_dict</em>，现在 <code class="xref py py-meth docutils literal notranslate"><span class="pre">wm_attributes()</span></code> 可将属性作为 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 返回。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/43457">gh-43457</a> 中贡献。）</p></li>
<li><p>现在当使用新的可选仅限关键字形参 <em>return_ints</em> 时 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Text.count()</span></code> 可以返回一个简单的 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>。 在其他情况下，将以 1 个元素的元组形式返回单个计数值或者 <code class="docutils literal notranslate"><span class="pre">None</span></code>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/97928">gh-97928</a> 中贡献。）</p></li>
<li><p>在 <a class="reference internal" href="../library/tkinter.ttk.html#tkinter.ttk.Style" title="tkinter.ttk.Style"><code class="xref py py-class docutils literal notranslate"><span class="pre">tkinter.ttk.Style</span></code></a> 的 <a class="reference internal" href="../library/tkinter.ttk.html#tkinter.ttk.Style.element_create" title="tkinter.ttk.Style.element_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">element_create()</span></code></a> 方法中增加了对 &quot;vsapi&quot; 元素类型的支持。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/68166">gh-68166</a> 中贡献。）</p></li>
<li><p>为 Tkinter 的控件增加了 <code class="xref py py-meth docutils literal notranslate"><span class="pre">after_info()</span></code> 方法。 （由 Cheryl Sabella 在 <a class="reference external" href="https://github.com/python/cpython/issues/77020">gh-77020</a> 中贡献。）</p></li>
<li><p>为 <code class="xref py py-class docutils literal notranslate"><span class="pre">PhotoImage</span></code> 新增 <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_replace()</span></code> 方法用于将一个图像的某个区域拷贝到另一个图像，可能带有像素缩放、子采样，或两者皆有。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/118225">gh-118225</a> 中贡献。）</p></li>
<li><p>为 <code class="xref py py-class docutils literal notranslate"><span class="pre">PhotoImage</span></code> 的方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">zoom()</span></code> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">subsample()</span></code> 增加了 <em>from_coords</em> 形参。 为 <code class="xref py py-class docutils literal notranslate"><span class="pre">PhotoImage</span></code> 的方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code> 增加了 <em>zoom</em> 和 <em>subsample</em> 形参。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/118225">gh-118225</a> 中贡献。）</p></li>
<li><p>增加了 <code class="xref py py-class docutils literal notranslate"><span class="pre">PhotoImage</span></code> 方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> 用于从文件读取图像以及 <code class="xref py py-meth docutils literal notranslate"><span class="pre">data()</span></code> 用于获取图像数据。 为 <code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code> 方法增加了 <em>background</em> 和 <em>grayscale</em> 形参。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/118271">gh-118271</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="traceback">
<h3>回溯<a class="headerlink" href="#traceback" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>为 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException" title="traceback.TracebackException"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracebackException</span></code></a> 增加了 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.exc_type_str" title="traceback.TracebackException.exc_type_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exc_type_str</span></code></a> 属性，它用于保存 <em>exc_type</em> 字符串表示。 弃用了 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.exc_type" title="traceback.TracebackException.exc_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">exc_type</span></code></a> 属性，它用于保存类型对象本身。 增加了 <em>save_exc_type</em> 形参 (默认值为 <code class="docutils literal notranslate"><span class="pre">True</span></code>) 用于指明 <code class="docutils literal notranslate"><span class="pre">exc_type</span></code> 是否应当被保存。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/112332">gh-112332</a> 中贡献。）</p></li>
<li><p>为 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.format_exception_only" title="traceback.TracebackException.format_exception_only"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TracebackException.format_exception_only()</span></code></a> 增加了新的 <em>show_group</em> 仅限关键字形参用于（递归地）格式化 <a class="reference internal" href="../library/exceptions.html#BaseExceptionGroup" title="BaseExceptionGroup"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseExceptionGroup</span></code></a> 实例中嵌套的异常。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/105292">gh-105292</a> 中贡献。）</p></li>
</ul>
</section>
<section id="types">
<h3>types<a class="headerlink" href="#types" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>现在 <a class="reference internal" href="../library/types.html#types.SimpleNamespace" title="types.SimpleNamespace"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleNamespace</span></code></a> 可以接受单个位置参数来初始化命名空间的各个参数值。 该参数必须为映射或键值对的可迭代对象。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/108191">gh-108191</a> 中贡献。）</p></li>
</ul>
</section>
<section id="typing">
<h3>typing<a class="headerlink" href="#typing" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><span class="target" id="index-162"></span><a class="pep reference external" href="https://peps.python.org/pep-0705/"><strong>PEP 705</strong></a>: 增加 <a class="reference internal" href="../library/typing.html#typing.ReadOnly" title="typing.ReadOnly"><code class="xref py py-data docutils literal notranslate"><span class="pre">ReadOnly</span></code></a>，一个针对类型检查器的特殊类型结构，用于将 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></a> 的项标记为只读。</p></li>
<li><p><span class="target" id="index-163"></span><a class="pep reference external" href="https://peps.python.org/pep-0742/"><strong>PEP 742</strong></a>: 增加 <a class="reference internal" href="../library/typing.html#typing.TypeIs" title="typing.TypeIs"><code class="xref py py-data docutils literal notranslate"><span class="pre">TypeIs</span></code></a>，一个可被用于指示类型检查器如何细化类型的类型结构。</p></li>
<li><p>增加 <a class="reference internal" href="../library/typing.html#typing.NoDefault" title="typing.NoDefault"><code class="xref py py-data docutils literal notranslate"><span class="pre">NoDefault</span></code></a>，一个用于代表 <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模块中某些形参的默认值的哨兵对象。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/116126">gh-116126</a> 中贡献。）</p></li>
<li><p>增加 <a class="reference internal" href="../library/typing.html#typing.get_protocol_members" title="typing.get_protocol_members"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_protocol_members()</span></code></a> 用于返回定义一个 <a class="reference internal" href="../library/typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Protocol</span></code></a> 的成员的集合。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/104873">gh-104873</a> 中贡献。）</p></li>
<li><p>增加 <a class="reference internal" href="../library/typing.html#typing.is_protocol" title="typing.is_protocol"><code class="xref py py-func docutils literal notranslate"><span class="pre">is_protocol()</span></code></a> 用于检查一个类是否属于 <a class="reference internal" href="../library/typing.html#typing.Protocol" title="typing.Protocol"><code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></a>。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/104873">gh-104873</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/typing.html#typing.ClassVar" title="typing.ClassVar"><code class="xref py py-data docutils literal notranslate"><span class="pre">ClassVar</span></code></a> 可以被嵌套在 <a class="reference internal" href="../library/typing.html#typing.Final" title="typing.Final"><code class="xref py py-data docutils literal notranslate"><span class="pre">Final</span></code></a> 中，反之亦然。 （由 Mehdi Drissi 在 <a class="reference external" href="https://github.com/python/cpython/issues/89547">gh-89547</a> 中贡献。）</p></li>
</ul>
</section>
<section id="unicodedata">
<h3>unicodedata<a class="headerlink" href="#unicodedata" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>将 Unicode 数据库更新到 <a class="reference external" href="https://www.unicode.org/versions/Unicode15.1.0/">15.1.0 版</a>。 （由 James Gerity 在 <a class="reference external" href="https://github.com/python/cpython/issues/109559">gh-109559</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="venv">
<h3>venv<a class="headerlink" href="#venv" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了对在虚拟环境目录中添加源码控制管理 (SCM) 忽略文件的支持。 在默认情况下，Git 已受到支持。 此特性是以可被扩展为支持其他 SCM 的通过 API 选择启用 (<a class="reference internal" href="../library/venv.html#venv.EnvBuilder" title="venv.EnvBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnvBuilder</span></code></a> 和 <a class="reference internal" href="../library/venv.html#venv.create" title="venv.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">create()</span></code></a>)，并通过 CLI 使用 <code class="xref std std-option docutils literal notranslate"><span class="pre">--without-scm-ignore-files</span></code>  选择禁用的方式实现的。 （由 Brett Cannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/108125">gh-108125</a> 中贡献。）</p></li>
</ul>
</section>
<section id="warnings">
<h3>warnings<a class="headerlink" href="#warnings" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><span class="target" id="index-164"></span><a class="pep reference external" href="https://peps.python.org/pep-0702/"><strong>PEP 702</strong></a>: 新的 <a class="reference internal" href="../library/warnings.html#warnings.deprecated" title="warnings.deprecated"><code class="xref py py-func docutils literal notranslate"><span class="pre">warnings.deprecated()</span></code></a> 装饰器提供了一种将弃用消息传送给 <a class="reference internal" href="../glossary.html#term-static-type-checker"><span class="xref std std-term">static type checker</span></a> 并在使用已弃用的类和函数时发出警告的方式。 当被装饰的函数或类在运行时被使用时也可以发出 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。 （由 Jelle Zijlstra 在 <a class="reference external" href="https://github.com/python/cpython/issues/104003">gh-104003</a> 中贡献。）</p></li>
</ul>
</section>
<section id="xml">
<h3>xml<a class="headerlink" href="#xml" title="Link to this heading">¶</a></h3>
<ul>
<li><p>通过添加五个新方法来允许控制 Expat &gt;=2.6.0 重解析延迟 (<span class="target" id="index-165"></span><a class="cve reference external" href="https://www.cve.org/CVERecord?id=CVE-2023-52425"><strong>CVE 2023-52425</strong></a>)：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.XMLParser.flush" title="xml.etree.ElementTree.XMLParser.flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xml.etree.ElementTree.XMLParser.flush()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.XMLPullParser.flush" title="xml.etree.ElementTree.XMLPullParser.flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xml.etree.ElementTree.XMLPullParser.flush()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/pyexpat.html#xml.parsers.expat.xmlparser.GetReparseDeferralEnabled" title="xml.parsers.expat.xmlparser.GetReparseDeferralEnabled"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xml.parsers.expat.xmlparser.GetReparseDeferralEnabled()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/pyexpat.html#xml.parsers.expat.xmlparser.SetReparseDeferralEnabled" title="xml.parsers.expat.xmlparser.SetReparseDeferralEnabled"><code class="xref py py-meth docutils literal notranslate"><span class="pre">xml.parsers.expat.xmlparser.SetReparseDeferralEnabled()</span></code></a></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">xml.sax.expatreader.ExpatParser.flush()</span></code></p></li>
</ul>
<p>（由 Sebastian Pipping 在 <a class="reference external" href="https://github.com/python/cpython/issues/115623">gh-115623</a> 中贡献。）</p>
</li>
<li><p>为 <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.iterparse" title="xml.etree.ElementTree.iterparse"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterparse()</span></code></a> 所返回的迭代器增加了 <code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code> 方法用于执行显式的清理。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/69893">gh-69893</a> 中贡献。）</p></li>
</ul>
</section>
<section id="zipimport">
<h3>zipimport<a class="headerlink" href="#zipimport" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>增加了对 <a class="reference external" href="https://en.wikipedia.org/wiki/Zip_(file_format)#ZIP64">ZIP64</a> 格式的文件的支持。 大家都喜欢更庞大的数据，对吧？ （由 Tim Hatch 在 <a class="reference external" href="https://github.com/python/cpython/issues/94146">gh-94146</a> 中贡献。）.)</p>
</li>
</ul>
</section>
</section>
<section id="optimizations">
<h2>性能优化<a class="headerlink" href="#optimizations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>一些标准库模块的导入时间得到了显著改善。 例如，<a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模块的导入时间通过移除对 <a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a> 和 <a class="reference internal" href="../library/contextlib.html#module-contextlib" title="contextlib: Utilities for with-statement contexts."><code class="xref py py-mod docutils literal notranslate"><span class="pre">contextlib</span></code></a> 的依赖而减少了大约三分之一。 其他获得导入时间加速的模块包括 <a class="reference internal" href="../library/email.utils.html#module-email.utils" title="email.utils: Miscellaneous email package utilities."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.utils</span></code></a>, <a class="reference internal" href="../library/enum.html#module-enum" title="enum: Implementation of an enumeration class."><code class="xref py py-mod docutils literal notranslate"><span class="pre">enum</span></code></a>, <a class="reference internal" href="../library/functools.html#module-functools" title="functools: Higher-order functions and operations on callable objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">functools</span></code></a>, <a class="reference internal" href="../library/importlib.metadata.html#module-importlib.metadata" title="importlib.metadata: Accessing package metadata"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.metadata</span></code></a> 和 <a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a>。 （由 Alex Waygood, Shantanu Jain, Adam Turner, Daniel Hollas 等人在 <a class="reference external" href="https://github.com/python/cpython/issues/109653">gh-109653</a> 中贡献。）</p></li>
<li><p>现在对于大量输入 <a class="reference internal" href="../library/textwrap.html#textwrap.indent" title="textwrap.indent"><code class="xref py py-func docutils literal notranslate"><span class="pre">textwrap.indent()</span></code></a> 相比之前可提速大约 30%。 （由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/107369">gh-107369</a> 中贡献。）</p></li>
<li><p>现在 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 模块会在更多场合下使用 <a class="reference internal" href="../library/os.html#os.posix_spawn" title="os.posix_spawn"><code class="xref py py-func docutils literal notranslate"><span class="pre">posix_spawn()</span></code></a> 函数，包括在许多现代系统平台上当 <em>close_fds</em> 为 <code class="docutils literal notranslate"><span class="pre">True</span></code> (默认值) 的时候。 当在 FreeBSD 和 Solaris 上启动进程时这应该能提供显著的性能提升。 请参阅上面的 <a class="reference internal" href="#whatsnew313-subprocess"><span class="std std-ref">subprocess</span></a> 小节了解详情。 （由 Jakub Kulik 在 <a class="reference external" href="https://github.com/python/cpython/issues/113117">gh-113117</a> 中贡献。）</p></li>
</ul>
</section>
<section id="removed-modules-and-apis">
<h2>被移除的模块与 API<a class="headerlink" href="#removed-modules-and-apis" title="Link to this heading">¶</a></h2>
<section id="pep-594-remove-dead-batteries-from-the-standard-library">
<span id="whatsnew313-pep594"></span><h3>PEP 594: 从标准库中移除“死电池”<a class="headerlink" href="#pep-594-remove-dead-batteries-from-the-standard-library" title="Link to this heading">¶</a></h3>
<p><span class="target" id="index-166"></span><a class="pep reference external" href="https://peps.python.org/pep-0594/"><strong>PEP 594</strong></a> 提议从标准库移除 19 个模块，它们因其古旧、过时或不安全的状态而被非正式地称呼为‘死电池’。 下列所有模块在 Python 3.11 中被弃用，现在已被移除：</p>
<ul>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">aifc</span></code></p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-aifc/">standard-aifc</a>: 使用 PyPI 上的重新分发版 <code class="docutils literal notranslate"><span class="pre">aifc</span></code> 库。</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">audioop</span></code></p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/audioop-lts/">audioop-lts</a>: 使用 PyPI 上的 <code class="docutils literal notranslate"><span class="pre">audioop-lts</span></code> 库。</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">chunk</span></code></p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-chunk/">standard-chunk</a>: 使用 PyPI 上的重新分发版 <code class="docutils literal notranslate"><span class="pre">chunk</span></code> 库。</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">cgi</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">cgitb</span></code></p>
<ul>
<li><p>对于 <code class="docutils literal notranslate"><span class="pre">GET</span></code> 和 <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> 请求 <code class="xref py py-class docutils literal notranslate"><span class="pre">cgi.FieldStorage</span></code> 通常可以用 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.parse_qsl" title="urllib.parse.parse_qsl"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.parse.parse_qsl()</span></code></a> 来替换，而对于 <code class="docutils literal notranslate"><span class="pre">POST</span></code> 和 <code class="docutils literal notranslate"><span class="pre">PUT</span></code> 请求则可以用 <a class="reference internal" href="../library/email.message.html#module-email.message" title="email.message: The base class representing email messages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email.message</span></code></a> 模块或 <a class="extlink-pypi reference external" href="https://pypi.org/project/multipart/">multipart</a> 库。</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">cgi.parse()</span></code> 可被替换为在想要的查询字符串上直接调用 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.parse_qs" title="urllib.parse.parse_qs"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.parse.parse_qs()</span></code></a>，除非输入为 <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code>，它应当如下文针对 <code class="xref py py-func docutils literal notranslate"><span class="pre">cgi.parse_multipart()</span></code> 所描述的那样被替换。</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">cgi.parse_header()</span></code> 可被 <a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code></a> 包中的功能所替换，它实现了相同的 MIME RFC。 例如，使用 <a class="reference internal" href="../library/email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">email.message.EmailMessage</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">email.message</span><span class="w"> </span><span class="kn">import</span> <span class="n">EmailMessage</span>

<span class="n">msg</span> <span class="o">=</span> <span class="n">EmailMessage</span><span class="p">()</span>
<span class="n">msg</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;application/json; charset=&quot;utf8&quot;&#39;</span>
<span class="n">main</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">get_content_type</span><span class="p">(),</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;content-type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">cgi.parse_multipart()</span></code> 可以用 <a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code></a> 包中的功能来替换，它实现了相同的 MIME RFC，也可以用 <a class="extlink-pypi reference external" href="https://pypi.org/project/multipart/">multipart</a> 库。 例如，<a class="reference internal" href="../library/email.message.html#email.message.EmailMessage" title="email.message.EmailMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">email.message.EmailMessage</span></code></a> 和 <a class="reference internal" href="../library/email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">email.message.Message</span></code></a> 类。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-cgi/">standard-cgi</a>: 和 <a class="extlink-pypi reference external" href="https://pypi.org/project/standard-cgitb/">standard-cgitb</a>: 使用 PyPI 上的重新分发版 <code class="docutils literal notranslate"><span class="pre">cgi</span></code> 和 <code class="docutils literal notranslate"><span class="pre">cgitb</span></code> 库。</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">crypt</span></code> 以及私有的 <code class="xref py py-mod docutils literal notranslate"><span class="pre">_crypt</span></code> 扩展。 <a class="reference internal" href="../library/hashlib.html#module-hashlib" title="hashlib: Secure hash and message digest algorithms."><code class="xref py py-mod docutils literal notranslate"><span class="pre">hashlib</span></code></a> 模块在仅需对值执行哈希时是一个适当的替代物。 在其他情况下，可以使用 PyPI 上的一些第三方库：</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/bcrypt/">bcrypt</a>: 用于软件和服务器的现代密码哈希算法。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/passlib/">passlib</a>: 支持超过 over 30 种方案的综合密码哈希算法框架。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/argon2-cffi/">argon2-cffi</a>: 安全的 Argon2 密码哈希算法。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/legacycrypt/">legacycrypt</a>: 针对 POSIX 加密库调用和相关功能的 <a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a> 包装器。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/crypt_r/">crypt_r</a>: <code class="xref py py-mod docutils literal notranslate"><span class="pre">crypt</span></code> 模块的分叉，针对 <em class="manpage"><a class="manpage reference external" href="https://manpages.debian.org/crypt_r(3)">crypt_r(3)</a></em> 库调用和相关功能和包装器。</p></li>
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-crypt/">standard-crypt</a> and <a class="extlink-pypi reference external" href="https://pypi.org/project/deprecated-crypt-alternative/">deprecated-crypt-alternative</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">crypt</span></code> and reimplementation of <code class="docutils literal notranslate"><span class="pre">_crypt</span></code> libraries from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">imghdr</span></code>: 应当使用 <a class="extlink-pypi reference external" href="https://pypi.org/project/filetype/">filetype</a>, <a class="extlink-pypi reference external" href="https://pypi.org/project/puremagic/">puremagic</a> 或 <a class="extlink-pypi reference external" href="https://pypi.org/project/python-magic/">python-magic</a> 等库作为替代。 例如，对于 <code class="xref py py-mod docutils literal notranslate"><span class="pre">imghdr</span></code> 所支持的所有文件格式 <code class="xref py py-func docutils literal notranslate"><span class="pre">puremagic.what()</span></code> 函数可被用来替代 <code class="xref py py-func docutils literal notranslate"><span class="pre">imghdr.what()</span></code> 函数。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-imghdr/">standard-imghdr</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">imghdr</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">mailcap</span></code>: 改用 <a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a> 模块。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-mailcap/">standard-mailcap</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">mailcap</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">nis</span></code></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">nntplib</span></code>: 改用 PyPI 上的 <a class="extlink-pypi reference external" href="https://pypi.org/project/pynntp/">pynntp</a> 库。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-nntplib/">standard-nntplib</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">nntplib</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">ossaudiodev</span></code>: 对于音频回放，改用 PyPI 上的 <a class="extlink-pypi reference external" href="https://pypi.org/project/pygame/">pygame</a> 库。</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">pipes</span></code>: 改用 <a class="reference internal" href="../library/subprocess.html#module-subprocess" title="subprocess: Subprocess management."><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> 模块。 使用 <a class="reference internal" href="../library/shlex.html#shlex.quote" title="shlex.quote"><code class="xref py py-func docutils literal notranslate"><span class="pre">shlex.quote()</span></code></a> 来替代未写入文档的 <code class="docutils literal notranslate"><span class="pre">pipes.quote</span></code> 函数。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-pipes/">standard-pipes</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">pipes</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sndhdr</span></code>: 应当使用 <a class="extlink-pypi reference external" href="https://pypi.org/project/filetype/">filetype</a>, <a class="extlink-pypi reference external" href="https://pypi.org/project/puremagic/">puremagic</a> 或 <a class="extlink-pypi reference external" href="https://pypi.org/project/python-magic/">python-magic</a> 库作为替代。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-sndhdr/">standard-sndhdr</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">sndhdr</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">spwd</span></code>: 改用 PyPI 上的 <a class="extlink-pypi reference external" href="https://pypi.org/project/python-pam/">python-pam</a> 库。</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sunau</span></code></p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-sunau/">standard-sunau</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">sunau</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">telnetlib</span></code>，改用 PyPI 上的 <a class="extlink-pypi reference external" href="https://pypi.org/project/telnetlib3/">telnetlib3</a> 或 <a class="extlink-pypi reference external" href="https://pypi.org/project/Exscript/">Exscript</a> 库。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-telnetlib/">standard-telnetlib</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">telnetlib</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">uu</span></code>: 改用 the <a class="reference internal" href="../library/base64.html#module-base64" title="base64: RFC 4648: Base16, Base32, Base64 Data Encodings; Base85 and Ascii85"><code class="xref py py-mod docutils literal notranslate"><span class="pre">base64</span></code></a> 模块，作为一款现代化的替代。</p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-uu/">standard-uu</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">uu</span></code> library from PyPI.</p></li>
</ul>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">xdrlib</span></code></p>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/standard-xdrlib/">standard-xdrlib</a>:
Use the redistribution of <code class="docutils literal notranslate"><span class="pre">xdrlib</span></code> library from PyPI.</p></li>
</ul>
</li>
</ul>
<p>（由 Victor Stinner 和 Zachary Ware 在 <a class="reference external" href="https://github.com/python/cpython/issues/104773">gh-104773</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/104780">gh-104780</a> 中贡献。）</p>
</section>
<section id="to3">
<h3>2to3<a class="headerlink" href="#to3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除 <strong class="program">2to3</strong> 程序和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">lib2to3</span></code> 模块，此前已在 Python 3.11 中被弃用。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/104780">gh-104780</a> 中贡献。）</p></li>
</ul>
</section>
<section id="builtins">
<h3>builtins<a class="headerlink" href="#builtins" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了对串联 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a> 描述器的支持（在 <a class="reference external" href="https://github.com/python/cpython/issues/63272">gh-63272</a> 中引入）。 它们不能再被用来包装其他描述器，如 <a class="reference internal" href="../library/functions.html#property" title="property"><code class="xref py py-class docutils literal notranslate"><span class="pre">property</span></code></a>。 此特性的核心设计存在缺陷并导致了一些问题。 要“穿过”一个 <a class="reference internal" href="../library/functions.html#classmethod" title="classmethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code></a>，请考虑使用在 Python 3.10 中增加的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">__wrapped__</span></code> 属性。 （由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/89519">gh-89519</a> 中贡献。）.)</p></li>
<li><p>当在被挂起的帧上调用 <a class="reference internal" href="../reference/datamodel.html#frame.clear" title="frame.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">frame.clear()</span></code></a> 时将引发 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>。  (就如正在执行的帧一直以来的情况那样)。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/79932">gh-79932</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id3">
<h3>configparser<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了未写入文档的 <code class="xref py py-class docutils literal notranslate"><span class="pre">LegacyInterpolation</span></code> 类，它自 Python 3.2 起已在文档字符串中声明弃用，并且自 Python 3.11 起在运行时也已弃用。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/104886">gh-104886</a> 中贡献。）</p></li>
</ul>
</section>
<section id="importlib-metadata">
<h3>importlib.metadata<a class="headerlink" href="#importlib-metadata" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了已弃用的针对 <a class="reference internal" href="../library/importlib.metadata.html#entry-points"><span class="std std-ref">EntryPoint</span></a> 对象的下标 (<a class="reference internal" href="../reference/datamodel.html#object.__getitem__" title="object.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a>) 访问。 （由 Jason R. Coombs 在 <a class="reference external" href="https://github.com/python/cpython/issues/113175">gh-113175</a> 中贡献。）</p></li>
</ul>
</section>
<section id="locale">
<h3>locale<a class="headerlink" href="#locale" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了 <code class="xref py py-func docutils literal notranslate"><span class="pre">locale.resetlocale()</span></code> 函数，它已在 Python 3.11 中被弃用。 请改用 <code class="docutils literal notranslate"><span class="pre">locale.setlocale(locale.LC_ALL,</span> <span class="pre">&quot;&quot;)</span></code>。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/104783">gh-104783</a> 中贡献。）</p></li>
</ul>
</section>
<section id="opcode">
<h3>opcode<a class="headerlink" href="#opcode" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>将 <code class="xref py py-attr docutils literal notranslate"><span class="pre">opcode.ENABLE_SPECIALIZATION</span></code> 移至 <code class="xref py py-attr docutils literal notranslate"><span class="pre">_opcode.ENABLE_SPECIALIZATION</span></code>。 这个字段在是 3.12 中增加的，它从未被写入文档，也无意开放给外部使用。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/105481">gh-105481</a> 中贡献。）</p></li>
<li><p>移除了 <code class="xref py py-func docutils literal notranslate"><span class="pre">opcode.is_pseudo()</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">opcode.MIN_PSEUDO_OPCODE</span></code> 和 <code class="xref py py-attr docutils literal notranslate"><span class="pre">opcode.MAX_PSEUDO_OPCODE</span></code>，它们是在 Python 3.12 中增加了，但从未被写入文档也未通过 <a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dis</span></code></a> 对外公开，并且不应当在外部被使用。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/105481">gh-105481</a> 中贡献。）</p></li>
</ul>
</section>
<section id="optparse">
<h3>optparse<a class="headerlink" href="#optparse" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>This module is no longer considered <a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">soft deprecated</span></a>.
While <a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a> remains preferred for new projects that
aren't using a third party command line argument processing
library, there are aspects of the way <code class="docutils literal notranslate"><span class="pre">argparse</span></code> works that
mean the lower level <code class="docutils literal notranslate"><span class="pre">optparse</span></code> module may provide a better
foundation for <em>writing</em> argument processing libraries, and
for implementing command line applications which adhere more
strictly than <code class="docutils literal notranslate"><span class="pre">argparse</span></code> does to various Unix command line
processing conventions that originate in the behaviour of the
C <code class="xref c c-func docutils literal notranslate"><span class="pre">getopt()</span></code> function .
(Contributed by Alyssa Coghlan and Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/126180">gh-126180</a>.)</p></li>
</ul>
</section>
<section id="id4">
<h3>pathlib<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了使用 <a class="reference internal" href="../library/pathlib.html#pathlib.Path" title="pathlib.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> 对象作为上下文管理器的能力。 此功能自 Python 3.9 起已被弃用并设为空操作。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/83863">gh-83863</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id5">
<h3>re<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了未被写入文档、已被弃用且已不能工作的 <code class="xref py py-func docutils literal notranslate"><span class="pre">re.template()</span></code> 函数和 <code class="xref py py-attr docutils literal notranslate"><span class="pre">re.TEMPLATE</span></code> / <code class="xref py py-attr docutils literal notranslate"><span class="pre">re.T</span></code> 旗标。 （由 Serhiy Storchaka 和 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/105687">gh-105687</a> 中贡献。）</p></li>
</ul>
</section>
<section id="tkinter-tix">
<h3>tkinter.tix<a class="headerlink" href="#tkinter-tix" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">tkinter.tix</span></code> 模块，它在 Python 3.6 中已被弃用。 该模块所包装的第三方库 Tix 已不再维护。 （由 Zachary Ware 在 <a class="reference external" href="https://github.com/python/cpython/issues/75552">gh-75552</a> 中贡献。）.)</p></li>
</ul>
</section>
<section id="turtle">
<h3>turtle<a class="headerlink" href="#turtle" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了 <code class="xref py py-meth docutils literal notranslate"><span class="pre">RawTurtle.settiltangle()</span></code> 方法，它自 Python 3.1 起已在文档中声明弃用并自 Python 3.11 起在运行时声明弃用。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/104876">gh-104876</a> 中贡献。）</p></li>
</ul>
</section>
<section id="id6">
<h3>typing<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了 <code class="xref py py-mod docutils literal notranslate"><span class="pre">typing.io</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">typing.re</span></code> 命令空间，它们自 Python 3.8 起已被弃用。 这些命名空间中的条目可从 <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模块直接导入。 （由 Sebastian Rittau 在 <a class="reference external" href="https://github.com/python/cpython/issues/92871">gh-92871</a> 中贡献。）</p></li>
<li><p>移除了创建 <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypedDict</span></code></a> 类型的关键字参数方法，它在 Python 3.11 中已被弃用。 （由 Tomas Roun 在 <a class="reference external" href="https://github.com/python/cpython/issues/104786">gh-104786</a> 中贡献。）</p></li>
</ul>
</section>
<section id="unittest">
<h3>unittest<a class="headerlink" href="#unittest" title="Link to this heading">¶</a></h3>
<ul>
<li><p>移除了下列 <a class="reference internal" href="../library/unittest.html#module-unittest" title="unittest: Unit testing framework for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">unittest</span></code></a> 函数，它们在 Python 3.11 中已被弃用：</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.findTestCases()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.makeSuite()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">unittest.getTestCaseNames()</span></code></p></li>
</ul>
<p>请改用 <a class="reference internal" href="../library/unittest.html#unittest.TestLoader" title="unittest.TestLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">TestLoader</span></code></a> 方法:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.loadTestsFromModule" title="unittest.TestLoader.loadTestsFromModule"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loadTestsFromModule()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.loadTestsFromTestCase" title="unittest.TestLoader.loadTestsFromTestCase"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loadTestsFromTestCase()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/unittest.html#unittest.TestLoader.getTestCaseNames" title="unittest.TestLoader.getTestCaseNames"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getTestCaseNames()</span></code></a></p></li>
</ul>
<p>（由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/104835">gh-104835</a> 中贡献。）</p>
</li>
<li><p>移除了未经测试且未写入文档的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">TestProgram.usageExit()</span></code> 方法，它在 Python 3.11 中已被弃用。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/104992">gh-104992</a> 中贡献。）</p></li>
</ul>
</section>
<section id="urllib">
<h3>urllib<a class="headerlink" href="#urllib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了 <a class="reference internal" href="../library/urllib.request.html#urllib.request.urlopen" title="urllib.request.urlopen"><code class="xref py py-func docutils literal notranslate"><span class="pre">urllib.request.urlopen()</span></code></a> 函数的 <em>cafile</em>, <em>capath</em> 和 <em>cadefault</em> 等形参，它们在 Python 3.6 中已弃用。 应改为向 <em>context</em> 形参传入一个 <a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSLContext</span></code></a> 实例。 可以使用 <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.load_cert_chain" title="ssl.SSLContext.load_cert_chain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ssl.SSLContext.load_cert_chain()</span></code></a> 函数来加载指定的证书，或是让 <a class="reference internal" href="../library/ssl.html#ssl.create_default_context" title="ssl.create_default_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">ssl.create_default_context()</span></code></a> 来选择操作系统的受信任证书颁发机构 (CA) 证书。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/105382">gh-105382</a> 中贡献。）</p></li>
</ul>
</section>
<section id="webbrowser">
<h3>webbrowser<a class="headerlink" href="#webbrowser" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>移除了未经测试且未写入文档的 <code class="xref py py-class docutils literal notranslate"><span class="pre">MacOSX</span></code> 类，它在 Python 3.11 中已弃用。 请改用 <code class="xref py py-class docutils literal notranslate"><span class="pre">MacOSXOSAScript</span></code> 类（在 Python 3.2 中引入）。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/104804">gh-104804</a> 中贡献。）</p></li>
<li><p>移除了已被弃用的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">MacOSXOSAScript._name</span></code> 属性。 请改用 <a class="reference internal" href="../library/webbrowser.html#webbrowser.controller.name" title="webbrowser.controller.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MacOSXOSAScript.name</span></code></a> 属性。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/105546">gh-105546</a> 中贡献。）</p></li>
</ul>
</section>
</section>
<section id="new-deprecations">
<h2>新的弃用<a class="headerlink" href="#new-deprecations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../reference/datamodel.html#user-defined-funcs"><span class="std std-ref">用户自定义函数</span></a>:</p>
<ul>
<li><p>弃用对函数的 <a class="reference internal" href="../reference/datamodel.html#function.__code__" title="function.__code__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__code__</span></code></a> 属性的赋值，其中新代码对象的类型与函数的类型不匹配。 不同的类型有：普通函数、生成器、异步生成器和协程。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/81137">gh-81137</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a>:</p>
<ul>
<li><p>在运行时弃用 <code class="docutils literal notranslate"><span class="pre">'u'</span></code> 格式代码 (<code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>)。 此格式代码自 Python 3.3 起在文档中已被弃用，并将在 Python 3.16 中被移除。对于 Unicode 字符，请使用 <code class="docutils literal notranslate"><span class="pre">'w'</span></code> 格式代码 (<a class="reference internal" href="../c-api/unicode.html#c.Py_UCS4" title="Py_UCS4"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS4</span></code></a>)。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/80480">gh-80480</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>:</p>
<ul>
<li><p>弃用了未写入文档的 <code class="xref py py-func docutils literal notranslate"><span class="pre">SetPointerType()</span></code> 函数，并将在 Python 3.15 中移除。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/105733">gh-105733</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">软弃用</span></a> <a class="reference internal" href="../library/ctypes.html#ctypes.ARRAY" title="ctypes.ARRAY"><code class="xref py py-func docutils literal notranslate"><span class="pre">ARRAY()</span></code></a> 函数并改用 <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">*</span> <span class="pre">length</span></code> 乘法运算。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/105733">gh-105733</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/decimal.html#module-decimal" title="decimal: Implementation of the General Decimal Arithmetic  Specification."><code class="xref py py-mod docutils literal notranslate"><span class="pre">decimal</span></code></a>:</p>
<ul>
<li><p>弃用了非标准且未写入文档的 <a class="reference internal" href="../library/decimal.html#decimal.Decimal" title="decimal.Decimal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Decimal</span></code></a> 格式说明符 <code class="docutils literal notranslate"><span class="pre">'N'</span></code>，它仅在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">decimal</span></code> 模块的 C 实现中受到支持。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/89902">gh-89902</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/dis.html#module-dis" title="dis: Disassembler for Python bytecode."><code class="xref py py-mod docutils literal notranslate"><span class="pre">dis</span></code></a>:</p>
<ul>
<li><p>弃用了 <code class="xref py py-attr docutils literal notranslate"><span class="pre">HAVE_ARGUMENT</span></code> 分隔符。 改为在 <a class="reference internal" href="../library/dis.html#dis.hasarg" title="dis.hasarg"><code class="xref py py-data docutils literal notranslate"><span class="pre">hasarg</span></code></a> 中的成员检测。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/109319">gh-109319</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/gettext.html#module-gettext" title="gettext: Multilingual internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code></a>:</p>
<ul>
<li><p>在 <code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code> 模块中，弃用非整数作为考虑复数形式的函数和方法的参数，即使没有找到翻译时也不可以。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/88434">gh-88434</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/glob.html#module-glob" title="glob: Unix shell style pathname pattern expansion."><code class="xref py py-mod docutils literal notranslate"><span class="pre">glob</span></code></a>:</p>
<ul>
<li><p>弃用未写入文档的 <code class="xref py py-func docutils literal notranslate"><span class="pre">glob0()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">glob1()</span></code> 函数。改为使用 <a class="reference internal" href="../library/glob.html#glob.glob" title="glob.glob"><code class="xref py py-func docutils literal notranslate"><span class="pre">glob()</span></code></a> 并传递一个指定根目录的 <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> 到 <em>root_dir</em> 形参。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/117337">gh-117337</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a>:</p>
<ul>
<li><p>弃用 <a class="reference internal" href="../library/http.server.html#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 类，将在 Python 3.15 中移除。 基于进程的 CGI HTTP 服务器已经过时很久了。 该代码已经过时，无人维护，而且很少使用。 它极有可能出现安全和功能方面的程序错误。 （由 Gregory P. Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/109096">gh-109096</a> 中贡献。）</p></li>
<li><p>弃用:program:<cite>python -m http.server</cite> 命令行接口的:option:<cite>!--cgi`标志位 ，将在Python 3.15 中移除。（由 Gregory P. Smith 在:gh:`109096</cite> 中提供）。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/mimetypes.html#module-mimetypes" title="mimetypes: Mapping of filename extensions to MIME types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">mimetypes</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">软弃用</span></a> 传给 <a class="reference internal" href="../library/mimetypes.html#mimetypes.guess_type" title="mimetypes.guess_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_type()</span></code></a> 的文件路径参数，改用 <a class="reference internal" href="../library/mimetypes.html#mimetypes.guess_file_type" title="mimetypes.guess_file_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">guess_file_type()</span></code></a>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/66543">gh-66543</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>:</p>
<ul>
<li><p>弃用将可选的 <em>maxsplit</em>, <em>count</em> 或 <em>flags</em> 参数以位置参数形式传给模块级 <a class="reference internal" href="../library/re.html#re.split" title="re.split"><code class="xref py py-func docutils literal notranslate"><span class="pre">split()</span></code></a>, <a class="reference internal" href="../library/re.html#re.sub" title="re.sub"><code class="xref py py-func docutils literal notranslate"><span class="pre">sub()</span></code></a> 和 <a class="reference internal" href="../library/re.html#re.subn" title="re.subn"><code class="xref py py-func docutils literal notranslate"><span class="pre">subn()</span></code></a> 函数的做法。 这些形参将在未来的 Python 版本中成为 <a class="reference internal" href="../glossary.html#keyword-only-parameter"><span class="std std-ref">仅限关键字形参</span></a>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/56166">gh-56166</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>:</p>
<ul>
<li><p>弃用 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.is_reserved" title="pathlib.PurePath.is_reserved"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurePath.is_reserved()</span></code></a>，将在 Python 3.15 中移除。 请使用 <a class="reference internal" href="../library/os.path.html#os.path.isreserved" title="os.path.isreserved"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.isreserved()</span></code></a> 来检测 Windows 上的保留路径。 （由 Barney Gale 在 <a class="reference external" href="https://github.com/python/cpython/issues/88569">gh-88569</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/platform.html#module-platform" title="platform: Retrieves as much platform identifying data as possible."><code class="xref py py-mod docutils literal notranslate"><span class="pre">platform</span></code></a>:</p>
<ul>
<li><p>弃用了 <a class="reference internal" href="../library/platform.html#platform.java_ver" title="platform.java_ver"><code class="xref py py-func docutils literal notranslate"><span class="pre">java_ver()</span></code></a>，并将在 Python 3.15 中移除。 此函数仅对 Jython 支持有用，具有令人困惑的 API，并且大部分未经测试。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/116349">gh-116349</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/pydoc.html#module-pydoc" title="pydoc: Documentation generator and online help system."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pydoc</span></code></a>:</p>
<ul>
<li><p>弃用未写入文档的 <code class="xref py py-func docutils literal notranslate"><span class="pre">ispackage()</span></code> 函数。 （由 Zackery Spytz 在 <a class="reference external" href="https://github.com/python/cpython/issues/64020">gh-64020</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a>:</p>
<ul>
<li><p>弃用向 <a class="reference internal" href="../library/sqlite3.html#sqlite3.connect" title="sqlite3.connect"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect()</span></code></a> 函数和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> 构造器传入多个位置参数的做法。 其余的形参在 Python 3.15 中将成为仅限关键字形参。 （由 Erlend E. Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/107948">gh-107948</a> 中贡献。）</p></li>
<li><p>Deprecate passing name, number of arguments, and the callable as keyword
arguments for <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.create_function" title="sqlite3.Connection.create_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.create_function()</span></code></a>
and <a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.create_aggregate" title="sqlite3.Connection.create_aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.create_aggregate()</span></code></a>
These parameters will become positional-only in Python 3.15.
(Contributed by Erlend E. Aasland in <a class="reference external" href="https://github.com/python/cpython/issues/108278">gh-108278</a>.)</p></li>
<li><p>Deprecate passing the callback callable by keyword for the
<a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.set_authorizer" title="sqlite3.Connection.set_authorizer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_authorizer()</span></code></a>,
<a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.set_progress_handler" title="sqlite3.Connection.set_progress_handler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_progress_handler()</span></code></a>, and
<a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection.set_trace_callback" title="sqlite3.Connection.set_trace_callback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_trace_callback()</span></code></a>
<a class="reference internal" href="../library/sqlite3.html#sqlite3.Connection" title="sqlite3.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> methods.
The callback callables will become positional-only in Python 3.15.
(Contributed by Erlend E. Aasland in <a class="reference external" href="https://github.com/python/cpython/issues/108278">gh-108278</a>.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a>:</p>
<ul>
<li><p>弃用 <a class="reference internal" href="../library/sys.html#sys._enablelegacywindowsfsencoding" title="sys._enablelegacywindowsfsencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">_enablelegacywindowsfsencoding()</span></code></a> 函数，并将在 Python 3.16 中移除。 请改用 <span class="target" id="index-167"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONLEGACYWINDOWSFSENCODING"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONLEGACYWINDOWSFSENCODING</span></code></a> 环境变量。 （由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/73427">gh-73427</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>:</p>
<ul>
<li><p>弃用了未写入文档也未被使用的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">TarFile.tarfile</span></code> 属性，并将在 Python 3.16 中移除。 （在 <a class="reference external" href="https://github.com/python/cpython/issues/115256">gh-115256</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/traceback.html#module-traceback" title="traceback: Print or retrieve a stack traceback."><code class="xref py py-mod docutils literal notranslate"><span class="pre">traceback</span></code></a>:</p>
<ul>
<li><p>已弃用 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.exc_type" title="traceback.TracebackException.exc_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TracebackException.exc_type</span></code></a> 属性。 请改用 <a class="reference internal" href="../library/traceback.html#traceback.TracebackException.exc_type_str" title="traceback.TracebackException.exc_type_str"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TracebackException.exc_type_str</span></code></a>。 （由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/112332">gh-112332</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a>:</p>
<ul>
<li><p>弃用了未写入文档的用于创建 <a class="reference internal" href="../library/typing.html#typing.NamedTuple" title="typing.NamedTuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a> 类的关键字参数语法 (例如 <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">=</span> <span class="pre">NamedTuple(&quot;Point&quot;,</span> <span class="pre">x=int,</span> <span class="pre">y=int)</span></code>)，将在 Python 3.15 中移除。 请改用基于类的语法或函数式语法。 （由 Alex Waygood 在 <a class="reference external" href="https://github.com/python/cpython/issues/105566">gh-105566</a> 中贡献。）</p></li>
<li><p>Deprecate omitting the <em>fields</em> parameter when creating
a <a class="reference internal" href="../library/typing.html#typing.NamedTuple" title="typing.NamedTuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a> or <a class="reference internal" href="../library/typing.html#typing.TypedDict" title="typing.TypedDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.TypedDict</span></code></a> class,
and deprecate passing <code class="docutils literal notranslate"><span class="pre">None</span></code> to the <em>fields</em> parameter of both types.
Python 3.15 will require a valid sequence for the <em>fields</em> parameter.
To create a NamedTuple class with zero fields,
use <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">NT(NamedTuple):</span> <span class="pre">pass</span></code> or <code class="docutils literal notranslate"><span class="pre">NT</span> <span class="pre">=</span> <span class="pre">NamedTuple(&quot;NT&quot;,</span> <span class="pre">())</span></code>.
To create a TypedDict class with zero fields,
use <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">TD(TypedDict):</span> <span class="pre">pass</span></code> or <code class="docutils literal notranslate"><span class="pre">TD</span> <span class="pre">=</span> <span class="pre">TypedDict(&quot;TD&quot;,</span> <span class="pre">{})</span></code>.
(Contributed by Alex Waygood in <a class="reference external" href="https://github.com/python/cpython/issues/105566">gh-105566</a> and <a class="reference external" href="https://github.com/python/cpython/issues/105570">gh-105570</a>.)</p></li>
<li><p>Deprecate the <a class="reference internal" href="../library/typing.html#typing.no_type_check_decorator" title="typing.no_type_check_decorator"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.no_type_check_decorator()</span></code></a> decorator function,
to be removed in in Python 3.15.
After eight years in the <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> module,
it has yet to be supported by any major type checker.
(Contributed by Alex Waygood in <a class="reference external" href="https://github.com/python/cpython/issues/106309">gh-106309</a>.)</p></li>
<li><p>Deprecate <a class="reference internal" href="../library/typing.html#typing.AnyStr" title="typing.AnyStr"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.AnyStr</span></code></a>.
In Python 3.16, it will be removed from <code class="docutils literal notranslate"><span class="pre">typing.__all__</span></code>,
and a <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> will be emitted at runtime
when it is imported or accessed.
It will be removed entirely in Python 3.18.
Use the new <a class="reference internal" href="../reference/compound_stmts.html#type-params"><span class="std std-ref">type parameter syntax</span></a> instead.
(Contributed by Michael The in <a class="reference external" href="https://github.com/python/cpython/issues/107116">gh-107116</a>.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/wave.html#module-wave" title="wave: Provide an interface to the WAV sound format."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wave</span></code></a>:</p>
<ul>
<li><p>Deprecate the <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmark" title="wave.Wave_read.getmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmark()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">setmark()</span></code>,
and <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmarkers" title="wave.Wave_read.getmarkers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmarkers()</span></code></a> methods of
the <a class="reference internal" href="../library/wave.html#wave.Wave_read" title="wave.Wave_read"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_read</span></code></a> and <a class="reference internal" href="../library/wave.html#wave.Wave_write" title="wave.Wave_write"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_write</span></code></a> classes,
to be removed in Python 3.15.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105096">gh-105096</a>.)</p></li>
</ul>
</li>
</ul>
<section id="pending-removal-in-python-3-14">
<h3>Pending removal in Python 3.14<a class="headerlink" href="#pending-removal-in-python-3-14" title="Link to this heading">¶</a></h3>
<ul>
<li><p><a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>: <code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.BooleanOptionalAction</span></code> 的 <em>type</em>, <em>choices</em> 和 <em>metavar</em> 形参已被弃用并将在 3.14 中移除。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/92248">gh-92248</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/ast.html#module-ast" title="ast: Abstract Syntax Tree classes and manipulation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ast</span></code></a>: 以下特性自 Python 3.8 起已在文档中声明弃用，现在当运行时如果它们被访问或使用时将发出 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>，并将在 Python 3.14 中移除：</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Num</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Str</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Bytes</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.NameConstant</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Ellipsis</span></code></p></li>
</ul>
<p>请改用 <a class="reference internal" href="../library/ast.html#ast.Constant" title="ast.Constant"><code class="xref py py-class docutils literal notranslate"><span class="pre">ast.Constant</span></code></a>。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/90953">gh-90953</a> 中贡献。）</p>
</li>
<li><p><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>:</p>
<ul class="simple">
<li><p>The child watcher classes <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.MultiLoopChildWatcher</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.FastChildWatcher</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.AbstractChildWatcher</span></code>
and <code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.SafeChildWatcher</span></code> are deprecated and
will be removed in Python 3.14.
(Contributed by Kumar Aditya in <a class="reference external" href="https://github.com/python/cpython/issues/94597">gh-94597</a>.)</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.set_child_watcher()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_child_watcher()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoopPolicy.set_child_watcher()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoopPolicy.get_child_watcher()</span></code> are deprecated
and will be removed in Python 3.14.
(Contributed by Kumar Aditya in <a class="reference external" href="https://github.com/python/cpython/issues/94597">gh-94597</a>.)</p></li>
<li><p>现在默认事件循环策略的 <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.get_event_loop" title="asyncio.get_event_loop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_event_loop()</span></code></a> 方法在当前事件循环未设置并决定创建一个时将发出 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。 （由 Serhiy Storchaka 和 Guido van Rossum 在 <a class="reference external" href="https://github.com/python/cpython/issues/100160">gh-100160</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/collections.abc.html#module-collections.abc" title="collections.abc: Abstract base classes for containers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections.abc</span></code></a>: Deprecated <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.ByteString</span></code>.
Prefer <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code> or <a class="reference internal" href="../library/collections.abc.html#collections.abc.Buffer" title="collections.abc.Buffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Buffer</span></code></a>.
For use in typing, prefer a union, like <code class="docutils literal notranslate"><span class="pre">bytes</span> <span class="pre">|</span> <span class="pre">bytearray</span></code>,
or <a class="reference internal" href="../library/collections.abc.html#collections.abc.Buffer" title="collections.abc.Buffer"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Buffer</span></code></a>.
(Contributed by Shantanu Jain in <a class="reference external" href="https://github.com/python/cpython/issues/91896">gh-91896</a>.)</p></li>
<li><p><a class="reference internal" href="../library/email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages."><code class="xref py py-mod docutils literal notranslate"><span class="pre">email</span></code></a>: 已弃用 <a class="reference internal" href="../library/email.utils.html#email.utils.localtime" title="email.utils.localtime"><code class="xref py py-func docutils literal notranslate"><span class="pre">email.utils.localtime()</span></code></a> 中的 <em>isdst</em> 形参。 （由 Alan Williams 在 <a class="reference external" href="https://github.com/python/cpython/issues/72346">gh-72346</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/importlib.html#module-importlib.abc" title="importlib.abc: Abstract base classes related to import"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.abc</span></code></a> 中已弃用的类：</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.ResourceReader</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.Traversable</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.abc.TraversableResources</span></code></p></li>
</ul>
<p>使用 <a class="reference internal" href="../library/importlib.resources.abc.html#module-importlib.resources.abc" title="importlib.resources.abc: Abstract base classes for resources"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.resources.abc</span></code></a> 类代替:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.Traversable" title="importlib.resources.abc.Traversable"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.resources.abc.Traversable</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/importlib.resources.abc.html#importlib.resources.abc.TraversableResources" title="importlib.resources.abc.TraversableResources"><code class="xref py py-class docutils literal notranslate"><span class="pre">importlib.resources.abc.TraversableResources</span></code></a></p></li>
</ul>
<p>（由 Jason R. Coombs 和 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/93963">gh-93963</a> 中贡献。）</p>
</li>
<li><p><a class="reference internal" href="../library/itertools.html#module-itertools" title="itertools: Functions creating iterators for efficient looping."><code class="xref py py-mod docutils literal notranslate"><span class="pre">itertools</span></code></a> 具有对 copy, deepcopy 和 pickle 等操作的未写入文档的、低效的、历史上充满问题的且不稳定的支持。 这将在 3.14 中移除以显著减少代码量和维护负担。 （由 Raymond Hettinger 在 <a class="reference external" href="https://github.com/python/cpython/issues/101588">gh-101588</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../library/multiprocessing.html#module-multiprocessing" title="multiprocessing: Process-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a>: 默认的启动方法在目前默认使用 <code class="docutils literal notranslate"><span class="pre">'fork'</span></code> 的 Linux, BSD 和其他非 macOS POSIX 平台上将改为更安全的方法 (<a class="reference external" href="https://github.com/python/cpython/issues/84559">gh-84559</a>)。 为此添加运行时警告将带来糟糕的体验因为大部分代码并不会关心这个问题。 当你的代码 <em>需要</em> <code class="docutils literal notranslate"><span class="pre">'fork'</span></code> 时请使用 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.get_context" title="multiprocessing.get_context"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_context()</span></code></a> 或 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing.set_start_method" title="multiprocessing.set_start_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_start_method()</span></code></a> API 来显式地指明。 参见 <a class="reference internal" href="../library/multiprocessing.html#multiprocessing-start-methods"><span class="std std-ref">上下文和启动方法</span></a>。</p></li>
<li><p><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>: <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.is_relative_to" title="pathlib.PurePath.is_relative_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_relative_to()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.relative_to" title="pathlib.PurePath.relative_to"><code class="xref py py-meth docutils literal notranslate"><span class="pre">relative_to()</span></code></a>: 传入额外参数的做法已被弃用。</p></li>
<li><p><a class="reference internal" href="../library/pkgutil.html#module-pkgutil" title="pkgutil: Utilities for the import system."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkgutil</span></code></a>: <code class="xref py py-func docutils literal notranslate"><span class="pre">pkgutil.find_loader()</span></code> and :func:!pkgutil.get_loader`
now raise <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>;
use <a class="reference internal" href="../library/importlib.html#importlib.util.find_spec" title="importlib.util.find_spec"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.util.find_spec()</span></code></a> instead.
(Contributed by Nikita Sobolev in <a class="reference external" href="https://github.com/python/cpython/issues/97850">gh-97850</a>.)</p></li>
<li><p><a class="reference internal" href="../library/pty.html#module-pty" title="pty: Pseudo-Terminal Handling for Unix. (Unix)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pty</span></code></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">master_open()</span></code>: 使用 <a class="reference internal" href="../library/pty.html#pty.openpty" title="pty.openpty"><code class="xref py py-func docutils literal notranslate"><span class="pre">pty.openpty()</span></code></a>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">slave_open()</span></code>: 使用 <a class="reference internal" href="../library/pty.html#pty.openpty" title="pty.openpty"><code class="xref py py-func docutils literal notranslate"><span class="pre">pty.openpty()</span></code></a>。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a>:</p>
<ul class="simple">
<li><p><code class="xref py py-data docutils literal notranslate"><span class="pre">version</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">version_info</span></code>.</p></li>
<li><p>如果使用了 <a class="reference internal" href="../library/sqlite3.html#sqlite3-placeholders"><span class="std std-ref">命名占位符</span></a> 且 <em>parameters</em> 是一个序列而不是 <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> 则选择 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Cursor.execute" title="sqlite3.Cursor.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute()</span></code></a> 和 <a class="reference internal" href="../library/sqlite3.html#sqlite3.Cursor.executemany" title="sqlite3.Cursor.executemany"><code class="xref py py-meth docutils literal notranslate"><span class="pre">executemany()</span></code></a>。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a>: <code class="xref py py-class docutils literal notranslate"><span class="pre">typing.ByteString</span></code>, deprecated since Python 3.9,
now causes a <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a> to be emitted when it is used.</p></li>
<li><p><a class="reference internal" href="../library/urllib.html#module-urllib" title="urllib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib</span></code></a>: <code class="xref py py-class docutils literal notranslate"><span class="pre">urllib.parse.Quoter</span></code> 已被弃用：它不应被作为公有 API。 （由 Gregory P. Smith 在 <a class="reference external" href="https://github.com/python/cpython/issues/88168">gh-88168</a> 中贡献。）</p></li>
</ul>
</section>
<section id="pending-removal-in-python-3-15">
<h3>Pending removal in Python 3.15<a class="headerlink" href="#pending-removal-in-python-3-15" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>导入系统：</p>
<ul>
<li><p>当设置 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.cached" title="importlib.machinery.ModuleSpec.cached"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.cached</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__cached__" title="module.__cached__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__cached__</span></code></a> 的做法已被弃用。 在 Python 3.15 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__cached__</span></code> 将不会再被导入系统或标准库纳入考虑。 (<a class="reference external" href="https://github.com/python/cpython/issues/97879">gh-97879</a>)</p></li>
<li><p>当设备 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.parent" title="importlib.machinery.ModuleSpec.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.parent</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__package__" title="module.__package__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__package__</span></code></a> 的做法已被弃用。 在 Python 3.15 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__package__</span></code> 将不会再被导入系统或标准库纳入考虑。 (<a class="reference external" href="https://github.com/python/cpython/issues/97879">gh-97879</a>)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><code class="xref py py-mod docutils literal notranslate"><span class="pre">ctypes</span></code></a>:</p>
<ul>
<li><p>未写入文档的 <code class="xref py py-func docutils literal notranslate"><span class="pre">ctypes.SetPointerType()</span></code> 函数自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/http.server.html#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a>:</p>
<ul>
<li><p>过时且很少被使用的 <a class="reference internal" href="../library/http.server.html#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 自 Python 3.13 起已被弃用。 不存在直接的替代品。 对于建立带有请求处理器的 Web 服务程序来说 <em>任何东西</em> 都比 CGI 要好。</p></li>
<li><p>用于 <strong class="program">python -m http.server</strong> 命令行界面的 <code class="xref std std-option docutils literal notranslate"><span class="pre">--cgi</span></code> 旗标自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/locale.html#module-locale" title="locale: Internationalization services."><code class="xref py py-class docutils literal notranslate"><span class="pre">locale</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/locale.html#locale.getdefaultlocale" title="locale.getdefaultlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">getdefaultlocale()</span></code></a> 函数自 Python 3.11 起已被弃用。 最初计划在 Python 3.13 中移除它 (<a class="reference external" href="https://github.com/python/cpython/issues/90817">gh-90817</a>)，但已被推迟至 Python 3.15。 请改用 <a class="reference internal" href="../library/locale.html#locale.getlocale" title="locale.getlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">getlocale()</span></code></a>, <a class="reference internal" href="../library/locale.html#locale.setlocale" title="locale.setlocale"><code class="xref py py-func docutils literal notranslate"><span class="pre">setlocale()</span></code></a> 和 <a class="reference internal" href="../library/locale.html#locale.getencoding" title="locale.getencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">getencoding()</span></code></a>。 （由 Hugo van Kemenade 在 <a class="reference external" href="https://github.com/python/cpython/issues/111187">gh-111187</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/pathlib.html#module-pathlib" title="pathlib: Object-oriented filesystem paths"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/pathlib.html#pathlib.PurePath.is_reserved" title="pathlib.PurePath.is_reserved"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PurePath.is_reserved()</span></code></a> 自 Python 3.13 起已被弃用。 请使用 <a class="reference internal" href="../library/os.path.html#os.path.isreserved" title="os.path.isreserved"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.path.isreserved()</span></code></a> 来检测 Windows 上的保留路径。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/platform.html#module-platform" title="platform: Retrieves as much platform identifying data as possible."><code class="xref py py-mod docutils literal notranslate"><span class="pre">platform</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/platform.html#platform.java_ver" title="platform.java_ver"><code class="xref py py-func docutils literal notranslate"><span class="pre">java_ver()</span></code></a> 自 Python 3.13 起已被弃用。 此函数仅对 Jython 支持有用，具有令人困惑的 API，并且大部分未经测试。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sysconfig</span></code></a>:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">check_home</span></code> argument of <a class="reference internal" href="../library/sysconfig.html#sysconfig.is_python_build" title="sysconfig.is_python_build"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.is_python_build()</span></code></a> has been
deprecated since Python 3.12.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a>:</p>
<ul>
<li><p>在 Python 3.15 中 <a class="reference internal" href="../library/threading.html#threading.RLock" title="threading.RLock"><code class="xref py py-func docutils literal notranslate"><span class="pre">RLock()</span></code></a> 将不再接受参数。 传入参数的做法自 Python 3.14 起已被弃用，因为 Python 版本不接受任何参数，而 C 版本允许任意数量的位置或关键字参数，但会忽略所有参数。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/types.html#module-types" title="types: Names for built-in types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">types</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/types.html#types.CodeType" title="types.CodeType"><code class="xref py py-class docutils literal notranslate"><span class="pre">types.CodeType</span></code></a>: 访问 <a class="reference internal" href="../reference/datamodel.html#codeobject.co_lnotab" title="codeobject.co_lnotab"><code class="xref py py-attr docutils literal notranslate"><span class="pre">co_lnotab</span></code></a> 的做法自 3.10 起已根据 <span class="target" id="index-168"></span><a class="pep reference external" href="https://peps.python.org/pep-0626/"><strong>PEP 626</strong></a> 被弃用并曾计划在 3.12 中移除，但在 3.12 中实际仅设置了 <a class="reference internal" href="../library/exceptions.html#DeprecationWarning" title="DeprecationWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DeprecationWarning</span></code></a>。 可能会在 3.15 中移除。 （由 Nikita Sobolev 在 <a class="reference external" href="https://github.com/python/cpython/issues/101866">gh-101866</a> 中贡献。）</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a>:</p>
<ul>
<li><p>The undocumented keyword argument syntax for creating
<a class="reference internal" href="../library/typing.html#typing.NamedTuple" title="typing.NamedTuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></a> classes
(for example, <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">=</span> <span class="pre">NamedTuple(&quot;Point&quot;,</span> <span class="pre">x=int,</span> <span class="pre">y=int)</span></code>)
has been deprecated since Python 3.13.
Use the class-based syntax or the functional syntax instead.</p></li>
<li><p><a class="reference internal" href="../library/typing.html#typing.no_type_check_decorator" title="typing.no_type_check_decorator"><code class="xref py py-func docutils literal notranslate"><span class="pre">typing.no_type_check_decorator()</span></code></a> 装饰器自 Python 3.13 起已被弃用。 存在于 <a class="reference internal" href="../library/typing.html#module-typing" title="typing: Support for type hints (see :pep:`484`)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">typing</span></code></a> 模块八年之后，它仍未被任何主要类型检查器所支持。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/wave.html#module-wave" title="wave: Provide an interface to the WAV sound format."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wave</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/wave.html#wave.Wave_read" title="wave.Wave_read"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_read</span></code></a> 和 <a class="reference internal" href="../library/wave.html#wave.Wave_write" title="wave.Wave_write"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wave_write</span></code></a> 类的 <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmark" title="wave.Wave_read.getmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmark()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">setmark()</span></code> 和 <a class="reference internal" href="../library/wave.html#wave.Wave_read.getmarkers" title="wave.Wave_read.getmarkers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmarkers()</span></code></a> 方法自 Python 3.13 起已被弃用。</p></li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-python-3-16">
<h3>计划在 Python 3.16 中移除<a class="headerlink" href="#pending-removal-in-python-3-16" title="Link to this heading">¶</a></h3>
<ul>
<li><p>导入系统：</p>
<ul class="simple">
<li><p>当设置 <a class="reference internal" href="../library/importlib.html#importlib.machinery.ModuleSpec.loader" title="importlib.machinery.ModuleSpec.loader"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__spec__.loader</span></code></a> 失败时在模块上设置 <a class="reference internal" href="../reference/datamodel.html#module.__loader__" title="module.__loader__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">__loader__</span></code></a> 的做法已被弃用。 在 Python 3.16 中，<code class="xref py py-attr docutils literal notranslate"><span class="pre">__loader__</span></code> 将不会再被设置或是被导入系统或标准库纳入考虑。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'u'</span></code> 格式代码 (<code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>) 自 Python 3.3 起已在文档中弃用并自 Python 3.13 起在运行时弃用。 对于 Unicode 字符请改用 <code class="docutils literal notranslate"><span class="pre">'w'</span></code> 格式代码 (<a class="reference internal" href="../c-api/unicode.html#c.Py_UCS4" title="Py_UCS4"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UCS4</span></code></a>)。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a>:</p>
<ul>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.iscoroutinefunction()</span></code> is deprecated
and will be removed in Python 3.16;
use <a class="reference internal" href="../library/inspect.html#inspect.iscoroutinefunction" title="inspect.iscoroutinefunction"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.iscoroutinefunction()</span></code></a> instead.
(Contributed by Jiahao Li and Kumar Aditya in <a class="reference external" href="https://github.com/python/cpython/issues/122875">gh-122875</a>.)</p></li>
<li><p><a class="reference internal" href="../library/asyncio.html#module-asyncio" title="asyncio: Asynchronous I/O."><code class="xref py py-mod docutils literal notranslate"><span class="pre">asyncio</span></code></a> policy system is deprecated and will be removed in Python 3.16.
In particular, the following classes and functions are deprecated:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.AbstractEventLoopPolicy" title="asyncio.AbstractEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.AbstractEventLoopPolicy</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.DefaultEventLoopPolicy" title="asyncio.DefaultEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.DefaultEventLoopPolicy</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsSelectorEventLoopPolicy" title="asyncio.WindowsSelectorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsSelectorEventLoopPolicy</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.WindowsProactorEventLoopPolicy" title="asyncio.WindowsProactorEventLoopPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.WindowsProactorEventLoopPolicy</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.get_event_loop_policy" title="asyncio.get_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.get_event_loop_policy()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-policy.html#asyncio.set_event_loop_policy" title="asyncio.set_event_loop_policy"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.set_event_loop_policy()</span></code></a></p></li>
<li><p><a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.set_event_loop" title="asyncio.set_event_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.set_event_loop()</span></code></a></p></li>
</ul>
<p>Users should use <a class="reference internal" href="../library/asyncio-runner.html#asyncio.run" title="asyncio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">asyncio.run()</span></code></a> or <a class="reference internal" href="../library/asyncio-runner.html#asyncio.Runner" title="asyncio.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.Runner</span></code></a> with
<em>loop_factory</em> to use the desired event loop implementation.</p>
<p>For example, to use <a class="reference internal" href="../library/asyncio-eventloop.html#asyncio.SelectorEventLoop" title="asyncio.SelectorEventLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">asyncio.SelectorEventLoop</span></code></a> on Windows:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">(),</span> <span class="n">loop_factory</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">SelectorEventLoop</span><span class="p">)</span>
</pre></div>
</div>
<p>(Contributed by Kumar Aditya in <a class="reference external" href="https://github.com/python/cpython/issues/127949">gh-127949</a>.)</p>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace."><code class="xref py py-mod docutils literal notranslate"><span class="pre">builtins</span></code></a>:</p>
<ul class="simple">
<li><p>对布尔类型 <code class="docutils literal notranslate"><span class="pre">~True</span></code> 或 <code class="docutils literal notranslate"><span class="pre">~False</span></code> 执行按位取反的操作自 Python 3.12 起已被弃用，因为它会产生奇怪和不直观的结果 (<code class="docutils literal notranslate"><span class="pre">-2</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code>)。 请改用 <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">x</span></code> 来对布尔值执行逻辑否操作。 对于需要对下层整数执行按位取反操作的少数场合，请显式地将其转换为 <code class="docutils literal notranslate"><span class="pre">int</span></code> (<code class="docutils literal notranslate"><span class="pre">~int(x)</span></code>)。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/functools.html#module-functools" title="functools: Higher-order functions and operations on callable objects."><code class="xref py py-mod docutils literal notranslate"><span class="pre">functools</span></code></a>:</p>
<ul class="simple">
<li><p>Calling the Python implementation of <a class="reference internal" href="../library/functools.html#functools.reduce" title="functools.reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.reduce()</span></code></a> with <em>function</em>
or <em>sequence</em> as keyword arguments has been deprecated since Python 3.14.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a>:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecError</span></code> 异常自 Python 3.14 起已被弃用。 它自 Python 3.4 起就未被 <code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code> 中的任何函数所使用，现在是 <a class="reference internal" href="../library/exceptions.html#RuntimeError" title="RuntimeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> 的一个别名。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/symtable.html#module-symtable" title="symtable: Interface to the compiler's internal symbol tables."><code class="xref py py-mod docutils literal notranslate"><span class="pre">symtable</span></code></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/symtable.html#symtable.Class.get_methods" title="symtable.Class.get_methods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Class.get_methods</span></code></a> 方法自 Python 3.14 起被弃用。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sys.html#module-sys" title="sys: Access system-specific parameters and functions."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/sys.html#sys._enablelegacywindowsfsencoding" title="sys._enablelegacywindowsfsencoding"><code class="xref py py-func docutils literal notranslate"><span class="pre">_enablelegacywindowsfsencoding()</span></code></a> 函数自 Python 3.13 起被弃用。 请改用 <span class="target" id="index-169"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONLEGACYWINDOWSFSENCODING"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONLEGACYWINDOWSFSENCODING</span></code></a> 环境变量。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sysconfig.html#module-sysconfig" title="sysconfig: Python's configuration information"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sysconfig</span></code></a>:</p>
<ul class="simple">
<li><p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.expand_makefile_vars()</span></code> function
has been deprecated since Python 3.14.
Use the <code class="docutils literal notranslate"><span class="pre">vars</span></code> argument of <a class="reference internal" href="../library/sysconfig.html#sysconfig.get_paths" title="sysconfig.get_paths"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.get_paths()</span></code></a> instead.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/tarfile.html#module-tarfile" title="tarfile: Read and write tar-format archive files."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tarfile</span></code></a>:</p>
<ul class="simple">
<li><p>未写入文档也未被使用的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">TarFile.tarfile</span></code> 属性自 Python 3.13 起被弃用。</p></li>
</ul>
</li>
</ul>
</section>
<section id="pending-removal-in-future-versions">
<h3>Pending removal in future versions<a class="headerlink" href="#pending-removal-in-future-versions" title="Link to this heading">¶</a></h3>
<p>以下API将会被移除，尽管具体时间还未确定。</p>
<ul class="simple">
<li><p><a class="reference internal" href="../library/argparse.html#module-argparse" title="argparse: Command-line option and argument parsing library."><code class="xref py py-mod docutils literal notranslate"><span class="pre">argparse</span></code></a>:</p>
<ul>
<li><p>Nesting argument groups and nesting mutually exclusive
groups are deprecated.</p></li>
<li><p>Passing the undocumented keyword argument <em>prefix_chars</em> to
<a class="reference internal" href="../library/argparse.html#argparse.ArgumentParser.add_argument_group" title="argparse.ArgumentParser.add_argument_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_argument_group()</span></code></a> is now
deprecated.</p></li>
<li><p>The <a class="reference internal" href="../library/argparse.html#argparse.FileType" title="argparse.FileType"><code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.FileType</span></code></a> type converter is deprecated.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/array.html#module-array" title="array: Space efficient arrays of uniformly typed numeric values."><code class="xref py py-mod docutils literal notranslate"><span class="pre">array</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">'u'</span></code> 格式代码 (<a class="reference external" href="https://github.com/python/cpython/issues/57281">gh-57281</a>)</p></li>
<li><p><a class="reference internal" href="../library/builtins.html#module-builtins" title="builtins: The module that provides the built-in namespace."><code class="xref py py-mod docutils literal notranslate"><span class="pre">builtins</span></code></a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bool(NotImplemented)</span></code>。</p></li>
<li><p>生成器: <code class="docutils literal notranslate"><span class="pre">throw(type,</span> <span class="pre">exc,</span> <span class="pre">tb)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">athrow(type,</span> <span class="pre">exc,</span> <span class="pre">tb)</span></code> 签名已被弃用：请改用 <code class="docutils literal notranslate"><span class="pre">throw(exc)</span></code> 和 <code class="docutils literal notranslate"><span class="pre">athrow(exc)</span></code>，即单参数签名。</p></li>
<li><p>目前 Python 接受数字类字面值后面紧跟关键字的写法，例如 <code class="docutils literal notranslate"><span class="pre">0in</span> <span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">1or</span> <span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">0if</span> <span class="pre">1else</span> <span class="pre">2</span></code>。 它允许像 <code class="docutils literal notranslate"><span class="pre">[0x1for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code> 这样令人困惑且有歧义的表达式 (它可以被解读为 <code class="docutils literal notranslate"><span class="pre">[0x1</span> <span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">[0x1f</span> <span class="pre">or</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">y]</span></code>)。 如果数字类字面值后面紧跟关键字 <a class="reference internal" href="../reference/expressions.html#and"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">and</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#else"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">else</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#for"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">for</span></code></a>, <a class="reference internal" href="../reference/compound_stmts.html#if"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">if</span></code></a>, <a class="reference internal" href="../reference/expressions.html#in"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">in</span></code></a>, <a class="reference internal" href="../reference/expressions.html#is"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">is</span></code></a> 和 <a class="reference internal" href="../reference/expressions.html#or"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">or</span></code></a> 中的一个将会引发语法警告。 在未来的版本中它将改为语法错误。 (<a class="reference external" href="https://github.com/python/cpython/issues/87999">gh-87999</a>)</p></li>
<li><p>对 <code class="docutils literal notranslate"><span class="pre">__index__()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">__int__()</span></code> 方法返回非 int 类型的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> 的子类的实例。</p></li>
<li><p>对 <code class="docutils literal notranslate"><span class="pre">__float__()</span></code> 方法返回 <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 的子类的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#float" title="float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> 的实例。</p></li>
<li><p>对 <code class="docutils literal notranslate"><span class="pre">__complex__()</span></code> 方法返回 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 的子类的支持：将要求这些方法必须返回 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a> 的实例。</p></li>
<li><p>将 <code class="docutils literal notranslate"><span class="pre">int()</span></code> 委托给 <code class="docutils literal notranslate"><span class="pre">__trunc__()</span></code> 方法。</p></li>
<li><p>传入一个复数作为 <a class="reference internal" href="../library/functions.html#complex" title="complex"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex()</span></code></a> 构造器中的 <em>real</em> 或 <em>imag</em> 参数的做法现在已被弃用；它应当仅作为单个位置参数被传入。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/109218">gh-109218</a> 中贡献。）.)</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/calendar.html#module-calendar" title="calendar: Functions for working with calendars, including some emulation of the Unix cal program."><code class="xref py py-mod docutils literal notranslate"><span class="pre">calendar</span></code></a>: <code class="docutils literal notranslate"><span class="pre">calendar.January</span></code> 和 <code class="docutils literal notranslate"><span class="pre">calendar.February</span></code> 常量已被弃用并由 <a class="reference internal" href="../library/calendar.html#calendar.JANUARY" title="calendar.JANUARY"><code class="xref py py-data docutils literal notranslate"><span class="pre">calendar.JANUARY</span></code></a> 和 <a class="reference internal" href="../library/calendar.html#calendar.FEBRUARY" title="calendar.FEBRUARY"><code class="xref py py-data docutils literal notranslate"><span class="pre">calendar.FEBRUARY</span></code></a> 替代。 （由 Prince Roshan 在 <a class="reference external" href="https://github.com/python/cpython/issues/103636">gh-103636</a> 中贡献。）</p></li>
<li><p><a class="reference internal" href="../reference/datamodel.html#codeobject.co_lnotab" title="codeobject.co_lnotab"><code class="xref py py-attr docutils literal notranslate"><span class="pre">codeobject.co_lnotab</span></code></a>: 改用 <a class="reference internal" href="../reference/datamodel.html#codeobject.co_lines" title="codeobject.co_lines"><code class="xref py py-meth docutils literal notranslate"><span class="pre">codeobject.co_lines()</span></code></a> 方法。</p></li>
<li><p><a class="reference internal" href="../library/datetime.html#module-datetime" title="datetime: Basic date and time types."><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a>:</p>
<ul>
<li><p><a class="reference internal" href="../library/datetime.html#datetime.datetime.utcnow" title="datetime.datetime.utcnow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utcnow()</span></code></a>: 使用 <code class="docutils literal notranslate"><span class="pre">datetime.datetime.now(tz=datetime.UTC)</span></code>。</p></li>
<li><p><a class="reference internal" href="../library/datetime.html#datetime.datetime.utcfromtimestamp" title="datetime.datetime.utcfromtimestamp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">utcfromtimestamp()</span></code></a>: 使用 <code class="docutils literal notranslate"><span class="pre">datetime.datetime.fromtimestamp(timestamp,</span> <span class="pre">tz=datetime.UTC)</span></code>。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/gettext.html#module-gettext" title="gettext: Multilingual internationalization services."><code class="xref py py-mod docutils literal notranslate"><span class="pre">gettext</span></code></a>: 复数值必须是一个整数。</p></li>
<li><p><a class="reference internal" href="../library/importlib.html#module-importlib" title="importlib: The implementation of the import machinery."><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib</span></code></a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">load_module()</span></code> 方法：改用 <code class="docutils literal notranslate"><span class="pre">exec_module()</span></code>。</p></li>
<li><p><a class="reference internal" href="../library/importlib.html#importlib.util.cache_from_source" title="importlib.util.cache_from_source"><code class="xref py py-func docutils literal notranslate"><span class="pre">cache_from_source()</span></code></a> <em>debug_override</em> 形参已被弃用：改用 <em>optimization</em> 形能耐。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/importlib.metadata.html#module-importlib.metadata" title="importlib.metadata: Accessing package metadata"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importlib.metadata</span></code></a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">EntryPoints</span></code> 元组接口。</p></li>
<li><p>返回值中隐式的 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/logging.html#module-logging" title="logging: Flexible event logging system for applications."><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a>: <code class="docutils literal notranslate"><span class="pre">warn()</span></code> 方法自 Python 3.3 起已被弃用，请改用 <a class="reference internal" href="../library/logging.html#logging.warning" title="logging.warning"><code class="xref py py-meth docutils literal notranslate"><span class="pre">warning()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../library/mailbox.html#module-mailbox" title="mailbox: Manipulate mailboxes in various formats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mailbox</span></code></a>: 对 StringIO 输入和文本模式的使用已被弃用，改用 BytesIO 和二进制模式。</p></li>
<li><p><a class="reference internal" href="../library/os.html#module-os" title="os: Miscellaneous operating system interfaces."><code class="xref py py-mod docutils literal notranslate"><span class="pre">os</span></code></a>: 在多线程的进程中调用 <a class="reference internal" href="../library/os.html#os.register_at_fork" title="os.register_at_fork"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.register_at_fork()</span></code></a>。</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pydoc.ErrorDuringImport</span></code>: 使用元组值作为 <em>exc_info</em> 形参的做法已被弃用，应使用异常实例。</p></li>
<li><p><a class="reference internal" href="../library/re.html#module-re" title="re: Regular expression operations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">re</span></code></a>: 现在对于正则表达式中的数字分组引用和分组名称将应用更严格的规则。 现在只接受 ASCII 数字序列作为数字引用。 字节串模式和替换字符串中的分组名称现在只能包含 ASCII 字母和数字以及下划线。 （由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/91760">gh-91760</a> 中贡献。）</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_compile</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_constants</span></code> 和 <code class="xref py py-mod docutils literal notranslate"><span class="pre">sre_parse</span></code> 模块。</p></li>
<li><p><a class="reference internal" href="../library/shutil.html#module-shutil" title="shutil: High-level file operations, including copying."><code class="xref py py-mod docutils literal notranslate"><span class="pre">shutil</span></code></a>: <a class="reference internal" href="../library/shutil.html#shutil.rmtree" title="shutil.rmtree"><code class="xref py py-func docutils literal notranslate"><span class="pre">rmtree()</span></code></a> 的 <em>onerror</em> 形参在 Python 3.12 中已被弃用；请改用 <em>onexc</em> 形参。</p></li>
<li><p><a class="reference internal" href="../library/ssl.html#module-ssl" title="ssl: TLS/SSL wrapper for socket objects"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> 选项和协议：</p>
<ul>
<li><p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a> 不带 protocol 参数的做法已被弃用。</p></li>
<li><p><a class="reference internal" href="../library/ssl.html#ssl.SSLContext" title="ssl.SSLContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ssl.SSLContext</span></code></a>: <a class="reference internal" href="../library/ssl.html#ssl.SSLContext.set_npn_protocols" title="ssl.SSLContext.set_npn_protocols"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_npn_protocols()</span></code></a> 和 <code class="xref py py-meth docutils literal notranslate"><span class="pre">selected_npn_protocol()</span></code> 已被弃用：请改用 ALPN.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.OP_NO_SSL*</span></code> 选项</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.OP_NO_TLS*</span></code> 选项</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_SSLv3</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLS</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1_1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.PROTOCOL_TLSv1_2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.SSLv3</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.TLSv1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ssl.TLSVersion.TLSv1_1</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/sysconfig.html#sysconfig.is_python_build" title="sysconfig.is_python_build"><code class="xref py py-func docutils literal notranslate"><span class="pre">sysconfig.is_python_build()</span></code></a> <em>check_home</em> 形参已被弃用并会被忽略。</p></li>
<li><p><a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a> 的方法：</p>
<ul>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Condition.notifyAll()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.Condition.notify_all" title="threading.Condition.notify_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">notify_all()</span></code></a>。</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Event.isSet()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.Event.is_set" title="threading.Event.is_set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_set()</span></code></a>。</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.isDaemon()</span></code>, <a class="reference internal" href="../library/threading.html#threading.Thread.setDaemon" title="threading.Thread.setDaemon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.setDaemon()</span></code></a>: 使用 <a class="reference internal" href="../library/threading.html#threading.Thread.daemon" title="threading.Thread.daemon"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threading.Thread.daemon</span></code></a> 属性。</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.getName()</span></code>, <a class="reference internal" href="../library/threading.html#threading.Thread.setName" title="threading.Thread.setName"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.Thread.setName()</span></code></a>: 使用 <a class="reference internal" href="../library/threading.html#threading.Thread.name" title="threading.Thread.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">threading.Thread.name</span></code></a> 属性。</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.currentThread()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.current_thread" title="threading.current_thread"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.current_thread()</span></code></a>。</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.activeCount()</span></code>: 使用 <a class="reference internal" href="../library/threading.html#threading.active_count" title="threading.active_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">threading.active_count()</span></code></a>。</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/typing.html#typing.Text" title="typing.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Text</span></code></a> (<a class="reference external" href="https://github.com/python/cpython/issues/92332">gh-92332</a>)。</p></li>
<li><p><a class="reference internal" href="../library/unittest.html#unittest.IsolatedAsyncioTestCase" title="unittest.IsolatedAsyncioTestCase"><code class="xref py py-class docutils literal notranslate"><span class="pre">unittest.IsolatedAsyncioTestCase</span></code></a>: 从测试用例返回不为 <code class="docutils literal notranslate"><span class="pre">None</span></code> 的值的做法已被弃用。</p></li>
<li><p><a class="reference internal" href="../library/urllib.parse.html#module-urllib.parse" title="urllib.parse: Parse URLs into or assemble them from components."><code class="xref py py-mod docutils literal notranslate"><span class="pre">urllib.parse</span></code></a> 函数已被弃用：改用 <a class="reference internal" href="../library/urllib.parse.html#urllib.parse.urlparse" title="urllib.parse.urlparse"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlparse()</span></code></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">splitattr()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splithost()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splitnport()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splitpasswd()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splitport()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splitquery()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splittag()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splittype()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splituser()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">splitvalue()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_bytes()</span></code></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="../library/wsgiref.html#module-wsgiref" title="wsgiref: WSGI Utilities and Reference Implementation."><code class="xref py py-mod docutils literal notranslate"><span class="pre">wsgiref</span></code></a>: <code class="docutils literal notranslate"><span class="pre">SimpleHandler.stdout.write()</span></code> 不应执行部分写入。</p></li>
<li><p><a class="reference internal" href="../library/xml.etree.elementtree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree: Implementation of the ElementTree API."><code class="xref py py-mod docutils literal notranslate"><span class="pre">xml.etree.ElementTree</span></code></a>: 对 <a class="reference internal" href="../library/xml.etree.elementtree.html#xml.etree.ElementTree.Element" title="xml.etree.ElementTree.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a> 的真值测试已被弃用。 在未来的发布版中它将始终返回 <code class="docutils literal notranslate"><span class="pre">True</span></code>。 建议改用显式的 <code class="docutils literal notranslate"><span class="pre">len(elem)</span></code> 或 <code class="docutils literal notranslate"><span class="pre">elem</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code> 测试。</p></li>
<li><p><a class="reference internal" href="../library/zipimport.html#zipimport.zipimporter.load_module" title="zipimport.zipimporter.load_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">zipimport.zipimporter.load_module()</span></code></a> 已被弃用：请改用 <a class="reference internal" href="../library/zipimport.html#zipimport.zipimporter.exec_module" title="zipimport.zipimporter.exec_module"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exec_module()</span></code></a>。</p></li>
</ul>
</section>
</section>
<section id="cpython-bytecode-changes">
<h2>CPython 字节码的变化<a class="headerlink" href="#cpython-bytecode-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>The oparg of <a class="reference internal" href="../library/dis.html#opcode-YIELD_VALUE"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">YIELD_VALUE</span></code></a> is now
<code class="docutils literal notranslate"><span class="pre">1</span></code> if the yield is part of a yield-from or await, and <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
The oparg of <a class="reference internal" href="../library/dis.html#opcode-RESUME"><code class="xref std std-opcode docutils literal notranslate"><span class="pre">RESUME</span></code></a> was changed to add a bit indicating
if the except-depth is 1, which is needed to optimize closing of generators.
(Contributed by Irit Katriel in <a class="reference external" href="https://github.com/python/cpython/issues/111354">gh-111354</a>.)</p></li>
</ul>
</section>
<section id="c-api-changes">
<h2>C API 的变化<a class="headerlink" href="#c-api-changes" title="Link to this heading">¶</a></h2>
<section id="id7">
<h3>新的特性<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<ul>
<li><p>增加 <a class="reference internal" href="../c-api/monitoring.html#c-api-monitoring"><span class="std std-ref">PyMonitoring C API</span></a> 用于生成 <span class="target" id="index-170"></span><a class="pep reference external" href="https://peps.python.org/pep-0669/"><strong>PEP 669</strong></a> 监控事件：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoringState" title="PyMonitoringState"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyMonitoringState</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyStartEvent" title="PyMonitoring_FirePyStartEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyStartEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyResumeEvent" title="PyMonitoring_FirePyResumeEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyResumeEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyReturnEvent" title="PyMonitoring_FirePyReturnEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyReturnEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyYieldEvent" title="PyMonitoring_FirePyYieldEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyYieldEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireCallEvent" title="PyMonitoring_FireCallEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireCallEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireLineEvent" title="PyMonitoring_FireLineEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireLineEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireJumpEvent" title="PyMonitoring_FireJumpEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireJumpEvent()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PyMonitoring_FireBranchEvent</span></code></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireCReturnEvent" title="PyMonitoring_FireCReturnEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireCReturnEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyThrowEvent" title="PyMonitoring_FirePyThrowEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyThrowEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireRaiseEvent" title="PyMonitoring_FireRaiseEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireRaiseEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireCRaiseEvent" title="PyMonitoring_FireCRaiseEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireCRaiseEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireReraiseEvent" title="PyMonitoring_FireReraiseEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireReraiseEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireExceptionHandledEvent" title="PyMonitoring_FireExceptionHandledEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireExceptionHandledEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FirePyUnwindEvent" title="PyMonitoring_FirePyUnwindEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FirePyUnwindEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_FireStopIterationEvent" title="PyMonitoring_FireStopIterationEvent"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_FireStopIterationEvent()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_EnterScope" title="PyMonitoring_EnterScope"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_EnterScope()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/monitoring.html#c.PyMonitoring_ExitScope" title="PyMonitoring_ExitScope"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMonitoring_ExitScope()</span></code></a></p></li>
</ul>
<p>（由 Irit Katriel 在 <a class="reference external" href="https://github.com/python/cpython/issues/111997">gh-111997</a> 中贡献。）</p>
</li>
<li><p>增加了 <a class="reference internal" href="../c-api/init.html#c.PyMutex" title="PyMutex"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyMutex</span></code></a>，它是占用一个字节的轻量级互斥锁，以及新的 <a class="reference internal" href="../c-api/init.html#c.PyMutex_Lock" title="PyMutex_Lock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMutex_Lock()</span></code></a> 和 <a class="reference internal" href="../c-api/init.html#c.PyMutex_Unlock" title="PyMutex_Unlock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMutex_Unlock()</span></code></a> 函数。 如果操作需要阻塞则 <code class="xref c c-func docutils literal notranslate"><span class="pre">PyMutex_Lock()</span></code> 将释放 (当前持有的) <a class="reference internal" href="../glossary.html#term-GIL"><span class="xref std std-term">GIL</span></a>。 （由 Sam Gross 在 <a class="reference external" href="https://github.com/python/cpython/issues/108724">gh-108724</a> 中贡献。）</p></li>
<li><p>增加了 <a class="reference internal" href="../c-api/time.html#c-api-time"><span class="std std-ref">PyTime C API</span></a> 以提供对系统时钟的访问：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_t" title="PyTime_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyTime_t</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_MIN" title="PyTime_MIN"><code class="xref c c-var docutils literal notranslate"><span class="pre">PyTime_MIN</span></code></a> 和 <a class="reference internal" href="../c-api/time.html#c.PyTime_MAX" title="PyTime_MAX"><code class="xref c c-var docutils literal notranslate"><span class="pre">PyTime_MAX</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_AsSecondsDouble" title="PyTime_AsSecondsDouble"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_AsSecondsDouble()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_Monotonic" title="PyTime_Monotonic"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_Monotonic()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_MonotonicRaw" title="PyTime_MonotonicRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_MonotonicRaw()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_PerfCounter" title="PyTime_PerfCounter"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_PerfCounter()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_PerfCounterRaw" title="PyTime_PerfCounterRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_PerfCounterRaw()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_Time" title="PyTime_Time"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_Time()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/time.html#c.PyTime_TimeRaw" title="PyTime_TimeRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_TimeRaw()</span></code></a>。</p></li>
</ul>
<p>（由 Victor Stinner 和 Petr Viktorin 在 <a class="reference external" href="https://github.com/python/cpython/issues/110850">gh-110850</a> 中贡献。）</p>
</li>
<li><p>Add the <a class="reference internal" href="../c-api/dict.html#c.PyDict_ContainsString" title="PyDict_ContainsString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_ContainsString()</span></code></a> function
with the same behavior as <a class="reference internal" href="../c-api/dict.html#c.PyDict_Contains" title="PyDict_Contains"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_Contains()</span></code></a>,
but <em>key</em> is specified as a <span class="c-expr sig sig-inline c"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="p">*</span></span> UTF-8 encoded bytes string,
rather than a <span class="c-expr sig sig-inline c"><a class="reference internal" href="../c-api/structures.html#c.PyObject" title="PyObject"><span class="n">PyObject</span></a><span class="p">*</span></span>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108314">gh-108314</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemRef" title="PyDict_GetItemRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemRef()</span></code></a> and <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemStringRef" title="PyDict_GetItemStringRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemStringRef()</span></code></a>
functions,
which behave similarly to <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemWithError" title="PyDict_GetItemWithError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemWithError()</span></code></a>,
but return a  <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> instead of a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
Moreover, these functions return <code class="docutils literal notranslate"><span class="pre">-1</span></code> on error,
removing the need to check <code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Occurred()</span></code>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/106004">gh-106004</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/dict.html#c.PyDict_SetDefaultRef" title="PyDict_SetDefaultRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_SetDefaultRef()</span></code></a> function,
which behaves similarly to <a class="reference internal" href="../c-api/dict.html#c.PyDict_SetDefault" title="PyDict_SetDefault"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_SetDefault()</span></code></a>,
but returns a <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> instead of a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
This function returns <code class="docutils literal notranslate"><span class="pre">-1</span></code> on error,
<code class="docutils literal notranslate"><span class="pre">0</span></code> on insertion,
and <code class="docutils literal notranslate"><span class="pre">1</span></code> if the key was already present in the dictionary.
(Contributed by Sam Gross in <a class="reference external" href="https://github.com/python/cpython/issues/112066">gh-112066</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/dict.html#c.PyDict_Pop" title="PyDict_Pop"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_Pop()</span></code></a> and <a class="reference internal" href="../c-api/dict.html#c.PyDict_PopString" title="PyDict_PopString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_PopString()</span></code></a> functions
to remove a key from a dictionary and optionally return the removed value.
This is similar to <a class="reference internal" href="../library/stdtypes.html#dict.pop" title="dict.pop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dict.pop()</span></code></a>,
though there is no default value,
and <a class="reference internal" href="../library/exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a> is not raised for missing keys.
(Contributed by Stefan Behnel and Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/111262">gh-111262</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_GetOptionalItem" title="PyMapping_GetOptionalItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_GetOptionalItem()</span></code></a>
and <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_GetOptionalItemString" title="PyMapping_GetOptionalItemString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_GetOptionalItemString()</span></code></a> functions
as alternatives to <a class="reference internal" href="../c-api/object.html#c.PyObject_GetItem" title="PyObject_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetItem()</span></code></a>
and <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_GetItemString" title="PyMapping_GetItemString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_GetItemString()</span></code></a> respectively.
The new functions do not raise <a class="reference internal" href="../library/exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a>
if the requested key is missing from the mapping.
These variants are more convenient and faster
if a missing key should not be treated as a failure.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/106307">gh-106307</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/object.html#c.PyObject_GetOptionalAttr" title="PyObject_GetOptionalAttr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetOptionalAttr()</span></code></a>
and <a class="reference internal" href="../c-api/object.html#c.PyObject_GetOptionalAttrString" title="PyObject_GetOptionalAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetOptionalAttrString()</span></code></a> functions
as alternatives to  <a class="reference internal" href="../c-api/object.html#c.PyObject_GetAttr" title="PyObject_GetAttr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetAttr()</span></code></a>
and <a class="reference internal" href="../c-api/object.html#c.PyObject_GetAttrString" title="PyObject_GetAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetAttrString()</span></code></a> respectively.
The new functions do not raise <a class="reference internal" href="../library/exceptions.html#AttributeError" title="AttributeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code></a>
if the requested attribute is not found on the object.
These variants are more convenient and faster
if the missing attribute should not be treated as a failure.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/106521">gh-106521</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_FormatUnraisable" title="PyErr_FormatUnraisable"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_FormatUnraisable()</span></code></a> function
as an extension to <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_WriteUnraisable" title="PyErr_WriteUnraisable"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_WriteUnraisable()</span></code></a>
that allows customizing the warning message.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/108082">gh-108082</a>.)</p></li>
<li><p>Add new functions that return a <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> instead of
a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a> for frame locals, globals, and builtins,
as part of <a class="reference internal" href="#whatsnew313-locals-semantics"><span class="std std-ref">PEP 667</span></a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetFrameBuiltins" title="PyEval_GetFrameBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetFrameBuiltins()</span></code></a> 替代 <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetBuiltins" title="PyEval_GetBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetBuiltins()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetFrameGlobals" title="PyEval_GetFrameGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetFrameGlobals()</span></code></a> 替代 <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetGlobals" title="PyEval_GetGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetGlobals()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetFrameLocals" title="PyEval_GetFrameLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetFrameLocals()</span></code></a> 替代 <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetLocals" title="PyEval_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetLocals()</span></code></a></p></li>
</ul>
<p>（由 Mark Shannon 和 Tian Gao 在 <a class="reference external" href="https://github.com/python/cpython/issues/74929">gh-74929</a> 中贡献。）</p>
</li>
<li><p>Add the <a class="reference internal" href="../c-api/object.html#c.Py_GetConstant" title="Py_GetConstant"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetConstant()</span></code></a> and <a class="reference internal" href="../c-api/object.html#c.Py_GetConstantBorrowed" title="Py_GetConstantBorrowed"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetConstantBorrowed()</span></code></a>
functions to get <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong</span></a>
or <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed</span></a> references to constants.
For example, <code class="docutils literal notranslate"><span class="pre">Py_GetConstant(Py_CONSTANT_ZERO)</span></code> returns a strong reference
to the constant zero.
(Contributed by Victor  Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/115754">gh-115754</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/import.html#c.PyImport_AddModuleRef" title="PyImport_AddModuleRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_AddModuleRef()</span></code></a> function
as a replacement for <a class="reference internal" href="../c-api/import.html#c.PyImport_AddModule" title="PyImport_AddModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_AddModule()</span></code></a>
that returns a <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> instead of a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105922">gh-105922</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/init.html#c.Py_IsFinalizing" title="Py_IsFinalizing"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_IsFinalizing()</span></code></a> function to check
whether the main Python interpreter is
<a class="reference internal" href="../glossary.html#term-interpreter-shutdown"><span class="xref std std-term">shutting down</span></a>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108014">gh-108014</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/list.html#c.PyList_GetItemRef" title="PyList_GetItemRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_GetItemRef()</span></code></a> function
as a replacement for <a class="reference internal" href="../c-api/list.html#c.PyList_GetItem" title="PyList_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_GetItem()</span></code></a>
that returns a <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> instead of a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
(Contributed by Sam Gross in <a class="reference external" href="https://github.com/python/cpython/issues/114329">gh-114329</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/list.html#c.PyList_Extend" title="PyList_Extend"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_Extend()</span></code></a> and <a class="reference internal" href="../c-api/list.html#c.PyList_Clear" title="PyList_Clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_Clear()</span></code></a> functions,
mirroring the Python <code class="xref py py-meth docutils literal notranslate"><span class="pre">list.extend()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">list.clear()</span></code> methods.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/111138">gh-111138</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/long.html#c.PyLong_AsInt" title="PyLong_AsInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsInt()</span></code></a> function.
It behaves similarly to <a class="reference internal" href="../c-api/long.html#c.PyLong_AsLong" title="PyLong_AsLong"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsLong()</span></code></a>,
but stores the result in a C <span class="c-expr sig sig-inline c"><span class="kt">int</span></span> instead of a C <span class="c-expr sig sig-inline c"><span class="kt">long</span></span>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108014">gh-108014</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/long.html#c.PyLong_AsNativeBytes" title="PyLong_AsNativeBytes"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsNativeBytes()</span></code></a>, <a class="reference internal" href="../c-api/long.html#c.PyLong_FromNativeBytes" title="PyLong_FromNativeBytes"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromNativeBytes()</span></code></a>,
and <a class="reference internal" href="../c-api/long.html#c.PyLong_FromUnsignedNativeBytes" title="PyLong_FromUnsignedNativeBytes"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_FromUnsignedNativeBytes()</span></code></a> functions
to simplify converting between native integer types
and Python <a class="reference internal" href="../library/functions.html#int" title="int"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> objects.
(Contributed by Steve Dower in <a class="reference external" href="https://github.com/python/cpython/issues/111140">gh-111140</a>.)</p></li>
<li><p>Add <a class="reference internal" href="../c-api/module.html#c.PyModule_Add" title="PyModule_Add"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_Add()</span></code></a> function, which is similar to
<a class="reference internal" href="../c-api/module.html#c.PyModule_AddObjectRef" title="PyModule_AddObjectRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_AddObjectRef()</span></code></a> and <a class="reference internal" href="../c-api/module.html#c.PyModule_AddObject" title="PyModule_AddObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_AddObject()</span></code></a>,
but always steals a reference to the value.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/86493">gh-86493</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/hash.html#c.PyObject_GenericHash" title="PyObject_GenericHash"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GenericHash()</span></code></a> function
that implements the default hashing function of a Python object.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/113024">gh-113024</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/hash.html#c.Py_HashPointer" title="Py_HashPointer"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_HashPointer()</span></code></a> function to hash a raw pointer.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/111545">gh-111545</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/object.html#c.PyObject_VisitManagedDict" title="PyObject_VisitManagedDict"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_VisitManagedDict()</span></code></a> and
<a class="reference internal" href="../c-api/object.html#c.PyObject_ClearManagedDict" title="PyObject_ClearManagedDict"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_ClearManagedDict()</span></code></a> functions.
which must be called by the traverse and clear functions of a type using
the <a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_MANAGED_DICT" title="Py_TPFLAGS_MANAGED_DICT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_TPFLAGS_MANAGED_DICT</span></code></a> flag.
The <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> can be used to
use these functions with Python 3.11 and 3.12.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/107073">gh-107073</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/init.html#c.PyRefTracer_SetTracer" title="PyRefTracer_SetTracer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRefTracer_SetTracer()</span></code></a>
and <a class="reference internal" href="../c-api/init.html#c.PyRefTracer_GetTracer" title="PyRefTracer_GetTracer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyRefTracer_GetTracer()</span></code></a> functions,
which enable tracking object creation and destruction
in the same way that the <a class="reference internal" href="../library/tracemalloc.html#module-tracemalloc" title="tracemalloc: Trace memory allocations."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tracemalloc</span></code></a> module does.
(Contributed by Pablo Galindo in <a class="reference external" href="https://github.com/python/cpython/issues/93502">gh-93502</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/sys.html#c.PySys_AuditTuple" title="PySys_AuditTuple"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AuditTuple()</span></code></a> function
as an alternative to <a class="reference internal" href="../c-api/sys.html#c.PySys_Audit" title="PySys_Audit"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_Audit()</span></code></a>
that takes event arguments as a Python <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> object.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/85283">gh-85283</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/init.html#c.PyThreadState_GetUnchecked" title="PyThreadState_GetUnchecked"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_GetUnchecked()</span></code></a> function
as an alternative to <a class="reference internal" href="../c-api/init.html#c.PyThreadState_Get" title="PyThreadState_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_Get()</span></code></a>
that doesn't kill the process with a fatal error if it is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.
The caller is responsible for checking if the result is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108867">gh-108867</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/type.html#c.PyType_GetFullyQualifiedName" title="PyType_GetFullyQualifiedName"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetFullyQualifiedName()</span></code></a> function
to get the type's fully qualified name.
The module name is prepended if <a class="reference internal" href="../reference/datamodel.html#type.__module__" title="type.__module__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type.__module__</span></code></a> is
a string and is not equal to either <code class="docutils literal notranslate"><span class="pre">'builtins'</span></code> or <code class="docutils literal notranslate"><span class="pre">'__main__'</span></code>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/111696">gh-111696</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/type.html#c.PyType_GetModuleName" title="PyType_GetModuleName"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetModuleName()</span></code></a> function
to get the type's module name. This is equivalent to getting the
<a class="reference internal" href="../reference/datamodel.html#type.__module__" title="type.__module__"><code class="xref py py-attr docutils literal notranslate"><span class="pre">type.__module__</span></code></a> attribute.
(Contributed by Eric Snow and Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/111696">gh-111696</a>.)</p></li>
<li><p>Add the <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_EqualToUTF8AndSize" title="PyUnicode_EqualToUTF8AndSize"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EqualToUTF8AndSize()</span></code></a>
and <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_EqualToUTF8" title="PyUnicode_EqualToUTF8"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_EqualToUTF8()</span></code></a> functions
to compare a Unicode object with a <span class="c-expr sig sig-inline c"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="p">*</span></span> UTF-8 encoded string
and <code class="docutils literal notranslate"><span class="pre">1</span></code> if they are equal or <code class="docutils literal notranslate"><span class="pre">0</span></code> otherwise.
These functions do not raise exceptions.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/110289">gh-110289</a>.)</p></li>
<li><p>增加 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a> 函数作为 <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetObject" title="PyWeakref_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetObject()</span></code></a> 的替代，它将返回一个 <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a> 或是在引用对象不再存活时返回 <code class="docutils literal notranslate"><span class="pre">NULL</span></code>。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/105927">gh-105927</a> 中贡献。）</p></li>
<li><p>增加了静默地忽略错误的函数的已修正变体形式：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttrWithError" title="PyObject_HasAttrWithError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttrWithError()</span></code></a> 替代 <a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttr" title="PyObject_HasAttr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttr()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttrStringWithError" title="PyObject_HasAttrStringWithError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttrStringWithError()</span></code></a> 替代 <a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttrString" title="PyObject_HasAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttrString()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKeyWithError" title="PyMapping_HasKeyWithError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKeyWithError()</span></code></a> 替代 <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKey" title="PyMapping_HasKey"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKey()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKeyStringWithError" title="PyMapping_HasKeyStringWithError"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKeyStringWithError()</span></code></a> 替代 <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKeyString" title="PyMapping_HasKeyString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKeyString()</span></code></a>。</p></li>
</ul>
<p>这些新函数将返回 <code class="docutils literal notranslate"><span class="pre">-1</span></code> 表示错误而返回标准的 <code class="docutils literal notranslate"><span class="pre">1</span></code> 表示真值以及 <code class="docutils literal notranslate"><span class="pre">0</span></code> 表示假值。</p>
<p>（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/108511">gh-108511</a> 中贡献。）</p>
</li>
</ul>
</section>
<section id="changed-c-apis">
<h3>被改变的 C API<a class="headerlink" href="#changed-c-apis" title="Link to this heading">¶</a></h3>
<ul>
<li><p>The <em>keywords</em> parameter of <a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTupleAndKeywords" title="PyArg_ParseTupleAndKeywords"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyArg_ParseTupleAndKeywords()</span></code></a>
and <a class="reference internal" href="../c-api/arg.html#c.PyArg_VaParseTupleAndKeywords" title="PyArg_VaParseTupleAndKeywords"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyArg_VaParseTupleAndKeywords()</span></code></a>
now has type <span class="c-expr sig sig-inline c"><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="k">const</span><span class="p">*</span></span> in C
and <span class="c-expr sig sig-inline c"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="k">const</span><span class="p">*</span></span> in C++,
instead of <span class="c-expr sig sig-inline c"><span class="kt">char</span><span class="p">*</span><span class="p">*</span></span>.
In C++, this makes these functions compatible with arguments
of type <span class="c-expr sig sig-inline c"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="k">const</span><span class="p">*</span></span>, <span class="c-expr sig sig-inline c"><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="p">*</span><span class="p">*</span></span>,
or <span class="c-expr sig sig-inline c"><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="k">const</span><span class="p">*</span></span> without an explicit type cast.
In C, the functions only support arguments of type <span class="c-expr sig sig-inline c"><span class="kt">char</span><span class="w"> </span><span class="p">*</span><span class="k">const</span><span class="p">*</span></span>.
This can be overridden with the <a class="reference internal" href="../c-api/arg.html#c.PY_CXX_CONST" title="PY_CXX_CONST"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PY_CXX_CONST</span></code></a> macro.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/65210">gh-65210</a>.)</p></li>
<li><p><a class="reference internal" href="../c-api/arg.html#c.PyArg_ParseTupleAndKeywords" title="PyArg_ParseTupleAndKeywords"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyArg_ParseTupleAndKeywords()</span></code></a> now supports
non-ASCII keyword parameter names.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/110815">gh-110815</a>.)</p></li>
<li><p>The <code class="xref c c-func docutils literal notranslate"><span class="pre">PyCode_GetFirstFree()</span></code> function is now unstable API
and is now named <a class="reference internal" href="../c-api/code.html#c.PyUnstable_Code_GetFirstFree" title="PyUnstable_Code_GetFirstFree"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnstable_Code_GetFirstFree()</span></code></a>.
(Contributed by Bogdan Romanyuk in <a class="reference external" href="https://github.com/python/cpython/issues/115781">gh-115781</a>.)</p></li>
<li><p>The <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItem" title="PyDict_GetItem"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItem()</span></code></a>, <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemString" title="PyDict_GetItemString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemString()</span></code></a>,
<a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKey" title="PyMapping_HasKey"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKey()</span></code></a>, <a class="reference internal" href="../c-api/mapping.html#c.PyMapping_HasKeyString" title="PyMapping_HasKeyString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMapping_HasKeyString()</span></code></a>,
<a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttr" title="PyObject_HasAttr"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttr()</span></code></a>, <a class="reference internal" href="../c-api/object.html#c.PyObject_HasAttrString" title="PyObject_HasAttrString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_HasAttrString()</span></code></a>,
and <a class="reference internal" href="../c-api/sys.html#c.PySys_GetObject" title="PySys_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_GetObject()</span></code></a> functions,
each of which clears all errors which occurred when calling them
now reports these errors using <a class="reference internal" href="../library/sys.html#sys.unraisablehook" title="sys.unraisablehook"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.unraisablehook()</span></code></a>.
You may replace them with other functions as recommended in the documentation.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/106672">gh-106672</a>.)</p></li>
<li><p>为 <a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_FromFormat" title="PyUnicode_FromFormat"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_FromFormat()</span></code></a> 增加了 <code class="docutils literal notranslate"><span class="pre">%T</span></code>, <code class="docutils literal notranslate"><span class="pre">%#T</span></code>, <code class="docutils literal notranslate"><span class="pre">%N</span></code> 和 <code class="docutils literal notranslate"><span class="pre">%#N</span></code> 格式的支持：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%T</span></code>: 获取一个对象类型的完整限定名称</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%#T</span></code>: 同上，但使用冒号作为分隔符</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%N</span></code>: 获取一个类型的完整限定名称</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%#N</span></code>: 同上，但使用冒号作为分隔符</p></li>
</ul>
<p>请参阅 <span class="target" id="index-171"></span><a class="pep reference external" href="https://peps.python.org/pep-0737/"><strong>PEP 737</strong></a> 了解详情。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/111696">gh-111696</a> 中贡献。）</p>
</li>
<li><p>You no longer have to define the <code class="docutils literal notranslate"><span class="pre">PY_SSIZE_T_CLEAN</span></code> macro before
including <code class="file docutils literal notranslate"><span class="pre">Python.h</span></code> when using <code class="docutils literal notranslate"><span class="pre">#</span></code> formats in
<a class="reference internal" href="../c-api/arg.html#arg-parsing-string-and-buffers"><span class="std std-ref">format codes</span></a>.
APIs accepting the format codes always use <code class="docutils literal notranslate"><span class="pre">Py_ssize_t</span></code> for <code class="docutils literal notranslate"><span class="pre">#</span></code> formats.
(Contributed by Inada Naoki in <a class="reference external" href="https://github.com/python/cpython/issues/104922">gh-104922</a>.)</p></li>
<li><p>如果 Python 是使用 <a class="reference internal" href="../using/configure.html#debug-build"><span class="std std-ref">调试模式</span></a> 或 <a class="reference internal" href="../using/configure.html#cmdoption-with-assertions"><code class="xref std std-option docutils literal notranslate"><span class="pre">附带断言</span></code></a> 构建的，<a class="reference internal" href="../c-api/tuple.html#c.PyTuple_SET_ITEM" title="PyTuple_SET_ITEM"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_SET_ITEM()</span></code></a> 和 <a class="reference internal" href="../c-api/list.html#c.PyList_SET_ITEM" title="PyList_SET_ITEM"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_SET_ITEM()</span></code></a> 现在将通过一个断言来检查 index 参数。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/106168">gh-106168</a> 中贡献。）</p></li>
</ul>
</section>
<section id="limited-c-api-changes">
<h3>受限 C API 的改变<a class="headerlink" href="#limited-c-api-changes" title="Link to this heading">¶</a></h3>
<ul>
<li><p>下列函数现在被包括在受限 C API 中：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/memory.html#c.PyMem_RawMalloc" title="PyMem_RawMalloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMem_RawMalloc()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/memory.html#c.PyMem_RawCalloc" title="PyMem_RawCalloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMem_RawCalloc()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/memory.html#c.PyMem_RawRealloc" title="PyMem_RawRealloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMem_RawRealloc()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/memory.html#c.PyMem_RawFree" title="PyMem_RawFree"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyMem_RawFree()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/sys.html#c.PySys_Audit" title="PySys_Audit"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_Audit()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/sys.html#c.PySys_AuditTuple" title="PySys_AuditTuple"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AuditTuple()</span></code></a></p></li>
<li><p><a class="reference internal" href="../c-api/type.html#c.PyType_GetModuleByDef" title="PyType_GetModuleByDef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyType_GetModuleByDef()</span></code></a></p></li>
</ul>
<p>（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/85283">gh-85283</a>, <a class="reference external" href="https://github.com/python/cpython/issues/85283">gh-85283</a> 和 <a class="reference external" href="https://github.com/python/cpython/issues/116936">gh-116936</a> 中贡献。）</p>
</li>
<li><p>使用 <a class="reference internal" href="../using/configure.html#cmdoption-with-trace-refs"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-trace-refs</span></code></a> (跟踪引用) 构建的 Python 现在支持 <a class="reference internal" href="../c-api/stable.html#limited-c-api"><span class="std std-ref">受限 API</span></a>。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/108634">gh-108634</a> 中贡献。）</p></li>
</ul>
</section>
<section id="removed-c-apis">
<h3>被移除的 C API<a class="headerlink" href="#removed-c-apis" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Remove several functions, macros, variables, etc
with names prefixed by <code class="docutils literal notranslate"><span class="pre">_Py</span></code> or <code class="docutils literal notranslate"><span class="pre">_PY</span></code> (which are considered private).
If your project is affected  by one of these removals
and you believe that the removed API should remain available,
please <a class="reference internal" href="../bugs.html#using-the-tracker"><span class="std std-ref">open a new issue</span></a> to request a public C API
and add <code class="docutils literal notranslate"><span class="pre">cc:</span> <span class="pre">&#64;vstinner</span></code> to the issue to notify Victor Stinner.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/106320">gh-106320</a>.)</p></li>
<li><p>移除在 Python 3.0 中已弃用的旧缓冲区协议。 改用 <a class="reference internal" href="../c-api/buffer.html#bufferobjects"><span class="std std-ref">缓冲协议</span></a>。</p>
<ul>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CheckReadBuffer()</span></code>:
Use <a class="reference internal" href="../c-api/buffer.html#c.PyObject_CheckBuffer" title="PyObject_CheckBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CheckBuffer()</span></code></a> to test
whether the object supports the buffer protocol.
Note that <a class="reference internal" href="../c-api/buffer.html#c.PyObject_CheckBuffer" title="PyObject_CheckBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CheckBuffer()</span></code></a> doesn't guarantee
that <a class="reference internal" href="../c-api/buffer.html#c.PyObject_GetBuffer" title="PyObject_GetBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetBuffer()</span></code></a> will succeed.
To test if the object is actually readable,
see the next example of <a class="reference internal" href="../c-api/buffer.html#c.PyObject_GetBuffer" title="PyObject_GetBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetBuffer()</span></code></a>.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_AsCharBuffer()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_AsReadBuffer()</span></code>: 改用 <a class="reference internal" href="../c-api/buffer.html#c.PyObject_GetBuffer" title="PyObject_GetBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetBuffer()</span></code></a> 和 <a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_Release" title="PyBuffer_Release"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_Release()</span></code></a>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Py_buffer</span><span class="w"> </span><span class="n">view</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyObject_GetBuffer</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">view</span><span class="p">,</span><span class="w"> </span><span class="n">PyBUF_SIMPLE</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Use `view.buf` and `view.len` to read from the buffer.</span>
<span class="c1">// You may need to cast buf as `(const char*)view.buf`.</span>
<span class="n">PyBuffer_Release</span><span class="p">(</span><span class="o">&amp;</span><span class="n">view</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_AsWriteBuffer()</span></code>:
Use <a class="reference internal" href="../c-api/buffer.html#c.PyObject_GetBuffer" title="PyObject_GetBuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_GetBuffer()</span></code></a> and <a class="reference internal" href="../c-api/buffer.html#c.PyBuffer_Release" title="PyBuffer_Release"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyBuffer_Release()</span></code></a> instead:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Py_buffer</span><span class="w"> </span><span class="n">view</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">PyObject_GetBuffer</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">view</span><span class="p">,</span><span class="w"> </span><span class="n">PyBUF_WRITABLE</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Use `view.buf` and `view.len` to write to the buffer.</span>
<span class="n">PyBuffer_Release</span><span class="p">(</span><span class="o">&amp;</span><span class="n">view</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>（由 Inada Naoki 在 <a class="reference external" href="https://github.com/python/cpython/issues/85275">gh-85275</a> 中贡献。）</p>
</li>
<li><p>删除了在 Python 3.9 中弃用的各种函数：</p>
<ul>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_CallObject()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_CallObjectWithKeywords()</span></code>: 改用 <a class="reference internal" href="../c-api/call.html#c.PyObject_CallNoArgs" title="PyObject_CallNoArgs"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CallNoArgs()</span></code></a> 或 <a class="reference internal" href="../c-api/call.html#c.PyObject_Call" title="PyObject_Call"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Call()</span></code></a>。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>In <a class="reference internal" href="../c-api/call.html#c.PyObject_Call" title="PyObject_Call"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Call()</span></code></a>, positional arguments must be a <a class="reference internal" href="../library/stdtypes.html#tuple" title="tuple"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>
and must not be <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
and keyword arguments must be a <a class="reference internal" href="../library/stdtypes.html#dict" title="dict"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> or <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
whereas the removed functions checked argument types
and accepted <code class="docutils literal notranslate"><span class="pre">NULL</span></code> positional and keyword arguments.
To replace <code class="docutils literal notranslate"><span class="pre">PyEval_CallObjectWithKeywords(func,</span> <span class="pre">NULL,</span> <span class="pre">kwargs)</span></code> with
<a class="reference internal" href="../c-api/call.html#c.PyObject_Call" title="PyObject_Call"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Call()</span></code></a>,
pass an empty tuple as positional arguments using
<a class="reference internal" href="../c-api/tuple.html#c.PyTuple_New" title="PyTuple_New"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTuple_New(0)</span></code></a>.</p>
</div>
</li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_CallFunction()</span></code>: 改用 <a class="reference internal" href="../c-api/call.html#c.PyObject_CallFunction" title="PyObject_CallFunction"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CallFunction()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_CallMethod()</span></code>: 改用 <a class="reference internal" href="../c-api/call.html#c.PyObject_CallMethod" title="PyObject_CallMethod"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_CallMethod()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCFunction_Call()</span></code>: 改用 <a class="reference internal" href="../c-api/call.html#c.PyObject_Call" title="PyObject_Call"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Call()</span></code></a>。</p></li>
</ul>
<p>(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105107">gh-105107</a>.)</p>
</li>
<li><p>移除了下列用于配置 Python 初始化的旧函数，它们在 Python 3.11 中已被弃用：</p>
<ul class="simple">
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddWarnOptionUnicode()</span></code>: 改用 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.warnoptions" title="PyConfig.warnoptions"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.warnoptions</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddWarnOption()</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.warnoptions" title="PyConfig.warnoptions"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.warnoptions</span></code></a> instead.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_AddXOption()</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.xoptions" title="PyConfig.xoptions"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.xoptions</span></code></a> instead.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_HasWarnOptions()</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.xoptions" title="PyConfig.xoptions"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.xoptions</span></code></a> instead.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetPath()</span></code>:
Set <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a> instead.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPath()</span></code>:
Set <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.module_search_paths" title="PyConfig.module_search_paths"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.module_search_paths</span></code></a> instead.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetStandardStreamEncoding()</span></code>:
Set <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.stdio_encoding" title="PyConfig.stdio_encoding"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.stdio_encoding</span></code></a> instead,
and set also maybe <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.legacy_windows_stdio" title="PyConfig.legacy_windows_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.legacy_windows_stdio</span></code></a> (on Windows).</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">_Py_SetProgramFullPath()</span></code>:
Set <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.executable" title="PyConfig.executable"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.executable</span></code></a> instead.</p></li>
</ul>
<p>Use the new <a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> API of the <a class="reference internal" href="../c-api/init_config.html#init-config"><span class="std std-ref">Python Initialization
Configuration</span></a> instead (<span class="target" id="index-52"></span><a class="pep reference external" href="https://peps.python.org/pep-0587/"><strong>PEP 587</strong></a>), added to Python 3.8.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105145">gh-105145</a>.)</p>
</li>
<li><p>Remove <code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_AcquireLock()</span></code> and <code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_ReleaseLock()</span></code> functions,
deprecated in Python 3.2.
They didn't update the current thread state.
They can be replaced with:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/init.html#c.PyEval_SaveThread" title="PyEval_SaveThread"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_SaveThread()</span></code></a> and <a class="reference internal" href="../c-api/init.html#c.PyEval_RestoreThread" title="PyEval_RestoreThread"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_RestoreThread()</span></code></a>;</p></li>
<li><p>low-level <a class="reference internal" href="../c-api/init.html#c.PyEval_AcquireThread" title="PyEval_AcquireThread"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_AcquireThread()</span></code></a> and <a class="reference internal" href="../c-api/init.html#c.PyEval_RestoreThread" title="PyEval_RestoreThread"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_RestoreThread()</span></code></a>;</p></li>
<li><p>or <a class="reference internal" href="../c-api/init.html#c.PyGILState_Ensure" title="PyGILState_Ensure"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyGILState_Ensure()</span></code></a> and <a class="reference internal" href="../c-api/init.html#c.PyGILState_Release" title="PyGILState_Release"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyGILState_Release()</span></code></a>.</p></li>
</ul>
<p>(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105182">gh-105182</a>.)</p>
</li>
<li><p>删除了在 Python 3.9 弃用的:c:func:<cite>!PyEval_ThreadsInitialized</cite> 函数。自Python 3.7 起，<code class="xref c c-func docutils literal notranslate"><span class="pre">Py_Initialize()</span></code> 总是创建全局解释器锁 ：调用:c:func:<cite>!PyEval_InitThreads</cite> 不做任何事情，而:c:func:<cite>!PyEval_ThreadsInitialized</cite> 总返回非零值。(由 Victor Stinner 在:gh:<cite>105182</cite> 中贡献。）</p></li>
<li><p>Remove the <code class="xref c c-func docutils literal notranslate"><span class="pre">_PyInterpreterState_Get()</span></code> alias to
<a class="reference internal" href="../c-api/init.html#c.PyInterpreterState_Get" title="PyInterpreterState_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInterpreterState_Get()</span></code></a>
which was kept for backward compatibility with Python 3.8.
The <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> can be used to get
<a class="reference internal" href="../c-api/init.html#c.PyInterpreterState_Get" title="PyInterpreterState_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyInterpreterState_Get()</span></code></a> on Python 3.8 and older.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/106320">gh-106320</a>.)</p></li>
<li><p>Remove the private <code class="xref c c-func docutils literal notranslate"><span class="pre">_PyObject_FastCall()</span></code> function:
use <code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Vectorcall()</span></code> which is available since Python 3.8
(<span class="target" id="index-53"></span><a class="pep reference external" href="https://peps.python.org/pep-0590/"><strong>PEP 590</strong></a>).
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/106023">gh-106023</a>.)</p></li>
<li><p>Remove the <code class="docutils literal notranslate"><span class="pre">cpython/pytime.h</span></code> header file,
which only contained private functions.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/106316">gh-106316</a>.)</p></li>
<li><p>Remove the undocumented <code class="docutils literal notranslate"><span class="pre">PY_TIMEOUT_MAX</span></code> constant from the limited C API.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/110014">gh-110014</a>.)</p></li>
<li><p>Remove the old trashcan macros <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_BEGIN</span></code>
and <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_END</span></code>.
Replace both with the new macros <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_BEGIN</span></code>
and <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_END</span></code>.
(Contributed by Irit Katriel in <a class="reference external" href="https://github.com/python/cpython/issues/105111">gh-105111</a>.)</p></li>
</ul>
</section>
<section id="deprecated-c-apis">
<h3>已弃用的 C API<a class="headerlink" href="#deprecated-c-apis" title="Link to this heading">¶</a></h3>
<ul>
<li><p>已弃用旧的 Python 初始化函数：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/sys.html#c.PySys_ResetWarnOptions" title="PySys_ResetWarnOptions"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_ResetWarnOptions()</span></code></a>: 改为清除 <a class="reference internal" href="../library/sys.html#sys.warnoptions" title="sys.warnoptions"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.warnoptions</span></code></a> 和 <code class="xref py py-data docutils literal notranslate"><span class="pre">warnings.filters</span></code>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetExecPrefix" title="Py_GetExecPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetExecPrefix()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.exec_prefix" title="sys.exec_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.exec_prefix</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPath" title="Py_GetPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPath()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPrefix" title="Py_GetPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPrefix()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.prefix" title="sys.prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.prefix</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramFullPath" title="Py_GetProgramFullPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramFullPath()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramName" title="Py_GetProgramName"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramName()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPythonHome" title="Py_GetPythonHome"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPythonHome()</span></code></a>: 改为获取 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.home" title="PyConfig.home"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.home</span></code></a> 或 <span class="target" id="index-172"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> 环境变量。</p></li>
</ul>
<p>（由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/105145">gh-105145</a> 中贡献。）</p>
</li>
<li><p><a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">Soft deprecate</span></a> the
<a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetBuiltins" title="PyEval_GetBuiltins"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetBuiltins()</span></code></a>, <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetGlobals" title="PyEval_GetGlobals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetGlobals()</span></code></a>,
and <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetLocals" title="PyEval_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetLocals()</span></code></a> functions,
which return a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
(Soft deprecated as part of <span class="target" id="index-55"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a>.)</p></li>
<li><p>Deprecate the <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleNoBlock" title="PyImport_ImportModuleNoBlock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleNoBlock()</span></code></a> function,
which is just an alias to <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModule" title="PyImport_ImportModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModule()</span></code></a> since Python 3.3.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105396">gh-105396</a>.)</p></li>
<li><p><a class="reference internal" href="../glossary.html#term-soft-deprecated"><span class="xref std std-term">Soft deprecate</span></a> the
<a class="reference internal" href="../c-api/module.html#c.PyModule_AddObject" title="PyModule_AddObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_AddObject()</span></code></a> function.
It should be replaced with <a class="reference internal" href="../c-api/module.html#c.PyModule_Add" title="PyModule_Add"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_Add()</span></code></a>
or <a class="reference internal" href="../c-api/module.html#c.PyModule_AddObjectRef" title="PyModule_AddObjectRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_AddObjectRef()</span></code></a>.
(Contributed by Serhiy Storchaka in <a class="reference external" href="https://github.com/python/cpython/issues/86493">gh-86493</a>.)</p></li>
<li><p>Deprecate the old <code class="docutils literal notranslate"><span class="pre">Py_UNICODE</span></code> and <code class="docutils literal notranslate"><span class="pre">PY_UNICODE_TYPE</span></code> types
and the <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_WIDE</span></code> define.
Use the <code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code> type directly instead.
Since Python 3.3, <code class="docutils literal notranslate"><span class="pre">Py_UNICODE</span></code> and <code class="docutils literal notranslate"><span class="pre">PY_UNICODE_TYPE</span></code>
are just aliases to <code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105156">gh-105156</a>.)</p></li>
<li><p>Deprecate the <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetObject" title="PyWeakref_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetObject()</span></code></a> and
<a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GET_OBJECT" title="PyWeakref_GET_OBJECT"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GET_OBJECT()</span></code></a> functions,
which return a <a class="reference internal" href="../glossary.html#term-borrowed-reference"><span class="xref std std-term">borrowed reference</span></a>.
Replace them with the new <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a> function,
which returns a <a class="reference internal" href="../glossary.html#term-strong-reference"><span class="xref std std-term">strong reference</span></a>.
The <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> can be used to get
<a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a> on Python 3.12 and older.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/105927">gh-105927</a>.)</p></li>
</ul>
<section id="id8">
<h4>Pending removal in Python 3.14<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/dict.html#c.PyDictObject" title="PyDictObject"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyDictObject</span></code></a> 中的 <code class="docutils literal notranslate"><span class="pre">ma_version_tag</span></code> 字段用于扩展模块 ( <span class="target" id="index-173"></span><a class="pep reference external" href="https://peps.python.org/pep-0699/"><strong>PEP 699</strong></a> ; <a class="reference external" href="https://github.com/python/cpython/issues/101193">gh-101193</a> )。</p></li>
<li><p>创建 <a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_IMMUTABLETYPE" title="Py_TPFLAGS_IMMUTABLETYPE"><code class="xref c c-data docutils literal notranslate"><span class="pre">immutable</span> <span class="pre">types</span></code></a>  的可变基础 ( <a class="reference external" href="https://github.com/python/cpython/issues/95388">gh-95388</a> )。</p></li>
</ul>
</section>
<section id="id9">
<h4>Pending removal in Python 3.15<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<ul>
<li><p>捆绑的 <code class="docutils literal notranslate"><span class="pre">libmpdecimal</span></code> 副本。</p></li>
<li><p>The <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModuleNoBlock" title="PyImport_ImportModuleNoBlock"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModuleNoBlock()</span></code></a>: 改用 <a class="reference internal" href="../c-api/import.html#c.PyImport_ImportModule" title="PyImport_ImportModule"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyImport_ImportModule()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetObject" title="PyWeakref_GetObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetObject()</span></code></a> and <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GET_OBJECT" title="PyWeakref_GET_OBJECT"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GET_OBJECT()</span></code></a>:
Use <a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a> instead. The <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> can be used to get
<a class="reference internal" href="../c-api/weakref.html#c.PyWeakref_GetRef" title="PyWeakref_GetRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyWeakref_GetRef()</span></code></a> on Python 3.12 and older.</p></li>
<li><p><a class="reference internal" href="../c-api/unicode.html#c.Py_UNICODE" title="Py_UNICODE"><code class="xref c c-type docutils literal notranslate"><span class="pre">Py_UNICODE</span></code></a> 类型和 <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_UNICODE_WIDE</span></code> 宏：改用 <code class="xref c c-type docutils literal notranslate"><span class="pre">wchar_t</span></code>。</p></li>
<li><p>Python 初始化函数</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/sys.html#c.PySys_ResetWarnOptions" title="PySys_ResetWarnOptions"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_ResetWarnOptions()</span></code></a>: 改为清除 <a class="reference internal" href="../library/sys.html#sys.warnoptions" title="sys.warnoptions"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.warnoptions</span></code></a> 和 <code class="xref py py-data docutils literal notranslate"><span class="pre">warnings.filters</span></code>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetExecPrefix" title="Py_GetExecPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetExecPrefix()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.base_exec_prefix" title="sys.base_exec_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.base_exec_prefix</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.exec_prefix" title="sys.exec_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.exec_prefix</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPath" title="Py_GetPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPath()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.path" title="sys.path"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPrefix" title="Py_GetPrefix"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPrefix()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.base_prefix" title="sys.base_prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.base_prefix</span></code></a> 和 <a class="reference internal" href="../library/sys.html#sys.prefix" title="sys.prefix"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.prefix</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramFullPath" title="Py_GetProgramFullPath"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramFullPath()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetProgramName" title="Py_GetProgramName"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetProgramName()</span></code></a>: 改为获取 <a class="reference internal" href="../library/sys.html#sys.executable" title="sys.executable"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.executable</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_GetPythonHome" title="Py_GetPythonHome"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_GetPythonHome()</span></code></a>:
Get <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;home&quot;)</span></code></a>
or the <span class="target" id="index-57"></span><a class="reference internal" href="../using/cmdline.html#envvar-PYTHONHOME"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHOME</span></code></a> environment variable instead.</p></li>
</ul>
<p>See also the <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> function.</p>
</li>
<li><p>用于配置 Python 的初始化的函数，在 Python 3.11 中已弃用：</p>
<ul class="simple">
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgvEx()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.argv" title="PyConfig.argv"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.argv</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PySys_SetArgv()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.argv" title="PyConfig.argv"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.argv</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetProgramName()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.program_name" title="PyConfig.program_name"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.program_name</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_SetPythonHome()</span></code>: 改为设置 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.home" title="PyConfig.home"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.home</span></code></a>。</p></li>
</ul>
<p><a class="reference internal" href="../c-api/init.html#c.Py_InitializeFromConfig" title="Py_InitializeFromConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromConfig()</span></code></a> API 应与 <a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> 一起使用。</p>
</li>
<li><p>全局配置变量：</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_DebugFlag" title="Py_DebugFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_DebugFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.parser_debug" title="PyConfig.parser_debug"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.parser_debug</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;parser_debug&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_VerboseFlag" title="Py_VerboseFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_VerboseFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.verbose" title="PyConfig.verbose"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.verbose</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;verbose&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_QuietFlag" title="Py_QuietFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_QuietFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.quiet" title="PyConfig.quiet"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.quiet</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;quiet&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_InteractiveFlag" title="Py_InteractiveFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_InteractiveFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.interactive" title="PyConfig.interactive"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.interactive</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;interactive&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_InspectFlag" title="Py_InspectFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_InspectFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.inspect" title="PyConfig.inspect"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.inspect</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;inspect&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_OptimizeFlag" title="Py_OptimizeFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_OptimizeFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.optimization_level" title="PyConfig.optimization_level"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.optimization_level</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;optimization_level&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_NoSiteFlag" title="Py_NoSiteFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_NoSiteFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.site_import" title="PyConfig.site_import"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.site_import</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;site_import&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_BytesWarningFlag" title="Py_BytesWarningFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_BytesWarningFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.bytes_warning" title="PyConfig.bytes_warning"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.bytes_warning</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;bytes_warning&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_FrozenFlag" title="Py_FrozenFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FrozenFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.pathconfig_warnings" title="PyConfig.pathconfig_warnings"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.pathconfig_warnings</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;pathconfig_warnings&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_IgnoreEnvironmentFlag" title="Py_IgnoreEnvironmentFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_IgnoreEnvironmentFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.use_environment" title="PyConfig.use_environment"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.use_environment</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;use_environment&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_DontWriteBytecodeFlag" title="Py_DontWriteBytecodeFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_DontWriteBytecodeFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.write_bytecode" title="PyConfig.write_bytecode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.write_bytecode</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;write_bytecode&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_NoUserSiteDirectory" title="Py_NoUserSiteDirectory"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_NoUserSiteDirectory</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.user_site_directory" title="PyConfig.user_site_directory"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.user_site_directory</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;user_site_directory&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_UnbufferedStdioFlag" title="Py_UnbufferedStdioFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_UnbufferedStdioFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.buffered_stdio" title="PyConfig.buffered_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.buffered_stdio</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;buffered_stdio&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_HashRandomizationFlag" title="Py_HashRandomizationFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_HashRandomizationFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.use_hash_seed" title="PyConfig.use_hash_seed"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.use_hash_seed</span></code></a>
and <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.hash_seed" title="PyConfig.hash_seed"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.hash_seed</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;hash_seed&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_IsolatedFlag" title="Py_IsolatedFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_IsolatedFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.isolated" title="PyConfig.isolated"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.isolated</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;isolated&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_LegacyWindowsFSEncodingFlag" title="Py_LegacyWindowsFSEncodingFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_LegacyWindowsFSEncodingFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyPreConfig.legacy_windows_fs_encoding" title="PyPreConfig.legacy_windows_fs_encoding"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyPreConfig.legacy_windows_fs_encoding</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;legacy_windows_fs_encoding&quot;)</span></code></a> instead.</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.Py_LegacyWindowsStdioFlag" title="Py_LegacyWindowsStdioFlag"><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_LegacyWindowsStdioFlag</span></code></a>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.legacy_windows_stdio" title="PyConfig.legacy_windows_stdio"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.legacy_windows_stdio</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;legacy_windows_stdio&quot;)</span></code></a> instead.</p></li>
<li><p><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FileSystemDefaultEncoding</span></code>, <code class="xref c c-var docutils literal notranslate"><span class="pre">Py_HasFileSystemDefaultEncoding</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.filesystem_encoding" title="PyConfig.filesystem_encoding"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.filesystem_encoding</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;filesystem_encoding&quot;)</span></code></a> instead.</p></li>
<li><p><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_FileSystemDefaultEncodeErrors</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyConfig.filesystem_errors" title="PyConfig.filesystem_errors"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyConfig.filesystem_errors</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;filesystem_errors&quot;)</span></code></a> instead.</p></li>
<li><p><code class="xref c c-var docutils literal notranslate"><span class="pre">Py_UTF8Mode</span></code>:
Use <a class="reference internal" href="../c-api/init_config.html#c.PyPreConfig.utf8_mode" title="PyPreConfig.utf8_mode"><code class="xref c c-member docutils literal notranslate"><span class="pre">PyPreConfig.utf8_mode</span></code></a> or
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get(&quot;utf8_mode&quot;)</span></code></a> instead.
(see <a class="reference internal" href="../c-api/init_config.html#c.Py_PreInitialize" title="Py_PreInitialize"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_PreInitialize()</span></code></a>)</p></li>
</ul>
<p>The <a class="reference internal" href="../c-api/init.html#c.Py_InitializeFromConfig" title="Py_InitializeFromConfig"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_InitializeFromConfig()</span></code></a> API should be used with
<a class="reference internal" href="../c-api/init_config.html#c.PyConfig" title="PyConfig"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyConfig</span></code></a> to set these options. Or <a class="reference internal" href="../c-api/init_config.html#c.PyConfig_Get" title="PyConfig_Get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyConfig_Get()</span></code></a> can be
used to get these options at runtime.</p>
</li>
</ul>
</section>
<section id="id10">
<h4>Pending removal in future versions<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<p>以下 API 已被弃用，将被移除，但目前尚未确定移除日期。</p>
<ul class="simple">
<li><p><a class="reference internal" href="../c-api/typeobj.html#c.Py_TPFLAGS_HAVE_FINALIZE" title="Py_TPFLAGS_HAVE_FINALIZE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_TPFLAGS_HAVE_FINALIZE</span></code></a>: 自 Python 3.8 起不再需要。</p></li>
<li><p><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Fetch" title="PyErr_Fetch"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Fetch()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetRaisedException" title="PyErr_GetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetRaisedException()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_NormalizeException" title="PyErr_NormalizeException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_NormalizeException()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_GetRaisedException" title="PyErr_GetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_GetRaisedException()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/exceptions.html#c.PyErr_Restore" title="PyErr_Restore"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Restore()</span></code></a>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_SetRaisedException" title="PyErr_SetRaisedException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_SetRaisedException()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/module.html#c.PyModule_GetFilename" title="PyModule_GetFilename"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_GetFilename()</span></code></a>: 改用 <a class="reference internal" href="../c-api/module.html#c.PyModule_GetFilenameObject" title="PyModule_GetFilenameObject"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyModule_GetFilenameObject()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/sys.html#c.PyOS_AfterFork" title="PyOS_AfterFork"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyOS_AfterFork()</span></code></a>: 改用 <a class="reference internal" href="../c-api/sys.html#c.PyOS_AfterFork_Child" title="PyOS_AfterFork_Child"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyOS_AfterFork_Child()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/slice.html#c.PySlice_GetIndicesEx" title="PySlice_GetIndicesEx"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_GetIndicesEx()</span></code></a>: 改用 <a class="reference internal" href="../c-api/slice.html#c.PySlice_Unpack" title="PySlice_Unpack"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_Unpack()</span></code></a> and <a class="reference internal" href="../c-api/slice.html#c.PySlice_AdjustIndices" title="PySlice_AdjustIndices"><code class="xref c c-func docutils literal notranslate"><span class="pre">PySlice_AdjustIndices()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsDecodedObject()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Decode" title="PyCodec_Decode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Decode()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsDecodedUnicode()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Decode" title="PyCodec_Decode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Decode()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsEncodedObject()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Encode" title="PyCodec_Encode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Encode()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_AsEncodedUnicode()</span></code>: 改用 <a class="reference internal" href="../c-api/codec.html#c.PyCodec_Encode" title="PyCodec_Encode"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyCodec_Encode()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/unicode.html#c.PyUnicode_READY" title="PyUnicode_READY"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyUnicode_READY()</span></code></a>: 自 Python 3.12 起不再需要</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_Display()</span></code>: 改用 <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_DisplayException" title="PyErr_DisplayException"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_DisplayException()</span></code></a>。</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">_PyErr_ChainExceptions()</span></code>: 改用 <code class="xref c c-func docutils literal notranslate"><span class="pre">_PyErr_ChainExceptions1()</span></code>。</p></li>
<li><p><code class="xref c c-member docutils literal notranslate"><span class="pre">PyBytesObject.ob_shash</span></code> 成员：改为调用 <a class="reference internal" href="../c-api/object.html#c.PyObject_Hash" title="PyObject_Hash"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_Hash()</span></code></a>。</p></li>
<li><p>线程本地存储 (TLS) API：</p>
<ul>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_create_key" title="PyThread_create_key"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_create_key()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_alloc" title="PyThread_tss_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_alloc()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_delete_key" title="PyThread_delete_key"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_delete_key()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_free" title="PyThread_tss_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_free()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_set_key_value" title="PyThread_set_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_set_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_set" title="PyThread_tss_set"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_set()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_get_key_value" title="PyThread_get_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_get_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_get" title="PyThread_tss_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_get()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_delete_key_value" title="PyThread_delete_key_value"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_delete_key_value()</span></code></a>: 改用 <a class="reference internal" href="../c-api/init.html#c.PyThread_tss_delete" title="PyThread_tss_delete"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_tss_delete()</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../c-api/init.html#c.PyThread_ReInitTLS" title="PyThread_ReInitTLS"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThread_ReInitTLS()</span></code></a>: 自 Python 3.7 起不再需要。</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="build-changes">
<h2>构建变化<a class="headerlink" href="#build-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">arm64-apple-ios</span></code> and <code class="docutils literal notranslate"><span class="pre">arm64-apple-ios-simulator</span></code> are both
now <span class="target" id="index-58"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> tier 3 platforms.
(<a class="reference internal" href="#whatsnew313-platform-support"><span class="std std-ref">PEP 730</span></a> written
and implementation contributed by Russell Keith-Magee in <a class="reference external" href="https://github.com/python/cpython/issues/114099">gh-114099</a>.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aarch64-linux-android</span></code> and <code class="docutils literal notranslate"><span class="pre">x86_64-linux-android</span></code> are both
now <span class="target" id="index-59"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> tier 3 platforms.
(<a class="reference internal" href="#whatsnew313-platform-support"><span class="std std-ref">PEP 738</span></a> written
and implementation contributed by Malcolm Smith in <a class="reference external" href="https://github.com/python/cpython/issues/116622">gh-116622</a>.)</p></li>
<li><p>现在 <code class="docutils literal notranslate"><span class="pre">wasm32-wasi</span></code> 是 <span class="target" id="index-174"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 第 2 层级的平台。 （由 Brett Cannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/115192">gh-115192</a> 中贡献。）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wasm32-emscripten</span></code> 不再是 <span class="target" id="index-175"></span><a class="pep reference external" href="https://peps.python.org/pep-0011/"><strong>PEP 11</strong></a> 的受支持平台。 （由 Brett Cannon 在 <a class="reference external" href="https://github.com/python/cpython/issues/115192">gh-115192</a> 中贡献。）</p></li>
<li><p>现在构建 CPython 需要带有 C11 atomic 库支持的编译器、GCC 内置 atomic 函数或 MSVC 互锁内生函数。</p></li>
<li><p>Autoconf 2.71 and aclocal 1.16.5 are now required to regenerate
the <code class="file docutils literal notranslate"><span class="pre">configure</span></code> script.
(Contributed by Christian Heimes in <a class="reference external" href="https://github.com/python/cpython/issues/89886">gh-89886</a> and by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/112090">gh-112090</a>.)</p></li>
<li><p>需要 SQLite 3.15.2 或更新的版本才能构建 <a class="reference internal" href="../library/sqlite3.html#module-sqlite3" title="sqlite3: A DB-API 2.0 implementation using SQLite 3.x."><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlite3</span></code></a> 扩展模块。 （由 Erlend Aasland 在 <a class="reference external" href="https://github.com/python/cpython/issues/105875">gh-105875</a> 中贡献。）</p></li>
<li><p>CPython now bundles the <a class="reference external" href="https://github.com/microsoft/mimalloc/">mimalloc library</a> by default.
It is licensed under the MIT license;
see <a class="reference internal" href="../license.html#mimalloc-license"><span class="std std-ref">mimalloc license</span></a>.
The bundled mimalloc has custom changes, see <a class="reference external" href="https://github.com/python/cpython/issues/113141">gh-113141</a> for details.
(Contributed by Dino Viehland in <a class="reference external" href="https://github.com/python/cpython/issues/109914">gh-109914</a>.)</p>
</li>
<li><p>现在 <code class="file docutils literal notranslate"><span class="pre">configure</span></code> 选项 <a class="reference internal" href="../using/configure.html#cmdoption-with-system-libmpdec"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-system-libmpdec</span></code></a> 默认为 <code class="docutils literal notranslate"><span class="pre">yes</span></code>。 捆绑的 <code class="docutils literal notranslate"><span class="pre">libmpdecimal</span></code> 副本将在 Python 3.15 中被移除。</p></li>
<li><p>使用 <code class="file docutils literal notranslate"><span class="pre">configure</span></code> <a class="reference internal" href="../using/configure.html#cmdoption-with-trace-refs"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-trace-refs</span></code></a> (跟踪引用) 构建的 Python 现在与 Python 发布构建版和 <a class="reference internal" href="../using/configure.html#debug-build"><span class="std std-ref">调试构建版</span></a> 是 ABI 兼容的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/108634">gh-108634</a> 中贡献。）</p></li>
<li><p>On POSIX systems, the pkg-config (<code class="docutils literal notranslate"><span class="pre">.pc</span></code>) filenames now include the ABI
flags.  For example, the free-threaded build generates <code class="docutils literal notranslate"><span class="pre">python-3.13t.pc</span></code>
and the debug build generates <code class="docutils literal notranslate"><span class="pre">python-3.13d.pc</span></code>.</p></li>
<li><p>现在 <code class="docutils literal notranslate"><span class="pre">errno</span></code>, <code class="docutils literal notranslate"><span class="pre">fcntl</span></code>, <code class="docutils literal notranslate"><span class="pre">grp</span></code>, <code class="docutils literal notranslate"><span class="pre">md5</span></code>, <code class="docutils literal notranslate"><span class="pre">pwd</span></code>, <code class="docutils literal notranslate"><span class="pre">resource</span></code>, <code class="docutils literal notranslate"><span class="pre">termios</span></code>, <code class="docutils literal notranslate"><span class="pre">winsound</span></code>, <code class="docutils literal notranslate"><span class="pre">_ctypes_test</span></code>, <code class="docutils literal notranslate"><span class="pre">_multiprocessing.posixshmem</span></code>, <code class="docutils literal notranslate"><span class="pre">_scproxy</span></code>, <code class="docutils literal notranslate"><span class="pre">_stat</span></code>, <code class="docutils literal notranslate"><span class="pre">_statistics</span></code>, <code class="docutils literal notranslate"><span class="pre">_testconsole</span></code>, <code class="docutils literal notranslate"><span class="pre">_testimportmultiple</span></code> 和 <code class="docutils literal notranslate"><span class="pre">_uuid</span></code> C 扩展是使用 <a class="reference internal" href="../c-api/stable.html#limited-c-api"><span class="std std-ref">受限 C API</span></a> 构建的。 （由 Victor Stinner 在 <a class="reference external" href="https://github.com/python/cpython/issues/85283">gh-85283</a> 中贡献。）</p></li>
</ul>
</section>
<section id="porting-to-python-3-13">
<h2>Porting to Python 3.13<a class="headerlink" href="#porting-to-python-3-13" title="Link to this heading">¶</a></h2>
<p>本节列出了先前描述的更改以及可能需要更改代码的其他错误修正.</p>
<section id="changes-in-the-python-api">
<h3>Python API 的变化<a class="headerlink" href="#changes-in-the-python-api" title="Link to this heading">¶</a></h3>
<ul id="pep667-porting-notes-py">
<li><p><a class="reference internal" href="#whatsnew313-locals-semantics"><span class="std std-ref">PEP 667</span></a> 引入了对 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 和 <a class="reference internal" href="../reference/datamodel.html#frame.f_locals" title="frame.f_locals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">f_locals</span></code></a> 语义的多项更改：</p>
<ul class="simple">
<li><p>在 <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">optimized scope</span></a> 中调用 <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a> 时，每次调用都会生成一个独立的快照，因此不再隐式更新之前返回的引用。要获得以往版本 CPython 的行为，现需显式调用以使用后来调用:func:<cite>!locals`得到的结果来更新初次调用返回的字典。隐式使用 :func:</cite>!locals` 的代码执行函数（如 <code class="docutils literal notranslate"><span class="pre">exec</span></code> 和 <code class="docutils literal notranslate"><span class="pre">eval</span></code>）必须传入一个显式命名空间，才能在已优化的作用域中访问其结果。（此更改为 <span class="target" id="index-176"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 的一部分。）</p></li>
<li><p>从模块作用域或类作用域的推导式中调用 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals`（包括</span> <span class="pre">``exec`()</span></code> 或 <code class="docutils literal notranslate"><span class="pre">eval</span></code> 导致的间接调用）时，行为再次表现得像是推导式作为独立的嵌套函数运行（即不包含外部作用域的局部变量）。在 Python 3.12 中，此场景下的行为曾按照 <span class="target" id="index-177"></span><a class="pep reference external" href="https://peps.python.org/pep-0709/"><strong>PEP 709</strong></a> 更改为包含存放推导式的作用域的局部变量。（此更改为 <span class="target" id="index-178"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 的一部分。）</p></li>
<li><p>在 <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">optimized scope</span></a> 中访问 <a class="reference internal" href="../reference/datamodel.html#frame.f_locals" title="frame.f_locals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FrameType.f_locals</span></code></a> 现在会返回一个写入代理，而不是一个在不明确时间更新的快照。如果需要快照，必须使用 <code class="docutils literal notranslate"><span class="pre">dict</span></code> 或该代理的 <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> 方法显式地创建。（此修改是 <span class="target" id="index-179"></span><a class="pep reference external" href="https://peps.python.org/pep-0667/"><strong>PEP 667</strong></a> 的一部分。）</p></li>
</ul>
</li>
<li><p>当作为方法使用时，<a class="reference internal" href="../library/functools.html#functools.partial" title="functools.partial"><code class="xref py py-class docutils literal notranslate"><span class="pre">functools.partial</span></code></a> 现在会发出 <a class="reference internal" href="../library/exceptions.html#FutureWarning" title="FutureWarning"><code class="xref py py-exc docutils literal notranslate"><span class="pre">FutureWarning</span></code></a>。该行为将在 Python 的未来版本中更改。如果想保留旧行为，请将其包装在 <a class="reference internal" href="../library/functions.html#staticmethod" title="staticmethod"><code class="xref py py-func docutils literal notranslate"><span class="pre">staticmethod()</span></code></a> 中。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/121027">gh-121027</a> 贡献。）</p></li>
<li><p>现在当无法获取到用户名时 <a class="reference internal" href="../library/getpass.html#getpass.getuser" title="getpass.getuser"><code class="xref py py-func docutils literal notranslate"><span class="pre">getpass.getuser()</span></code></a> 将会引发 <a class="reference internal" href="../library/exceptions.html#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a>，而不是在非 Unix 平台上引发 <a class="reference internal" href="../library/exceptions.html#ImportError" title="ImportError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ImportError</span></code></a> 或因密码数据库为空在 Unix 平台上引发 <a class="reference internal" href="../library/exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">KeyError</span></code></a>。</p></li>
<li><p><a class="reference internal" href="../library/gzip.html#gzip.GzipFile" title="gzip.GzipFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code></a> 的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code> 属性值现在是字符串（<code class="docutils literal notranslate"><span class="pre">'rb'</span></code> 或 <code class="docutils literal notranslate"><span class="pre">'wb'</span></code>）而不是整数（<code class="docutils literal notranslate"><span class="pre">1</span></code> 或 <code class="docutils literal notranslate"><span class="pre">2</span></code>）。<a class="reference internal" href="../library/zipfile.html#zipfile.ZipFile.open" title="zipfile.ZipFile.open"><code class="xref py py-meth docutils literal notranslate"><span class="pre">zipfile.ZipFile.open()</span></code></a> 返回的可读文件型对象的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code> 属性值现在是 <code class="docutils literal notranslate"><span class="pre">'rb'</span></code>，而非 <code class="docutils literal notranslate"><span class="pre">'r'</span></code>。（由 Serhiy Storchaka 在 <a class="reference external" href="https://github.com/python/cpython/issues/115961">gh-115961</a> 贡献。）</p></li>
<li><p><a class="reference internal" href="../library/mailbox.html#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal notranslate"><span class="pre">mailbox.Maildir</span></code></a> 现在会忽略以点（<code class="docutils literal notranslate"><span class="pre">.</span></code>）开头的文件。（由 Zackery Spytz 在 <a class="reference external" href="https://github.com/python/cpython/issues/65559">gh-65559</a> 贡献。）</p></li>
<li><p><a class="reference internal" href="../library/pathlib.html#pathlib.Path.glob" title="pathlib.Path.glob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pathlib.Path.glob()</span></code></a> 和 <a class="reference internal" href="../library/pathlib.html#pathlib.Path.rglob" title="pathlib.Path.rglob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rglob()</span></code></a> 现在会在匹配模式以“<code class="docutils literal notranslate"><span class="pre">**</span></code>”结尾时同时返回文件和目录，而不仅仅是目录。若要保持之前的行为，仅匹配目录，请添加尾部斜杠。</p></li>
<li><p><a class="reference internal" href="../library/threading.html#module-threading" title="threading: Thread-based parallelism."><code class="xref py py-mod docutils literal notranslate"><span class="pre">threading</span></code></a> 模块现在期望 <code class="xref py py-mod docutils literal notranslate"><span class="pre">_thread</span></code> 模块具有 <code class="xref py py-func docutils literal notranslate"><span class="pre">_is_main_interpreter()</span></code> 函数。该函数不接受任何参数，如果当前解释器是主解释器，则返回 <code class="docutils literal notranslate"><span class="pre">True</span></code>。</p>
<p>与模块的其他“私有”属性一样，任何提供自定义 <code class="xref py py-mod docutils literal notranslate"><span class="pre">_thread</span></code> 模块的库或应用都必须提供 <code class="xref py py-func docutils literal notranslate"><span class="pre">_is_main_interpreter()</span></code>。（<a class="reference external" href="https://github.com/python/cpython/issues/112826">gh-112826</a>。）</p>
</li>
</ul>
</section>
<section id="changes-in-the-c-api">
<h3>C API 的变化<a class="headerlink" href="#changes-in-the-c-api" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Python.h</span></code> no longer includes the <code class="docutils literal notranslate"><span class="pre">&lt;ieeefp.h&gt;</span></code> standard header. It was
included for the <code class="xref c c-func docutils literal notranslate"><span class="pre">finite()</span></code> function which is now provided by the
<code class="docutils literal notranslate"><span class="pre">&lt;math.h&gt;</span></code> header. It should now be included explicitly if needed. Remove
also the <code class="docutils literal notranslate"><span class="pre">HAVE_IEEEFP_H</span></code> macro.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108765">gh-108765</a>.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Python.h</span></code> no longer includes these standard header files: <code class="docutils literal notranslate"><span class="pre">&lt;time.h&gt;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&lt;sys/select.h&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;sys/time.h&gt;</span></code>. If needed, they should now be
included explicitly. For example, <code class="docutils literal notranslate"><span class="pre">&lt;time.h&gt;</span></code> provides the <code class="xref c c-func docutils literal notranslate"><span class="pre">clock()</span></code> and
<code class="xref c c-func docutils literal notranslate"><span class="pre">gmtime()</span></code> functions, <code class="docutils literal notranslate"><span class="pre">&lt;sys/select.h&gt;</span></code> provides the <code class="xref c c-func docutils literal notranslate"><span class="pre">select()</span></code>
function, and <code class="docutils literal notranslate"><span class="pre">&lt;sys/time.h&gt;</span></code> provides the <code class="xref c c-func docutils literal notranslate"><span class="pre">futimes()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">gettimeofday()</span></code>
and <code class="xref c c-func docutils literal notranslate"><span class="pre">setitimer()</span></code> functions.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108765">gh-108765</a>.)</p></li>
<li><p>On Windows, <code class="docutils literal notranslate"><span class="pre">Python.h</span></code> no longer includes the <code class="docutils literal notranslate"><span class="pre">&lt;stddef.h&gt;</span></code> standard
header file. If needed, it should now be included explicitly. For example, it
provides <code class="xref c c-func docutils literal notranslate"><span class="pre">offsetof()</span></code> function, and <code class="docutils literal notranslate"><span class="pre">size_t</span></code> and <code class="docutils literal notranslate"><span class="pre">ptrdiff_t</span></code> types.
Including <code class="docutils literal notranslate"><span class="pre">&lt;stddef.h&gt;</span></code> explicitly was already needed by all other
platforms, the <code class="docutils literal notranslate"><span class="pre">HAVE_STDDEF_H</span></code> macro is only defined on Windows.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/108765">gh-108765</a>.)</p></li>
<li><p>If the <a class="reference internal" href="../c-api/stable.html#c.Py_LIMITED_API" title="Py_LIMITED_API"><code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_LIMITED_API</span></code></a> macro is defined, <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_BUILD_CORE</span></code>,
<code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_BUILD_CORE_BUILTIN</span></code> and <code class="xref c c-macro docutils literal notranslate"><span class="pre">Py_BUILD_CORE_MODULE</span></code> macros
are now undefined by <code class="docutils literal notranslate"><span class="pre">&lt;Python.h&gt;</span></code>.
(Contributed by Victor Stinner in <a class="reference external" href="https://github.com/python/cpython/issues/85283">gh-85283</a>.)</p></li>
<li><p>The old trashcan macros <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_BEGIN</span></code> and <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_SAFE_END</span></code>
were removed. They should be replaced by the new macros <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_BEGIN</span></code>
and <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_END</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">tp_dealloc</span></code> function that has the old macros, such as:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">void</span>
<span class="n">mytype_dealloc</span><span class="p">(</span><span class="n">mytype</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PyObject_GC_UnTrack</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">Py_TRASHCAN_SAFE_BEGIN</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="o">...</span>
    <span class="n">Py_TRASHCAN_SAFE_END</span>
<span class="p">}</span>
</pre></div>
</div>
<p>应当按照以下方式迁移到新版宏:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">void</span>
<span class="n">mytype_dealloc</span><span class="p">(</span><span class="n">mytype</span> <span class="o">*</span><span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PyObject_GC_UnTrack</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
    <span class="n">Py_TRASHCAN_BEGIN</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">mytype_dealloc</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="n">Py_TRASHCAN_END</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">Py_TRASHCAN_BEGIN</span></code> has a second argument which
should be the deallocation function it is in. The new macros were
added in Python 3.8 and the old macros were deprecated in Python 3.11.
(Contributed by Irit Katriel in <a class="reference external" href="https://github.com/python/cpython/issues/105111">gh-105111</a>.)</p>
</li>
</ul>
<ul id="pep667-porting-notes-c">
<li><p><a class="reference internal" href="#whatsnew313-locals-semantics"><span class="std std-ref">PEP 667</span></a> introduces several changes
to frame-related functions:</p>
<ul class="simple">
<li><p>The effects of mutating the dictionary returned from
<a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetLocals" title="PyEval_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetLocals()</span></code></a> in an <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">optimized scope</span></a> have changed.
New dict entries added this way will now <em>only</em> be visible to
subsequent <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetLocals" title="PyEval_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetLocals()</span></code></a> calls in that frame,
as <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a>, <a class="reference internal" href="../library/functions.html#locals" title="locals"><code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code></a>,
and <a class="reference internal" href="../reference/datamodel.html#frame.f_locals" title="frame.f_locals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">FrameType.f_locals</span></code></a> no longer access
the same underlying cached dictionary.
Changes made to entries for actual variable names and names added via
the write-through proxy interfaces will be overwritten on subsequent calls
to <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetLocals" title="PyEval_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetLocals()</span></code></a> in that frame.
The recommended code update depends on how the function was being used,
so refer to the deprecation notice on the function for details.</p></li>
<li><p>Calling <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a> in an <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">optimized scope</span></a>
now returns a write-through proxy rather than a snapshot
that gets updated at ill-specified times.
If a snapshot is desired, it must be created explicitly
(e.g. with <a class="reference internal" href="../c-api/dict.html#c.PyDict_Copy" title="PyDict_Copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_Copy()</span></code></a>),
or by calling the new <a class="reference internal" href="../c-api/reflection.html#c.PyEval_GetFrameLocals" title="PyEval_GetFrameLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_GetFrameLocals()</span></code></a> API.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_FastToLocals()</span></code> and <code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_FastToLocalsWithError()</span></code>
no longer have any effect.
Calling these functions has been redundant since Python 3.11,
when <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a> was first introduced.</p></li>
<li><p><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_LocalsToFast()</span></code> no longer has any effect.
Calling this function is redundant now that <a class="reference internal" href="../c-api/frame.html#c.PyFrame_GetLocals" title="PyFrame_GetLocals"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyFrame_GetLocals()</span></code></a>
returns a write-through proxy for <a class="reference internal" href="../glossary.html#term-optimized-scope"><span class="xref std std-term">optimized scopes</span></a>.</p></li>
</ul>
</li>
<li><p>Python 3.13 removed many private functions. Some of them can be replaced using these
alternatives:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_PyDict_Pop()</span></code>: <a class="reference internal" href="../c-api/dict.html#c.PyDict_Pop" title="PyDict_Pop"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_Pop()</span></code></a> or <a class="reference internal" href="../c-api/dict.html#c.PyDict_PopString" title="PyDict_PopString"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_PopString()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyDict_GetItemWithError()</span></code>: <a class="reference internal" href="../c-api/dict.html#c.PyDict_GetItemRef" title="PyDict_GetItemRef"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyDict_GetItemRef()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyErr_WriteUnraisableMsg()</span></code>:  <a class="reference internal" href="../c-api/exceptions.html#c.PyErr_FormatUnraisable" title="PyErr_FormatUnraisable"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyErr_FormatUnraisable()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyEval_SetTrace()</span></code>: <a class="reference internal" href="../c-api/init.html#c.PyEval_SetTrace" title="PyEval_SetTrace"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_SetTrace()</span></code></a> or <a class="reference internal" href="../c-api/init.html#c.PyEval_SetTraceAllThreads" title="PyEval_SetTraceAllThreads"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyEval_SetTraceAllThreads()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyList_Extend()</span></code>: <a class="reference internal" href="../c-api/list.html#c.PyList_Extend" title="PyList_Extend"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyList_Extend()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyLong_AsInt()</span></code>: <a class="reference internal" href="../c-api/long.html#c.PyLong_AsInt" title="PyLong_AsInt"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyLong_AsInt()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyMem_RawStrdup()</span></code>: <code class="docutils literal notranslate"><span class="pre">strdup()</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyMem_Strdup()</span></code>: <code class="docutils literal notranslate"><span class="pre">strdup()</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyObject_ClearManagedDict()</span></code>: <a class="reference internal" href="../c-api/object.html#c.PyObject_ClearManagedDict" title="PyObject_ClearManagedDict"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_ClearManagedDict()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyObject_VisitManagedDict()</span></code>: <a class="reference internal" href="../c-api/object.html#c.PyObject_VisitManagedDict" title="PyObject_VisitManagedDict"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyObject_VisitManagedDict()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyThreadState_UncheckedGet()</span></code>: <a class="reference internal" href="../c-api/init.html#c.PyThreadState_GetUnchecked" title="PyThreadState_GetUnchecked"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyThreadState_GetUnchecked()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_AsSecondsDouble()</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_AsSecondsDouble" title="PyTime_AsSecondsDouble"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_AsSecondsDouble()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_GetMonotonicClock()</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_Monotonic" title="PyTime_Monotonic"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_Monotonic()</span></code></a> or <a class="reference internal" href="../c-api/time.html#c.PyTime_MonotonicRaw" title="PyTime_MonotonicRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_MonotonicRaw()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_GetPerfCounter()</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_PerfCounter" title="PyTime_PerfCounter"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_PerfCounter()</span></code></a> or <a class="reference internal" href="../c-api/time.html#c.PyTime_PerfCounterRaw" title="PyTime_PerfCounterRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_PerfCounterRaw()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_GetSystemClock()</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_Time" title="PyTime_Time"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_Time()</span></code></a> or <a class="reference internal" href="../c-api/time.html#c.PyTime_TimeRaw" title="PyTime_TimeRaw"><code class="xref c c-func docutils literal notranslate"><span class="pre">PyTime_TimeRaw()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_MAX</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_MAX" title="PyTime_MAX"><code class="xref c c-var docutils literal notranslate"><span class="pre">PyTime_MAX</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_MIN</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_MIN" title="PyTime_MIN"><code class="xref c c-var docutils literal notranslate"><span class="pre">PyTime_MIN</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_PyTime_t</span></code>: <a class="reference internal" href="../c-api/time.html#c.PyTime_t" title="PyTime_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">PyTime_t</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_Py_HashPointer()</span></code>: <a class="reference internal" href="../c-api/hash.html#c.Py_HashPointer" title="Py_HashPointer"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_HashPointer()</span></code></a>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_Py_IsFinalizing()</span></code>: <a class="reference internal" href="../c-api/init.html#c.Py_IsFinalizing" title="Py_IsFinalizing"><code class="xref c c-func docutils literal notranslate"><span class="pre">Py_IsFinalizing()</span></code></a>.</p></li>
</ul>
<p>The <a class="reference external" href="https://github.com/python/pythoncapi-compat/">pythoncapi-compat project</a> can be used to get most of these new
functions on Python 3.12 and older.</p>
</li>
</ul>
</section>
</section>
<section id="regression-test-changes">
<h2>回归测试的变化<a class="headerlink" href="#regression-test-changes" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>现在使用 <code class="file docutils literal notranslate"><span class="pre">configure</span></code> <a class="reference internal" href="../using/configure.html#cmdoption-with-pydebug"><code class="xref std std-option docutils literal notranslate"><span class="pre">--with-pydebug</span></code></a> 编译的 Python 将支持 <a class="reference internal" href="../using/cmdline.html#cmdoption-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span> <span class="pre">presite=package.module</span></code></a> 命令行选项。 如果被使用，它指明一个模块应当在解释器生命周期开始时，即 <code class="docutils literal notranslate"><span class="pre">site.py</span></code> 被执行之前被导入。 （由 Łukasz Langa 在 <a class="reference external" href="https://github.com/python/cpython/issues/110769">gh-110769</a> 中贡献。）</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">Python 3.13 有什么新变化</a><ul>
<li><a class="reference internal" href="#summary-release-highlights">摘要 -- 发布重点</a></li>
<li><a class="reference internal" href="#new-features">新的特性</a><ul>
<li><a class="reference internal" href="#a-better-interactive-interpreter">更好的交互式解释器</a></li>
<li><a class="reference internal" href="#improved-error-messages">改进的错误消息</a></li>
<li><a class="reference internal" href="#free-threaded-cpython">自由线程的 CPython</a></li>
<li><a class="reference internal" href="#an-experimental-just-in-time-jit-compiler">实验性的即时 (JIT) 编译器</a></li>
<li><a class="reference internal" href="#defined-mutation-semantics-for-locals">针对 <code class="xref py py-func docutils literal notranslate"><span class="pre">locals()</span></code> 的已定义修改语义</a></li>
<li><a class="reference internal" href="#support-for-mobile-platforms">对移动平台的支持</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-language-changes">其他语言特性修改</a></li>
<li><a class="reference internal" href="#new-modules">新增模块</a></li>
<li><a class="reference internal" href="#improved-modules">改进的模块</a><ul>
<li><a class="reference internal" href="#argparse">argparse</a></li>
<li><a class="reference internal" href="#array">array</a></li>
<li><a class="reference internal" href="#ast">ast</a></li>
<li><a class="reference internal" href="#asyncio">asyncio</a></li>
<li><a class="reference internal" href="#base64">base64</a></li>
<li><a class="reference internal" href="#compileall">compileall</a></li>
<li><a class="reference internal" href="#concurrent-futures">concurrent.futures</a></li>
<li><a class="reference internal" href="#configparser">configparser</a></li>
<li><a class="reference internal" href="#copy">copy</a></li>
<li><a class="reference internal" href="#ctypes">ctypes</a></li>
<li><a class="reference internal" href="#dbm">dbm</a></li>
<li><a class="reference internal" href="#dis">dis</a></li>
<li><a class="reference internal" href="#doctest">doctest</a></li>
<li><a class="reference internal" href="#email">email</a></li>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#fractions">fractions</a></li>
<li><a class="reference internal" href="#glob">glob</a></li>
<li><a class="reference internal" href="#importlib">importlib</a></li>
<li><a class="reference internal" href="#io">io</a></li>
<li><a class="reference internal" href="#ipaddress">ipaddress</a></li>
<li><a class="reference internal" href="#itertools">itertools</a></li>
<li><a class="reference internal" href="#marshal">marshal</a></li>
<li><a class="reference internal" href="#math">math</a></li>
<li><a class="reference internal" href="#mimetypes">mimetypes</a></li>
<li><a class="reference internal" href="#mmap">mmap</a></li>
<li><a class="reference internal" href="#multiprocessing">multiprocessing</a></li>
<li><a class="reference internal" href="#os">os</a></li>
<li><a class="reference internal" href="#os-path">os.path</a></li>
<li><a class="reference internal" href="#pathlib">pathlib</a></li>
<li><a class="reference internal" href="#pdb">pdb</a></li>
<li><a class="reference internal" href="#queue">queue</a></li>
<li><a class="reference internal" href="#random">random</a></li>
<li><a class="reference internal" href="#re">re</a></li>
<li><a class="reference internal" href="#shutil">shutil</a></li>
<li><a class="reference internal" href="#site">site</a></li>
<li><a class="reference internal" href="#sqlite3">sqlite3</a></li>
<li><a class="reference internal" href="#ssl">ssl</a></li>
<li><a class="reference internal" href="#statistics">statistics</a></li>
<li><a class="reference internal" href="#subprocess">subprocess</a></li>
<li><a class="reference internal" href="#sys">sys</a></li>
<li><a class="reference internal" href="#tempfile">tempfile</a></li>
<li><a class="reference internal" href="#time">time</a></li>
<li><a class="reference internal" href="#tkinter">tkinter</a></li>
<li><a class="reference internal" href="#traceback">回溯</a></li>
<li><a class="reference internal" href="#types">types</a></li>
<li><a class="reference internal" href="#typing">typing</a></li>
<li><a class="reference internal" href="#unicodedata">unicodedata</a></li>
<li><a class="reference internal" href="#venv">venv</a></li>
<li><a class="reference internal" href="#warnings">warnings</a></li>
<li><a class="reference internal" href="#xml">xml</a></li>
<li><a class="reference internal" href="#zipimport">zipimport</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optimizations">性能优化</a></li>
<li><a class="reference internal" href="#removed-modules-and-apis">被移除的模块与 API</a><ul>
<li><a class="reference internal" href="#pep-594-remove-dead-batteries-from-the-standard-library">PEP 594: 从标准库中移除“死电池”</a></li>
<li><a class="reference internal" href="#to3">2to3</a></li>
<li><a class="reference internal" href="#builtins">builtins</a></li>
<li><a class="reference internal" href="#id3">configparser</a></li>
<li><a class="reference internal" href="#importlib-metadata">importlib.metadata</a></li>
<li><a class="reference internal" href="#locale">locale</a></li>
<li><a class="reference internal" href="#opcode">opcode</a></li>
<li><a class="reference internal" href="#optparse">optparse</a></li>
<li><a class="reference internal" href="#id4">pathlib</a></li>
<li><a class="reference internal" href="#id5">re</a></li>
<li><a class="reference internal" href="#tkinter-tix">tkinter.tix</a></li>
<li><a class="reference internal" href="#turtle">turtle</a></li>
<li><a class="reference internal" href="#id6">typing</a></li>
<li><a class="reference internal" href="#unittest">unittest</a></li>
<li><a class="reference internal" href="#urllib">urllib</a></li>
<li><a class="reference internal" href="#webbrowser">webbrowser</a></li>
</ul>
</li>
<li><a class="reference internal" href="#new-deprecations">新的弃用</a><ul>
<li><a class="reference internal" href="#pending-removal-in-python-3-14">Pending removal in Python 3.14</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-15">Pending removal in Python 3.15</a></li>
<li><a class="reference internal" href="#pending-removal-in-python-3-16">计划在 Python 3.16 中移除</a></li>
<li><a class="reference internal" href="#pending-removal-in-future-versions">Pending removal in future versions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cpython-bytecode-changes">CPython 字节码的变化</a></li>
<li><a class="reference internal" href="#c-api-changes">C API 的变化</a><ul>
<li><a class="reference internal" href="#id7">新的特性</a></li>
<li><a class="reference internal" href="#changed-c-apis">被改变的 C API</a></li>
<li><a class="reference internal" href="#limited-c-api-changes">受限 C API 的改变</a></li>
<li><a class="reference internal" href="#removed-c-apis">被移除的 C API</a></li>
<li><a class="reference internal" href="#deprecated-c-apis">已弃用的 C API</a><ul>
<li><a class="reference internal" href="#id8">Pending removal in Python 3.14</a></li>
<li><a class="reference internal" href="#id9">Pending removal in Python 3.15</a></li>
<li><a class="reference internal" href="#id10">Pending removal in future versions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#build-changes">构建变化</a></li>
<li><a class="reference internal" href="#porting-to-python-3-13">Porting to Python 3.13</a><ul>
<li><a class="reference internal" href="#changes-in-the-python-api">Python API 的变化</a></li>
<li><a class="reference internal" href="#changes-in-the-c-api">C API 的变化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regression-test-changes">回归测试的变化</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一主题</h4>
    <p class="topless"><a href="3.14.html"
                          title="上一章">What's new in Python 3.14</a></p>
  </div>
  <div>
    <h4>下一主题</h4>
    <p class="topless"><a href="3.12.html"
                          title="下一章">Python 3.12 有什么新变化</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>当前页</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">报告 Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/main/Doc/whatsnew/3.13.rst"
            rel="nofollow">显示源码
        </a>
      </li>
    </ul>
  </div>
        </div>
<div id="sidebarbutton" title="折叠边栏">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>导航</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="总索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python 模块索引"
             >模块</a> |</li>
        <li class="right" >
          <a href="3.12.html" title="Python 3.12 有什么新变化"
             >下一页</a> |</li>
        <li class="right" >
          <a href="3.14.html" title="What&#39;s new in Python 3.14"
             >上一页</a> |</li>

          <li><img src="../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.14.0a4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python的新变化</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python 3.13 有什么新变化</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="快速搜索" aria-label="快速搜索" type="search" name="q" id="search-box" />
          <input type="submit" value="提交" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
      <a href="../copyright.html">
    
    版权所有
    
      </a>
     2001 Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
      See <a href="/license.html">History and License</a> for more information.<br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
      最后更新于 2月 03, 2025 (05:36 UTC).
    
      <a href="/bugs.html">Found a bug</a>?
    
    <br />

    由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3创建。
    </div>

  </body>
</html>